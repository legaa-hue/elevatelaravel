import{_ as X}from"./AuthenticatedLayout-QEosiX-U.js";import{r as c,c as M,x as q,a as i,e,g,j as h,t as u,l as C,n as D,F as S,k as T,B as k,o as s,i as H,w as B,b as W}from"./app-CDJn0Pzk.js";import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BCn51QQ5.js";const R={class:"file-upload-manager"},K=["multiple","accept"],Q={class:"upload-content"},Y={key:0,class:"upload-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Z={key:1,class:"upload-spinner"},ee={class:"upload-text"},le={key:0},te={key:1},oe={key:2,class:"upload-hint"},ae={key:0,class:"storage-provider-selector"},se={class:"flex gap-3"},ie=["onClick"],ne={key:1,class:"file-list"},re={class:"file-items"},de={class:"file-preview"},ue=["src","alt"],ce={class:"file-info"},pe={class:"file-name"},ve={class:"file-meta"},me={key:0},fe={class:"file-actions"},ge=["href"],be=["href"],ye=["onClick"],he={key:2,class:"error-message"},_e={__name:"FileUploadManager",props:{uploadableType:{type:String,required:!0},uploadableId:{type:[Number,String],required:!0},multiple:{type:Boolean,default:!0},acceptedFileTypes:{type:String,default:"image/*,video/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.txt"},maxSize:{type:Number,default:50},showCloudOptions:{type:Boolean,default:!0},canDelete:{type:Boolean,default:!0}},emits:["uploaded","deleted","error"],setup(x,{emit:p}){const n=x,b=p,v=c([]),_=c(!1),r=c(!1),d=c(0),m=c(""),w=c(null),I=c(null),F=c("local"),$=c([{value:"local",label:"Local Storage"},{value:"google_drive",label:"Google Drive"},{value:"onedrive",label:"OneDrive"}]),z=M(()=>n.acceptedFileTypes),U=M(()=>`${n.maxSize}MB`),V=M(()=>n.acceptedFileTypes.includes("image")?"Images, Videos, Documents":"All supported files"),A=()=>{r.value||w.value.click()},O=t=>{const l=Array.from(t.target.files);P(l)},L=t=>{_.value=!1;const l=Array.from(t.dataTransfer.files);P(l)},P=async t=>{var l,o;if(m.value="",t.length!==0){for(const a of t)if(a.size>n.maxSize*1024*1024){m.value=`File "${a.name}" exceeds maximum size of ${n.maxSize}MB`;return}r.value=!0,d.value=0;try{const a=new FormData;if(n.multiple&&t.length>1){t.forEach(y=>{a.append("files[]",y)}),a.append("uploadable_type",n.uploadableType),a.append("uploadable_id",n.uploadableId),a.append("storage_provider",F.value);const f=await k.post("/api/files/upload-multiple",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:y=>{d.value=Math.round(y.loaded*100/y.total)}});f.data.success&&(v.value.unshift(...f.data.files),b("uploaded",f.data.files))}else{a.append("file",t[0]),a.append("uploadable_type",n.uploadableType),a.append("uploadable_id",n.uploadableId),a.append("storage_provider",F.value);const f=await k.post("/api/files/upload",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:y=>{d.value=Math.round(y.loaded*100/y.total)}});f.data.success&&(v.value.unshift(f.data.file),b("uploaded",f.data.file))}w.value&&(w.value.value="")}catch(a){m.value=((o=(l=a.response)==null?void 0:l.data)==null?void 0:o.message)||"Upload failed. Please try again.",b("error",a)}finally{r.value=!1,d.value=0}}},G=async t=>{var l,o;if(confirm(`Are you sure you want to delete "${t.name}"?`))try{(await k.delete(`/api/files/${t.id}`)).data.success&&(v.value=v.value.filter(f=>f.id!==t.id),b("deleted",t))}catch(a){m.value=((o=(l=a.response)==null?void 0:l.data)==null?void 0:o.message)||"Delete failed. Please try again.",b("error",a)}},N=async()=>{try{const t=await k.get("/api/files",{params:{uploadable_type:n.uploadableType,uploadable_id:n.uploadableId}});t.data.success&&(v.value=t.data.files)}catch(t){console.error("Failed to load files:",t)}},E=async()=>{try{const t=await k.get("/api/files/config");t.data.success&&(I.value=t.data.config)}catch(t){console.error("Failed to load config:",t)}},j=t=>t.is_image?"icon-image":t.is_video?"icon-video":t.is_document?"icon-document":"icon-file";return q(()=>{N(),E()}),(t,l)=>(s(),i("div",R,[e("div",{class:D(["upload-dropzone",{dragover:_.value,disabled:r.value}]),onDrop:C(L,["prevent"]),onDragover:l[0]||(l[0]=C(o=>_.value=!0,["prevent"])),onDragleave:l[1]||(l[1]=C(o=>_.value=!1,["prevent"])),onClick:A},[e("input",{ref_key:"fileInput",ref:w,type:"file",multiple:x.multiple,accept:z.value,onChange:O,class:"hidden"},null,40,K),e("div",Q,[r.value?g("",!0):(s(),i("svg",Y,[...l[2]||(l[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"},null,-1)])])),r.value?(s(),i("div",Z,[...l[3]||(l[3]=[e("svg",{class:"animate-spin",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])])):g("",!0),e("p",ee,[r.value?(s(),i("span",te,"Uploading "+u(d.value)+"%...",1)):(s(),i("span",le,[...l[4]||(l[4]=[e("strong",null,"Click to upload",-1),h(" or drag and drop ",-1)])]))]),r.value?g("",!0):(s(),i("p",oe,u(V.value)+" (Max "+u(U.value)+") ",1))])],34),x.showCloudOptions?(s(),i("div",ae,[l[5]||(l[5]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Storage Provider ",-1)),e("div",se,[(s(!0),i(S,null,T($.value,o=>(s(),i("button",{key:o.value,onClick:a=>F.value=o.value,class:D(["provider-btn",F.value===o.value?"active":""]),type:"button"},[e("span",null,u(o.label),1)],10,ie))),128))])])):g("",!0),v.value.length>0?(s(),i("div",ne,[l[9]||(l[9]=e("h3",{class:"file-list-title"},"Uploaded Files",-1)),e("div",re,[(s(!0),i(S,null,T(v.value,o=>(s(),i("div",{key:o.id,class:"file-item"},[e("div",de,[o.is_image&&o.thumbnail_url?(s(),i("img",{key:0,src:o.thumbnail_url,alt:o.name,class:"file-thumbnail"},null,8,ue)):(s(),i("div",{key:1,class:D(["file-icon",j(o)])},[e("span",null,u(o.extension.toUpperCase()),1)],2))]),e("div",ce,[e("p",pe,u(o.name),1),e("p",ve,[h(u(o.size)+" ‚Ä¢ "+u(o.storage_provider)+" ",1),o.uploaded_by?(s(),i("span",me," ‚Ä¢ "+u(o.uploaded_by.name),1)):g("",!0)])]),e("div",fe,[e("a",{href:o.url,target:"_blank",class:"file-action-btn view",title:"View file"},[...l[6]||(l[6]=[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])],8,ge),e("a",{href:o.url,download:"",class:"file-action-btn download",title:"Download file"},[...l[7]||(l[7]=[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)])],8,be),x.canDelete?(s(),i("button",{key:0,onClick:a=>G(o),class:"file-action-btn delete",title:"Delete file"},[...l[8]||(l[8]=[e("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ye)):g("",!0)])]))),128))])])):g("",!0),m.value?(s(),i("div",he,u(m.value),1)):g("",!0)]))}},xe=J(_e,[["__scopeId","data-v-be7cf2d2"]]),ke={class:"py-12"},we={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Fe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},De={class:"p-6 bg-white border-b border-gray-200"},Te={__name:"FileUploadDemo",setup(x){const p=c(""),n=c(""),b=r=>{p.value=`‚úÖ File "${r.name||"File"}" uploaded successfully!`,n.value="bg-green-100 border border-green-400 text-green-700",setTimeout(()=>{p.value=""},5e3)},v=r=>{p.value=`üóëÔ∏è File "${r.name}" deleted successfully!`,n.value="bg-blue-100 border border-blue-400 text-blue-700",setTimeout(()=>{p.value=""},5e3)},_=r=>{var d,m;p.value=`‚ùå Error: ${((m=(d=r.response)==null?void 0:d.data)==null?void 0:m.message)||"Upload failed"}`,n.value="bg-red-100 border border-red-400 text-red-700"};return(r,d)=>(s(),H(X,null,{header:B(()=>[...d[0]||(d[0]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," File Upload Demo ",-1)])]),default:B(()=>[e("div",ke,[e("div",we,[e("div",Fe,[e("div",De,[d[1]||(d[1]=e("h3",{class:"text-lg font-semibold mb-4"},"Upload Files",-1)),W(xe,{"uploadable-type":"App\\Models\\Classwork","uploadable-id":1,multiple:!0,"show-cloud-options":!0,"can-delete":!0,onUploaded:b,onDeleted:v,onError:_}),p.value?(s(),i("div",{key:0,class:D(["mt-4 p-4 rounded",n.value])},u(p.value),3)):g("",!0)])]),d[2]||(d[2]=e("div",{class:"mt-6 bg-white overflow-hidden shadow-sm sm:rounded-lg"},[e("div",{class:"p-6 bg-white border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold mb-4"},"üìñ Usage Instructions"),e("div",{class:"space-y-4 text-sm"},[e("div",null,[e("h4",{class:"font-semibold text-blue-600"},"‚úÖ Supported File Types:"),e("ul",{class:"list-disc list-inside mt-2 text-gray-700"},[e("li",null,"Images: JPEG, PNG, GIF, WebP, SVG (Max 10MB)"),e("li",null,"Videos: MP4, MPEG, MOV, AVI, WebM (Max 100MB)"),e("li",null,"Documents: PDF, DOC, DOCX, XLS, XLSX, PPT, PPTX, TXT (Max 25MB)")])]),e("div",null,[e("h4",{class:"font-semibold text-blue-600"},"üì§ Upload Methods:"),e("ul",{class:"list-disc list-inside mt-2 text-gray-700"},[e("li",null,"Click the upload area to select files"),e("li",null,"Drag and drop files directly"),e("li",null,"Select multiple files at once")])]),e("div",null,[e("h4",{class:"font-semibold text-blue-600"},"‚òÅÔ∏è Storage Options:"),e("ul",{class:"list-disc list-inside mt-2 text-gray-700"},[e("li",null,[e("strong",null,"Local Storage:"),h(" Files stored on server (default)")]),e("li",null,[e("strong",null,"Google Drive:"),h(" Upload to Google Drive (requires configuration)")]),e("li",null,[e("strong",null,"OneDrive:"),h(" Upload to OneDrive (requires configuration)")])])]),e("div",null,[e("h4",{class:"font-semibold text-blue-600"},"üîß Features:"),e("ul",{class:"list-disc list-inside mt-2 text-gray-700"},[e("li",null,"Automatic thumbnail generation for images"),e("li",null,"Progress indicator during upload"),e("li",null,"View, download, and delete files"),e("li",null,"File metadata tracking (size, type, uploader)")])]),e("div",{class:"bg-yellow-50 border border-yellow-200 rounded p-4"},[e("h4",{class:"font-semibold text-yellow-800"},"‚ö†Ô∏è Cloud Storage Setup Required:"),e("p",{class:"text-yellow-700 mt-2"},[h(" To use Google Drive or OneDrive, you need to configure API credentials in your .env file. See "),e("code",{class:"bg-yellow-100 px-2 py-1 rounded"},"FILE_UPLOAD_IMPLEMENTATION.md"),h(" for details. ")])])])])],-1))])])]),_:1}))}};export{Te as default};

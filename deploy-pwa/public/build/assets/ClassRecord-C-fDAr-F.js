import{r as d,c as L,x as O,q as P,E as R,a as l,b as v,d as D,h as A,w,e,g as h,o as a,F as _,k as G,t as r,T as j,l as N}from"./app-CDJn0Pzk.js";import{u as T,T as U}from"./TeacherLayout-6RngpzKi.js";import{u as E,a as I}from"./useTeacherOffline-C7lCC2fg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const $={class:"space-y-6"},q={key:0,class:"bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg shadow-md"},J={key:1,class:"bg-white rounded-lg shadow p-12 text-center"},K={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Q=["onClick"],W={class:"bg-gradient-to-r from-red-900 to-red-800 p-6 text-white"},X={class:"flex items-start justify-between"},Y={class:"text-lg font-bold group-hover:underline line-clamp-2"},Z={class:"text-red-100 text-sm"},ee={class:"p-6"},te={class:"space-y-2 text-sm text-gray-700"},se={class:"flex items-center gap-2"},oe={class:"flex items-center gap-2"},le={class:"flex items-center gap-2"},ae={class:"px-2 py-1 text-xs rounded bg-gray-100 text-gray-700"},re={class:"flex items-center gap-2 mt-2"},ne={class:"text-xs text-gray-900"},ie={class:"flex items-center justify-between p-6 border-b border-gray-200 bg-gradient-to-r from-red-900 to-red-700 rounded-t-2xl"},de={class:"flex items-center gap-3 text-white"},ce={key:0,class:"text-sm text-red-100"},ue={class:"flex-1 overflow-hidden bg-gray-100 rounded-b-2xl"},ve=["src"],he={key:1,class:"flex items-center justify-center h-full"},ge={__name:"ClassRecord",props:{myCourses:{type:Array,default:()=>[]},joinedCourses:{type:Array,default:()=>[]}},setup(M){const u=M,{isOnline:f}=T(),{cacheCourses:B,getCachedCourses:V}=E(),{downloadFile:F,getCachedFile:z}=I(),x=d([...u.myCourses]),g=d([...u.joinedCourses]),p=d(!1);let m=null;const k=L(()=>{const s=new Map;return[...x.value,...g.value].forEach(t=>s.set(t.id,t)),Array.from(s.values())}),n=d(!1),i=d(null),c=d(""),S=async s=>{if(i.value=s,!f.value){const o=await z(`grade-sheet-${s.id}.pdf`);if(o){c.value=URL.createObjectURL(o),n.value=!0;return}alert("âš ï¸ Grade sheet not available offline. Please connect to internet to view.");return}c.value=route("teacher.class-record.grade-sheet.pdf",s.id),n.value=!0;const t=route("teacher.class-record.grade-sheet.download",s.id);await F(t,`grade-sheet-${s.id}.pdf`)},y=()=>{n.value=!1,c.value="",i.value=null},H=()=>{i.value&&(window.location.href=route("teacher.class-record.grade-sheet.download",i.value.id))};return O(async()=>{if(f.value){const s=[...u.myCourses,...u.joinedCourses];s.length>0&&(await B(s),p.value=!1)}else{const s=await V();s&&s.length>0&&(x.value=s.filter(t=>t.is_owner),g.value=s.filter(t=>!t.is_owner),p.value=!0)}m=setInterval(()=>{f.value&&!n.value&&P.reload({only:["myCourses","joinedCourses"],preserveScroll:!0,preserveState:!0})},1e4)}),R(()=>{m&&clearInterval(m)}),(s,t)=>(a(),l(_,null,[v(D(A),{title:"Class Record"}),v(U,null,{default:w(()=>[e("div",$,[t[13]||(t[13]=e("div",{class:"bg-gradient-to-r from-red-900 to-red-700 rounded-lg shadow-lg p-6 text-white"},[e("div",{class:"flex items-center gap-3"},[e("svg",{class:"w-7 h-7",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]),e("div",null,[e("h1",{class:"text-2xl font-bold"},"Class Records"),e("p",{class:"text-red-100 text-sm"},"View grade sheets for all your courses (owned and joined)")])])],-1)),p.value?(a(),l("div",q,[...t[1]||(t[1]=[e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-yellow-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"text-yellow-800 font-medium"},"ðŸ“‹ Viewing Cached Class Records (Offline Mode)")],-1)])])):h("",!0),k.value.length===0?(a(),l("div",J,[...t[2]||(t[2]=[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"No Courses Found",-1),e("p",{class:"text-gray-600"},"Create or join a course to view its class record.",-1)])])):(a(),l("div",K,[(a(!0),l(_,null,G(k.value,o=>{var C,b;return a(),l("div",{key:o.id,class:"bg-white rounded-lg shadow-md hover:shadow-xl transition overflow-hidden group cursor-pointer",onClick:fe=>S(o)},[e("div",W,[e("div",X,[e("div",null,[e("h3",Y,r(o.title),1),e("p",Z,r(o.section),1)]),t[3]||(t[3]=e("svg",{class:"w-6 h-6 text-white opacity-80",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"})],-1))])]),e("div",ee,[e("div",te,[e("div",se,[t[4]||(t[4]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),e("span",null,r((C=o.teacher)==null?void 0:C.first_name)+" "+r((b=o.teacher)==null?void 0:b.last_name),1)]),e("div",oe,[t[5]||(t[5]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),e("span",null,r(o.students_count||0)+" Students",1)]),e("div",le,[e("span",ae,r(o.status),1)])]),e("div",re,[t[6]||(t[6]=e("span",{class:"font-semibold text-xs text-gray-500"},"Midterm Grade:",-1)),e("span",ne,r(o.midterm_grade!==null?o.midterm_grade:"N/A"),1)]),t[7]||(t[7]=e("div",{class:"mt-4 pt-4 border-t border-gray-200 flex items-center justify-between text-sm"},[e("span",{class:"text-gray-600"},"Open Class Record"),e("svg",{class:"w-5 h-5 text-red-600 group-hover:translate-x-1 transition",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})])],-1))])],8,Q)}),128))])),v(j,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:w(()=>[n.value?(a(),l("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",onClick:y},[v(j,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"opacity-0 scale-95","enter-to-class":"opacity-100 scale-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"opacity-100 scale-100","leave-to-class":"opacity-0 scale-95"},{default:w(()=>[n.value?(a(),l("div",{key:0,class:"relative bg-white rounded-2xl shadow-2xl w-full max-w-7xl h-[90vh] flex flex-col",onClick:t[0]||(t[0]=N(()=>{},["stop"]))},[e("div",ie,[e("div",de,[t[9]||(t[9]=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),e("div",null,[t[8]||(t[8]=e("h3",{class:"text-xl font-bold"},"Grade Sheet",-1)),i.value?(a(),l("p",ce,r(i.value.title),1)):h("",!0)])]),e("div",{class:"flex items-center gap-2"},[e("button",{onClick:H,class:"flex items-center gap-2 px-4 py-2 bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white rounded-lg transition-all",title:"Download PDF"},[...t[10]||(t[10]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),e("span",{class:"hidden sm:inline"},"Download",-1)])]),e("button",{onClick:y,class:"p-2 hover:bg-white/20 backdrop-blur-sm text-white rounded-lg transition-all",title:"Close"},[...t[11]||(t[11]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])]),e("div",ue,[c.value?(a(),l("iframe",{key:0,src:c.value,class:"w-full h-full border-0",title:"Grade Sheet PDF"},null,8,ve)):(a(),l("div",he,[...t[12]||(t[12]=[e("div",{class:"text-center"},[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4 animate-spin",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})]),e("p",{class:"text-gray-600"},"Loading PDF...")],-1)])]))])])):h("",!0)]),_:1})])):h("",!0)]),_:1})])]),_:1})],64))}};export{ge as default};

import{r as N,D as We,c as S,x as De,s as ve,a as i,b as oe,i as He,d as ne,h as Ie,w as re,e as s,g as M,o as l,z as he,j as k,t as u,f as b,m as v,n as T,F as g,k as y,N as Ke,q as qe}from"./app-CDJn0Pzk.js";import{u as Re,T as Je}from"./TeacherLayout-6RngpzKi.js";import{A as Qe}from"./AdminLayout-DcgLzAYv.js";import{u as Xe}from"./useTeacherOffline-C7lCC2fg.js";import{_ as Ye}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Ze={class:"max-w-[1800px] mx-auto space-y-6 p-6"},et={key:0,class:"bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg shadow-md"},tt={class:"bg-white rounded-lg shadow-md overflow-hidden"},st={class:"p-4 border-b border-gray-200 bg-white"},ot={class:"flex items-center justify-between"},nt={class:"flex items-center gap-4"},rt={class:"text-xl font-bold text-gray-900"},at={class:"space-y-6"},lt={class:"bg-white rounded-lg shadow-md p-6"},it={class:"grid grid-cols-2 gap-6"},dt={class:"flex items-center gap-2"},ut={class:"flex items-center gap-2"},ct={key:0,class:"mt-4 bg-yellow-50 border border-yellow-200 rounded-lg p-4"},mt={class:"flex items-start gap-3"},pt={class:"text-sm text-yellow-800"},gt={class:"grid grid-cols-2 gap-6"},xt={class:"text-green-100"},yt={class:"text-blue-100"},bt={key:0,class:"space-y-6"},vt={key:0,class:"bg-red-50 border border-red-200 rounded-lg p-4"},ht={class:"flex items-start gap-3"},ft={class:"text-sm font-semibold text-red-800"},wt={class:"bg-white rounded-lg shadow-md overflow-hidden"},kt={class:"bg-green-600 text-white px-6 py-4 flex items-center justify-between"},_t={class:"flex-1"},Ct={class:"flex items-center gap-3"},$t={class:"flex items-center gap-2"},jt={class:"text-sm text-green-100 mt-1"},Pt={key:0,class:"ml-2 text-xs"},Ft=["disabled"],Et={key:0,class:"bg-yellow-50 border-b border-yellow-200 px-6 py-3"},Mt={class:"text-sm text-yellow-800"},Vt={class:"overflow-x-auto"},Gt={class:"w-full text-sm"},Nt={class:"bg-gray-50 border-b-2 border-gray-200"},At=["colspan"],Bt={class:"flex items-center justify-center gap-2"},Ut=["onUpdate:modelValue"],St={key:1,class:"font-semibold"},Tt={class:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded"},zt=["onClick"],Lt={class:"mt-2 flex items-center justify-center gap-2"},Ot=["onUpdate:modelValue","onBlur","max"],Wt=["onUpdate:modelValue","onBlur","max"],Dt=["onClick"],Ht={class:"px-4 py-3 text-center font-semibold text-gray-700 border-l-2 border-gray-300 bg-green-50",rowspan:"2"},It={class:"flex items-center justify-center gap-1"},Kt=["onUpdate:modelValue"],qt={key:1,class:"text-xs"},Rt=["onClick"],Jt={class:"text-xs text-gray-500 mt-1"},Qt={class:"px-4 py-3 font-medium text-gray-900 sticky left-0 bg-white z-10"},Xt=["value","onInput","max","disabled","title"],Yt={class:"px-4 py-3 text-center font-semibold text-gray-900 border-l-2 border-gray-300 bg-green-50"},Zt={class:"bg-white rounded-lg shadow-md overflow-hidden"},es={class:"bg-blue-600 text-white px-6 py-4 flex items-center justify-between"},ts={class:"flex-1"},ss={class:"flex items-center gap-3"},os={class:"flex items-center gap-2"},ns={class:"text-sm text-blue-100 mt-1"},rs={key:0,class:"ml-2 text-xs"},as=["disabled"],ls={key:0,class:"bg-yellow-50 border-b border-yellow-200 px-6 py-3"},is={class:"text-sm text-yellow-800"},ds={key:1,class:"p-12 text-center text-gray-500"},us={key:2,class:"overflow-x-auto"},cs={class:"w-full text-sm"},ms={class:"bg-gray-50 border-b-2 border-gray-200"},ps=["colspan"],gs={class:"flex items-center justify-center gap-2"},xs=["onUpdate:modelValue"],ys={class:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded"},bs=["onClick"],vs={class:"mt-2 flex items-center justify-center gap-2"},hs=["onUpdate:modelValue","onBlur","max"],fs=["onClick"],ws={class:"px-4 py-3 text-center font-semibold text-gray-700 border-l-2 border-gray-300 bg-blue-50",rowspan:"2"},ks={class:"flex items-center justify-center gap-1"},_s=["onUpdate:modelValue"],Cs=["onClick"],$s={class:"text-xs text-gray-500 mt-1"},js={class:"px-4 py-3 font-medium text-gray-900 sticky left-0 bg-white z-10"},Ps=["value","onInput","max","disabled","title"],Fs={class:"px-4 py-3 text-center font-semibold text-gray-900 border-l-2 border-gray-300 bg-blue-50"},Es={class:"bg-white rounded-lg shadow-md overflow-hidden"},Ms={class:"bg-red-600 text-white px-6 py-4 flex items-center justify-between"},Vs={class:"flex-1"},Gs={class:"flex items-center gap-3"},Ns={class:"flex items-center gap-2"},As={class:"text-sm text-red-100 mt-1"},Bs={class:"overflow-x-auto"},Us={class:"w-full text-sm"},Ss={class:"bg-gray-50 border-b-2 border-gray-200"},Ts=["onUpdate:modelValue"],zs={class:"flex items-center justify-center gap-1 mt-1"},Ls=["onUpdate:modelValue"],Os={class:"px-4 py-3 text-center font-semibold text-gray-700 border-l-2 border-gray-300 bg-red-50"},Ws={class:"px-4 py-3 font-medium text-gray-900 sticky left-0 bg-white z-10"},Ds=["value","onInput","max"],Hs={class:"px-4 py-3 text-center font-semibold text-gray-900 border-l-2 border-gray-300 bg-red-50"},Is={class:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-4 flex items-center justify-between"},Ks={class:"flex-1"},qs={class:"flex items-center gap-3"},Rs=["onUpdate:modelValue"],Js={class:"flex items-center gap-2"},Qs=["onUpdate:modelValue","onBlur"],Xs={class:"text-sm text-white/80 mt-1"},Ys={key:0,class:"ml-2 text-xs"},Zs={class:"flex items-center gap-2"},eo=["onClick","disabled"],to=["onClick"],so={key:0,class:"bg-yellow-50 border-b border-yellow-200 px-6 py-3"},oo={class:"text-sm text-yellow-800"},no={key:1,class:"p-12 text-center text-gray-500"},ro={key:2,class:"overflow-x-auto"},ao={class:"w-full text-sm"},lo={class:"bg-gray-50 border-b-2 border-gray-200"},io=["colspan"],uo={class:"flex items-center justify-center gap-2"},co=["onUpdate:modelValue"],mo={class:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded"},po=["onClick"],go={class:"mt-2 flex items-center justify-center gap-2"},xo=["onUpdate:modelValue","onBlur","max"],yo=["onClick"],bo={class:"px-4 py-3 text-center font-semibold text-gray-700 border-l-2 border-gray-300 bg-purple-50",rowspan:"2"},vo={class:"flex items-center justify-center gap-1"},ho=["onUpdate:modelValue"],fo=["onClick"],wo={class:"flex items-center justify-center gap-1 mt-1"},ko=["onUpdate:modelValue"],_o={class:"px-4 py-3 font-medium text-gray-900 sticky left-0 bg-white z-10"},Co=["value","onInput","max"],$o={class:"px-4 py-3 text-center font-semibold text-gray-900 border-l-2 border-gray-300 bg-purple-50"},jo={class:"bg-white rounded-lg shadow-md overflow-hidden"},Po={class:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white px-6 py-4"},Fo={class:"text-lg font-bold"},Eo={class:"overflow-x-auto"},Mo={class:"w-full"},Vo={class:"bg-gray-50 border-b-2 border-gray-200"},Go={class:"px-4 py-3 text-center font-semibold text-gray-700"},No={class:"px-4 py-3 text-center font-semibold text-gray-700"},Ao={class:"px-4 py-3 text-center font-semibold text-gray-700"},Bo={class:"px-4 py-3 text-center font-bold text-purple-700 bg-purple-50"},Uo={class:"px-4 py-3 font-medium text-gray-900"},So={class:"px-4 py-3 text-center text-gray-700"},To={class:"px-4 py-3 text-center text-gray-700"},zo={class:"px-4 py-3 text-center text-gray-700"},Lo={class:"px-4 py-3 text-center font-bold text-lg text-purple-700 bg-purple-50"},Oo={__name:"Gradebook",props:{course:Object,students:Array,classworks:Array,submissions:Array,gradebook:{type:Object,default:null}},setup(V){var be;const f=V,{isOnline:J}=Re(),{updateGradebookOffline:fe,cacheGradebook:we,getCachedGradebook:ke}=Xe(),Q=N(!1);console.log("Gradebook Students Prop:",f.students),console.log("Students Count:",(be=f.students)==null?void 0:be.length);const _e=We(),Ce=S(()=>_e.props.auth.user),$e=S(()=>{var n;return((n=Ce.value)==null?void 0:n.role)==="admin"}),je=S(()=>$e.value?Qe:Je),$=N(50),j=N(50),p=N(null),ae=()=>({asynchronous:{name:"Asynchronous",percentage:35,columns:[{id:"written-works",name:"Written Works",percentage:15,isFixed:!0,subcolumns:[]}]},synchronous:{name:"Synchronous",percentage:35,columns:[]},majorExam:{name:"Major Exam",percentage:30,columns:[{id:"exam-1",name:"Midterm Exam",percentage:30,maxPoints:100,subcolumns:[]}]}}),_=N(ae()),C=N(ae()),z=N([]),L=N([]),c=S(()=>p.value==="midterm"?_.value:p.value==="finals"?C.value:null),w=S(()=>p.value==="midterm"?z.value:p.value==="finals"?L.value:[]),le=()=>{const n=["assignment","quiz","activity"],e=f.classworks.filter(a=>n.includes(a.type)).map(a=>({id:`classwork-${a.id}`,name:a.title,classworkId:a.id,maxPoints:a.points||100,isAutoFetched:!0})),o=_.value.asynchronous.columns.find(a=>a.id==="written-works"),r=C.value.asynchronous.columns.find(a=>a.id==="written-works");o&&(o.subcolumns=e),r&&(r.subcolumns=e)};le();const x=N({});f.students.forEach(n=>{x.value[n.id]={midterm:{},finals:{}}});const X=()=>{if(console.log("[Gradebook] Populating grades from submissions..."),!f.students||!Array.isArray(f.students)){console.warn("[Gradebook] No students data available");return}f.students.forEach(n=>{if(!n.submissions||!Array.isArray(n.submissions)){console.log(`[Gradebook] Student ${n.name} has no submissions`);return}const t=n.submissions.filter(e=>["graded","returned"].includes(e.status)&&e.grade!==null&&e.grade!==void 0);console.log(`[Gradebook] Student ${n.name} has ${t.length} graded submissions`),t.forEach(e=>{const o=f.classworks.find(a=>a.id===e.classwork_id);if(!o){console.warn(`[Gradebook] Classwork not found for submission ${e.id}`);return}if(["assignment","quiz","activity"].includes(o.type)){const a=`classwork-${o.id}`;["midterm","finals"].forEach(m=>{const h=`asynchronous-written-works-${a}`;x.value[n.id]||(x.value[n.id]={midterm:{},finals:{}}),x.value[n.id][m]||(x.value[n.id][m]={}),x.value[n.id][m][h]=e.grade,console.log(`[Gradebook] Set grade for student ${n.name}, ${m}, classwork ${o.title}: ${e.grade}, key: ${h}`)})}})}),console.log("[Gradebook] Grades populated from submissions:",x.value)},E=(n,t)=>t?{...n,...t,columns:t.columns||n.columns}:n,Pe=()=>{var t;const n=f.gradebook??((t=f.course)==null?void 0:t.gradebook)??null;if(n){if(n.midtermPercentage!==void 0&&($.value=n.midtermPercentage),n.finalsPercentage!==void 0&&(j.value=n.finalsPercentage),n.midterm&&n.midterm.tables){const e=n.midterm.tables;e.tables?(e.tables.asynchronous&&(_.value.asynchronous=E(_.value.asynchronous,e.tables.asynchronous)),e.tables.synchronous&&(_.value.synchronous=E(_.value.synchronous,e.tables.synchronous)),e.tables.majorExam&&(_.value.majorExam=E(_.value.majorExam,e.tables.majorExam)),e.custom&&(z.value=e.custom)):(e.asynchronous&&(_.value.asynchronous=E(_.value.asynchronous,e.asynchronous)),e.synchronous&&(_.value.synchronous=E(_.value.synchronous,e.synchronous)),e.majorExam&&(_.value.majorExam=E(_.value.majorExam,e.majorExam)))}if(n.finals&&n.finals.tables){const e=n.finals.tables;e.tables?(e.tables.asynchronous&&(C.value.asynchronous=E(C.value.asynchronous,e.tables.asynchronous)),e.tables.synchronous&&(C.value.synchronous=E(C.value.synchronous,e.tables.synchronous)),e.tables.majorExam&&(C.value.majorExam=E(C.value.majorExam,e.tables.majorExam)),e.custom&&(L.value=e.custom)):(e.asynchronous&&(C.value.asynchronous=E(C.value.asynchronous,e.asynchronous)),e.synchronous&&(C.value.synchronous=E(C.value.synchronous,e.synchronous)),e.majorExam&&(C.value.majorExam=E(C.value.majorExam,e.majorExam)))}n.midterm&&n.midterm.grades&&Object.keys(n.midterm.grades).forEach(e=>{x.value[e]||(x.value[e]={midterm:{},finals:{}}),x.value[e].midterm=n.midterm.grades[e]}),n.finals&&n.finals.grades&&Object.keys(n.finals.grades).forEach(e=>{x.value[e]||(x.value[e]={midterm:{},finals:{}}),x.value[e].finals=n.finals.grades[e]})}};De(async()=>{J.value&&f.gradebook?(await we(f.course.id,f.gradebook),Q.value=!1):J.value||await ke(f.course.id)&&(Q.value=!0),Pe(),X()}),ve(()=>f.students,()=>{console.log("[Gradebook] Students data changed, refreshing grades..."),X()},{deep:!0}),ve(()=>f.classworks,()=>{console.log("[Gradebook] Classworks changed, refreshing grade structure..."),le(),X()},{deep:!0});const Fe=n=>n==="midterm"?{tables:_.value,custom:z.value}:{tables:C.value,custom:L.value},G=async n=>{if(!n)return;const{tables:t,custom:e}=Fe(n),o={tables:t,custom:e},r={};Object.keys(x.value).forEach(d=>{var h;const m=((h=x.value[d])==null?void 0:h[n])||{};r[d]=m});const a={gradingPeriod:n,grades:r,tableStructure:o,midtermPercentage:$.value,finalsPercentage:j.value,courseId:f.course.id};if(!J.value){await fe(a),alert("âœ“ Gradebook saved offline. Will sync when online.");return}try{qe.post(route("teacher.courses.gradebook.save",{course:f.course.id}),a,{preserveScroll:!0,preserveState:!0})}catch(d){console.error("Error saving gradebook:",d)}},ie=n=>{p.value=p.value===n?null:n,p.value===n&&G(n)},de=n=>{const t=c.value[n],e=t.columns.reduce((a,d)=>a+(d.percentage||0),0);if(t.percentage-e<=0){alert(`Cannot add more columns. The ${t.name} table is already at ${t.percentage}%. Please reduce other column percentages first.`);return}const r={id:`col-${Date.now()}`,name:"New Column",percentage:0,subcolumns:[]};t.columns.push(r)},Y=(n,t)=>{const e=c.value[n],o=e.columns.find(d=>d.id===t);if(!o)return;if(isNaN(o.percentage)||o.percentage<0){o.percentage=0;return}const r=e.columns.filter(d=>d.id!==t).reduce((d,m)=>d+(m.percentage||0),0),a=e.percentage-r;o.percentage>a&&(o.percentage=Math.max(0,a)),G(p.value)},Z=n=>{const t=c.value[n];if(isNaN(t.percentage)||t.percentage<0){t.percentage=0;return}const o=100-Object.keys(c.value).filter(a=>a!==n).reduce((a,d)=>a+(c.value[d].percentage||0),0);t.percentage>o&&(t.percentage=Math.max(0,o));const r=t.columns.reduce((a,d)=>a+(d.percentage||0),0);if(r>t.percentage){const a=t.percentage/r;t.columns.forEach(d=>{d.percentage=Math.round((d.percentage||0)*a*100)/100})}G(p.value)},ue=(n,t)=>{const o=c.value[n].columns.find(r=>r.id===t);o&&o.subcolumns.push({id:`subcol-${Date.now()}`,name:"New Item",maxPoints:100,isAutoFetched:!1})},ce=(n,t)=>{const e=c.value[n],o=e.columns.findIndex(r=>r.id===t);o>-1&&!e.columns[o].isFixed&&e.columns.splice(o,1)},me=(n,t,e)=>{const r=c.value[n].columns.find(a=>a.id===t);if(r){const a=r.subcolumns.findIndex(d=>d.id===e);a>-1&&!r.subcolumns[a].isAutoFetched&&r.subcolumns.splice(a,1)}},Ee=()=>{if(!p.value){alert("Please select a grading period first (Midterm or Finals)");return}if(Object.values(c.value).reduce((e,o)=>e+(o.percentage||0),0)+w.value.reduce((e,o)=>e+(o.percentage||0),0)>=100){alert("Cannot add more tables. Total percentage already at 100%. Please reduce existing table percentages first.");return}const t={id:`table-${Date.now()}`,name:"New Table",percentage:0,columns:[],isCustom:!0};p.value==="midterm"?z.value.push(t):L.value.push(t)},Me=n=>{if(p.value==="midterm"){const t=z.value.findIndex(e=>e.id===n);t>-1&&z.value.splice(t,1)}else{const t=L.value.findIndex(e=>e.id===n);t>-1&&L.value.splice(t,1)}},Ve=n=>{const t=w.value.find(a=>a.id===n);if(!t)return;if(isNaN(t.percentage)||t.percentage<0){t.percentage=0;return}const e=Object.values(c.value).reduce((a,d)=>a+(d.percentage||0),0),o=w.value.filter(a=>a.id!==n).reduce((a,d)=>a+(d.percentage||0),0),r=100-e-o;t.percentage>r&&(t.percentage=Math.max(0,r)),G(p.value)},pe=n=>{const t=w.value.find(r=>r.id===n);if(!t)return null;const e=t.columns.reduce((r,a)=>r+(a.percentage||0),0);if(e>t.percentage)return`Total column percentage (${e.toFixed(2)}%) exceeds table limit (${t.percentage}%). Please adjust column percentages.`;const o=t.percentage-e;return o>0?`${o.toFixed(2)}% remaining in ${t.name}`:null},I=n=>{const t=w.value.find(o=>o.id===n);if(!t)return 0;const e=t.columns.reduce((o,r)=>o+(r.percentage||0),0);return Math.max(0,t.percentage-e)},Ge=n=>{const t=w.value.find(a=>a.id===n);if(!t)return;const e=t.columns.reduce((a,d)=>a+(d.percentage||0),0);if(t.percentage-e<=0){alert(`Cannot add more columns. The ${t.name} table is already at ${t.percentage}%. Please reduce other column percentages first.`);return}const r={id:`col-${Date.now()}`,name:"New Column",percentage:0,subcolumns:[]};t.columns.push(r)},Ne=(n,t)=>{const e=w.value.find(r=>r.id===n);if(!e)return;const o=e.columns.findIndex(r=>r.id===t);o>-1&&e.columns.splice(o,1)},Ae=(n,t)=>{const e=w.value.find(d=>d.id===n);if(!e)return;const o=e.columns.find(d=>d.id===t);if(!o)return;if(isNaN(o.percentage)||o.percentage<0){o.percentage=0;return}const r=e.columns.filter(d=>d.id!==t).reduce((d,m)=>d+(m.percentage||0),0),a=e.percentage-r;o.percentage>a&&(o.percentage=Math.max(0,a)),G(p.value)},Be=(n,t)=>{const e=w.value.find(r=>r.id===n);if(!e)return;const o=e.columns.find(r=>r.id===t);o&&o.subcolumns.push({id:`subcol-${Date.now()}`,name:"New Item",maxPoints:100,isAutoFetched:!1})},Ue=(n,t,e)=>{const o=w.value.find(a=>a.id===n);if(!o)return;const r=o.columns.find(a=>a.id===t);if(r){const a=r.subcolumns.findIndex(d=>d.id===e);a>-1&&r.subcolumns.splice(a,1)}},Se=(n,t,e)=>{var D;const o=p.value,r=((D=x.value[n])==null?void 0:D[o])||{},a=`custom-${t}-${e}`,d=w.value.find(F=>F.id===t);if(!d)return 0;const m=d.columns.find(F=>F.id===e);if(!m||m.subcolumns.length===0)return 0;let h=0;const P=m.subcolumns.length;return m.subcolumns.forEach(F=>{const H=`${a}-${F.id}`,O=parseFloat(r[H]||0),W=F.maxPoints||100,R=W>0?O/W*100:0;h+=R}),((P>0?h/P:0)/100*(m.percentage||0)).toFixed(2)},ee=(n,t)=>{const e=w.value.find(a=>a.id===t);if(!e)return 0;let o=0,r=!1;return e.columns.forEach(a=>{a.subcolumns.forEach(d=>{var U;const m=p.value,h=((U=x.value[n])==null?void 0:U[m])||{},P=`custom-${t}-${a.id}-${d.id}`;h[P]&&!isNaN(parseFloat(h[P]))&&(r=!0)}),o+=parseFloat(Se(n,t,a.id)||0)}),r?o.toFixed(2):"0.00"},K=n=>{const t=c.value[n],e=t.columns.reduce((r,a)=>r+(a.percentage||0),0);if(e>t.percentage)return`Total column percentage (${e.toFixed(2)}%) exceeds table limit (${t.percentage}%). Please adjust column percentages.`;const o=t.percentage-e;return o>0?`${o.toFixed(2)}% remaining in ${t.name}`:null},A=n=>{const t=c.value[n],e=t.columns.reduce((o,r)=>o+(r.percentage||0),0);return Math.max(0,t.percentage-e)},ge=S(()=>{if(!c.value)return null;const n=Object.values(c.value).reduce((e,o)=>e+(o.percentage||0),0)+w.value.reduce((e,o)=>e+(o.percentage||0),0),t=100-n;return n>100?`Total grading percentage (${n.toFixed(2)}%) exceeds 100%. Please adjust your table weights.`:t>0?`${t.toFixed(2)}% remaining to distribute`:null}),xe=S(()=>{const n=$.value+j.value;return n!==100?`Midterm + Finals must equal 100% (currently ${n}%)`:null}),ye=n=>{n==="midterm"?isNaN($.value)||$.value<0?$.value=0:$.value>100?($.value=100,j.value=0):j.value=100-$.value:(isNaN(j.value)||j.value<0?j.value=0:j.value>100?(j.value=100,$.value=0):$.value=100-j.value,G("midterm"),G("finals"))},Te=(n,t,e)=>{var D;const o=p.value,r=((D=x.value[n])==null?void 0:D[o])||{},a=`${t}-${e}`,m=c.value[t].columns.find(F=>F.id===e);if(!m)return 0;if(t==="majorExam"){const F=`${a}-exam`,H=r[F]||0,O=m.maxPoints||100;return((O>0?parseFloat(H)/O*100:0)/100*(m.percentage||0)).toFixed(2)}if(m.subcolumns.length===0)return 0;let h=0;const P=m.subcolumns.length;return m.subcolumns.forEach(F=>{const H=`${a}-${F.id}`,O=parseFloat(r[H]||0),W=F.maxPoints||100,R=W>0?O/W*100:0;h+=R}),((P>0?h/P:0)/100*(m.percentage||0)).toFixed(2)},B=(n,t)=>{const e=c.value[t];let o=0,r=!1;return e.columns.forEach(a=>{var d;if(t==="majorExam"){const m=p.value,h=((d=x.value[n])==null?void 0:d[m])||{},P=`${t}-${a.id}-exam`;h[P]&&!isNaN(parseFloat(h[P]))&&(r=!0)}else a.subcolumns.forEach(m=>{var q;const h=p.value,P=((q=x.value[n])==null?void 0:q[h])||{},U=`${t}-${a.id}-${m.id}`;P[U]&&!isNaN(parseFloat(P[U]))&&(r=!0)});o+=parseFloat(Te(n,t,a.id)||0)}),r?o.toFixed(2):"0.00"},ze=n=>{if(!c.value)return 0;let t=0;return Object.keys(c.value).forEach(e=>{t+=parseFloat(B(n,e)||0)}),w.value.forEach(e=>{t+=parseFloat(ee(n,e.id)||0)}),Math.min(t,100).toFixed(2)},te=(n,t,e,o,r)=>{const a=p.value;x.value[n][a]||(x.value[n][a]={});const d=`${t}-${e}-${o}`;x.value[n][a][d]=r,G(a)},Le=(n,t,e,o,r)=>{const a=p.value;x.value[n][a]||(x.value[n][a]={});const d=`custom-${t}-${e}-${o}`;x.value[n][a][d]=r,G(a)},se=(n,t,e,o)=>{var d,m;const r=p.value,a=`${t}-${e}-${o}`;return((m=(d=x.value[n])==null?void 0:d[r])==null?void 0:m[a])||""},Oe=(n,t,e,o)=>{var d,m;const r=p.value,a=`custom-${t}-${e}-${o}`;return((m=(d=x.value[n])==null?void 0:d[r])==null?void 0:m[a])||""};return(n,t)=>(l(),i(g,null,[oe(ne(Ie),{title:`Gradebook - ${V.course.title}`},null,8,["title"]),(l(),He(Ke(je.value),null,{default:re(()=>[s("div",Ze,[Q.value?(l(),i("div",et,[...t[14]||(t[14]=[s("div",{class:"flex items-center"},[s("svg",{class:"w-6 h-6 text-yellow-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("p",{class:"text-yellow-800 font-medium"},"ðŸ“Š Viewing Cached Gradebook (Offline Mode) - Edits will sync when online")],-1)])])):M("",!0),s("div",tt,[s("div",st,[s("div",ot,[s("div",nt,[oe(ne(he),{href:n.route("teacher.courses.show",V.course.id),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition"},{default:re(()=>[...t[15]||(t[15]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),k(" Back to Course ",-1)])]),_:1},8,["href"]),t[16]||(t[16]=s("div",{class:"h-6 w-px bg-gray-300"},null,-1)),s("h1",rt,u(V.course.title)+" - Gradebook",1)]),oe(ne(he),{href:n.route("teacher.courses.class-record",V.course.id),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition flex items-center gap-2"},{default:re(()=>[...t[17]||(t[17]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),k(" Class Record ",-1)])]),_:1},8,["href"])])])]),s("div",at,[s("div",lt,[t[23]||(t[23]=s("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Grading Period Settings",-1)),s("div",it,[s("div",null,[t[19]||(t[19]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Midterm Percentage ",-1)),s("div",dt,[b(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>$.value=e),onBlur:t[1]||(t[1]=e=>ye("midterm")),type:"number",min:"0",max:"100",class:"w-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,544),[[v,$.value,void 0,{number:!0}]]),t[18]||(t[18]=s("span",{class:"text-gray-600"},"%",-1))])]),s("div",null,[t[21]||(t[21]=s("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Finals Percentage ",-1)),s("div",ut,[b(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>j.value=e),onBlur:t[3]||(t[3]=e=>ye("finals")),type:"number",min:"0",max:"100",class:"w-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,544),[[v,j.value,void 0,{number:!0}]]),t[20]||(t[20]=s("span",{class:"text-gray-600"},"%",-1))])])]),xe.value?(l(),i("div",ct,[s("div",mt,[t[22]||(t[22]=s("svg",{class:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),s("p",pt,u(xe.value),1)])])):M("",!0)]),s("div",gt,[s("button",{onClick:t[4]||(t[4]=e=>ie("midterm")),class:T(["bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg p-8 shadow-lg hover:shadow-xl transition transform hover:scale-105",{"ring-4 ring-green-300":p.value==="midterm"}])},[t[24]||(t[24]=s("div",{class:"text-6xl mb-4"},"ðŸŸ©",-1)),t[25]||(t[25]=s("h3",{class:"text-2xl font-bold mb-2"},"Midterm",-1)),s("p",xt,u($.value)+"% of Final Grade",1)],2),s("button",{onClick:t[5]||(t[5]=e=>ie("finals")),class:T(["bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg p-8 shadow-lg hover:shadow-xl transition transform hover:scale-105",{"ring-4 ring-blue-300":p.value==="finals"}])},[t[26]||(t[26]=s("div",{class:"text-6xl mb-4"},"ðŸŸ¦",-1)),t[27]||(t[27]=s("h3",{class:"text-2xl font-bold mb-2"},"Finals",-1)),s("p",yt,u(j.value)+"% of Final Grade",1)],2)]),p.value?(l(),i("div",bt,[ge.value?(l(),i("div",vt,[s("div",ht,[t[28]||(t[28]=s("svg",{class:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})],-1)),s("p",ft,u(ge.value),1)])])):M("",!0),s("div",wt,[s("div",kt,[s("div",_t,[s("div",Ct,[t[30]||(t[30]=s("h3",{class:"text-lg font-bold"},"ðŸŸ© Asynchronous",-1)),s("div",$t,[b(s("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>c.value.asynchronous.percentage=e),onBlur:t[7]||(t[7]=e=>Z("asynchronous")),type:"number",min:"0",max:"100",class:"w-20 px-2 py-1 bg-white/20 border border-white/30 rounded text-white text-center font-bold"},null,544),[[v,c.value.asynchronous.percentage,void 0,{number:!0}]]),t[29]||(t[29]=s("span",{class:"text-white font-bold"},"%",-1))])]),s("p",jt,[k(u(c.value.asynchronous.percentage)+"% of "+u(p.value==="midterm"?"Midterm":"Finals")+" ",1),A("asynchronous")>0?(l(),i("span",Pt," ("+u(A("asynchronous").toFixed(2))+"% remaining) ",1)):M("",!0)])]),s("button",{onClick:t[8]||(t[8]=e=>de("asynchronous")),class:T(["px-4 py-2 bg-white text-green-600 rounded-lg hover:bg-green-50 transition flex items-center gap-2",{"opacity-50 cursor-not-allowed":A("asynchronous")<=0}]),disabled:A("asynchronous")<=0},[...t[31]||(t[31]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),k(" Add Column ",-1)])],10,Ft)]),K("asynchronous")?(l(),i("div",Et,[s("p",Mt,"âš ï¸ "+u(K("asynchronous")),1)])):M("",!0),s("div",Vt,[s("table",Gt,[s("thead",Nt,[s("tr",null,[t[35]||(t[35]=s("th",{class:"px-4 py-3 text-left font-semibold text-gray-700 sticky left-0 bg-gray-50 z-10",rowspan:"2"}," Student Name ",-1)),(l(!0),i(g,null,y(c.value.asynchronous.columns,e=>(l(),i("th",{key:e.id,colspan:Math.max(e.subcolumns.length,1),class:"px-4 py-2 text-center font-semibold text-gray-700 border-l border-gray-200"},[s("div",Bt,[e.isFixed?(l(),i("span",St,u(e.name),1)):b((l(),i("input",{key:0,"onUpdate:modelValue":o=>e.name=o,type:"text",class:"px-2 py-1 border border-gray-300 rounded text-center max-w-[150px]"},null,8,Ut)),[[v,e.name]]),s("span",Tt,"("+u(e.percentage)+"%)",1),e.isFixed?M("",!0):(l(),i("button",{key:2,onClick:o=>ce("asynchronous",e.id),class:"text-red-500 hover:text-red-700"},[...t[32]||(t[32]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,zt))]),s("div",Lt,[e.isFixed?b((l(),i("input",{key:1,"onUpdate:modelValue":o=>e.percentage=o,onBlur:o=>Y("asynchronous",e.id),type:"number",min:"0",max:c.value.asynchronous.percentage,class:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-xs"},null,40,Wt)),[[v,e.percentage,void 0,{number:!0}]]):b((l(),i("input",{key:0,"onUpdate:modelValue":o=>e.percentage=o,onBlur:o=>Y("asynchronous",e.id),type:"number",min:"0",max:c.value.asynchronous.percentage,class:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-xs"},null,40,Ot)),[[v,e.percentage,void 0,{number:!0}]]),s("button",{onClick:o=>ue("asynchronous",e.id),class:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600"}," + Item ",8,Dt)])],8,At))),128)),s("th",Ht,[t[33]||(t[33]=k(" Total",-1)),t[34]||(t[34]=s("br",null,null,-1)),k("("+u(c.value.asynchronous.percentage)+"%) ",1)])]),s("tr",null,[(l(!0),i(g,null,y(c.value.asynchronous.columns,e=>(l(),i(g,{key:`sub-${e.id}`},[(l(!0),i(g,null,y(e.subcolumns,o=>(l(),i("th",{key:o.id,class:"px-2 py-2 text-center text-xs font-medium text-gray-600 border-l border-gray-200"},[s("div",It,[o.isAutoFetched?(l(),i("span",qt,u(o.name),1)):b((l(),i("input",{key:0,"onUpdate:modelValue":r=>o.name=r,type:"text",class:"px-1 py-0.5 border border-gray-300 rounded text-center max-w-[100px] text-xs"},null,8,Kt)),[[v,o.name]]),o.isAutoFetched?M("",!0):(l(),i("button",{key:2,onClick:r=>me("asynchronous",e.id,o.id),class:"text-red-500 hover:text-red-700"},[...t[36]||(t[36]=[s("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Rt))]),s("div",Jt,"("+u(o.maxPoints)+"pts)",1)]))),128))],64))),128))])]),s("tbody",null,[(l(!0),i(g,null,y(V.students,e=>(l(),i("tr",{key:e.id,class:"border-b border-gray-100 hover:bg-gray-50"},[s("td",Qt,u(e.name),1),(l(!0),i(g,null,y(c.value.asynchronous.columns,o=>(l(),i(g,{key:`grade-${o.id}`},[(l(!0),i(g,null,y(o.subcolumns,r=>(l(),i("td",{key:`${o.id}-${r.id}`,class:"px-2 py-2 text-center border-l border-gray-100"},[s("input",{value:se(e.id,"asynchronous",o.id,r.id),onInput:a=>te(e.id,"asynchronous",o.id,r.id,a.target.value),type:"number",min:"0",max:r.maxPoints,step:"0.5",disabled:r.isAutoFetched,class:T(["w-16 px-2 py-1 border rounded text-center text-sm",r.isAutoFetched?"bg-blue-50 border-blue-300 cursor-not-allowed text-blue-700 font-semibold":"bg-white border-gray-300"]),title:r.isAutoFetched?"Auto-fetched from classwork submission":"Manual entry"},null,42,Xt)]))),128))],64))),128)),s("td",Yt,u(B(e.id,"asynchronous")),1)]))),128))])])])]),s("div",Zt,[s("div",es,[s("div",ts,[s("div",ss,[t[38]||(t[38]=s("h3",{class:"text-lg font-bold"},"ðŸŸ¦ Synchronous",-1)),s("div",os,[b(s("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>c.value.synchronous.percentage=e),onBlur:t[10]||(t[10]=e=>Z("synchronous")),type:"number",min:"0",max:"100",class:"w-20 px-2 py-1 bg-white/20 border border-white/30 rounded text-white text-center font-bold"},null,544),[[v,c.value.synchronous.percentage,void 0,{number:!0}]]),t[37]||(t[37]=s("span",{class:"text-white font-bold"},"%",-1))])]),s("p",ns,[k(u(c.value.synchronous.percentage)+"% of "+u(p.value==="midterm"?"Midterm":"Finals")+" ",1),A("synchronous")>0?(l(),i("span",rs," ("+u(A("synchronous").toFixed(2))+"% remaining) ",1)):M("",!0)])]),s("button",{onClick:t[11]||(t[11]=e=>de("synchronous")),class:T(["px-4 py-2 bg-white text-blue-600 rounded-lg hover:bg-blue-50 transition flex items-center gap-2",{"opacity-50 cursor-not-allowed":A("synchronous")<=0}]),disabled:A("synchronous")<=0},[...t[39]||(t[39]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),k(" Add Column ",-1)])],10,as)]),K("synchronous")?(l(),i("div",ls,[s("p",is,"âš ï¸ "+u(K("synchronous")),1)])):M("",!0),c.value.synchronous.columns.length===0?(l(),i("div",ds,[...t[40]||(t[40]=[s("p",{class:"text-lg"},'No columns added yet. Click "Add Column" to start.',-1)])])):(l(),i("div",us,[s("table",cs,[s("thead",ms,[s("tr",null,[t[44]||(t[44]=s("th",{class:"px-4 py-3 text-left font-semibold text-gray-700 sticky left-0 bg-gray-50 z-10",rowspan:"2"}," Student Name ",-1)),(l(!0),i(g,null,y(c.value.synchronous.columns,e=>(l(),i("th",{key:e.id,colspan:Math.max(e.subcolumns.length,1),class:"px-4 py-2 text-center font-semibold text-gray-700 border-l border-gray-200"},[s("div",gs,[b(s("input",{"onUpdate:modelValue":o=>e.name=o,type:"text",class:"px-2 py-1 border border-gray-300 rounded text-center max-w-[150px]"},null,8,xs),[[v,e.name]]),s("span",ys,"("+u(e.percentage)+"%)",1),s("button",{onClick:o=>ce("synchronous",e.id),class:"text-red-500 hover:text-red-700"},[...t[41]||(t[41]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,bs)]),s("div",vs,[b(s("input",{"onUpdate:modelValue":o=>e.percentage=o,onBlur:o=>Y("synchronous",e.id),type:"number",min:"0",max:c.value.synchronous.percentage,class:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-xs"},null,40,hs),[[v,e.percentage,void 0,{number:!0}]]),s("button",{onClick:o=>ue("synchronous",e.id),class:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600"}," + Item ",8,fs)])],8,ps))),128)),s("th",ws,[t[42]||(t[42]=k(" Total",-1)),t[43]||(t[43]=s("br",null,null,-1)),k("("+u(c.value.synchronous.percentage)+"%) ",1)])]),s("tr",null,[(l(!0),i(g,null,y(c.value.synchronous.columns,e=>(l(),i(g,{key:`sub-${e.id}`},[(l(!0),i(g,null,y(e.subcolumns,o=>(l(),i("th",{key:o.id,class:"px-2 py-2 text-center text-xs font-medium text-gray-600 border-l border-gray-200"},[s("div",ks,[b(s("input",{"onUpdate:modelValue":r=>o.name=r,type:"text",class:"px-1 py-0.5 border border-gray-300 rounded text-center max-w-[100px] text-xs"},null,8,_s),[[v,o.name]]),s("button",{onClick:r=>me("synchronous",e.id,o.id),class:"text-red-500 hover:text-red-700"},[...t[45]||(t[45]=[s("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Cs)]),s("div",$s,"("+u(o.maxPoints)+"pts)",1)]))),128))],64))),128))])]),s("tbody",null,[(l(!0),i(g,null,y(V.students,e=>(l(),i("tr",{key:e.id,class:"border-b border-gray-100 hover:bg-gray-50"},[s("td",js,u(e.name),1),(l(!0),i(g,null,y(c.value.synchronous.columns,o=>(l(),i(g,{key:`grade-${o.id}`},[(l(!0),i(g,null,y(o.subcolumns,r=>(l(),i("td",{key:`${o.id}-${r.id}`,class:"px-2 py-2 text-center border-l border-gray-100"},[s("input",{value:se(e.id,"synchronous",o.id,r.id),onInput:a=>te(e.id,"synchronous",o.id,r.id,a.target.value),type:"number",min:"0",max:r.maxPoints,step:"0.5",disabled:r.isAutoFetched,class:T(["w-16 px-2 py-1 border rounded text-center text-sm",r.isAutoFetched?"bg-blue-50 border-blue-300 cursor-not-allowed text-blue-700 font-semibold":"bg-white border-gray-300"]),title:r.isAutoFetched?"Auto-fetched from classwork submission":"Manual entry"},null,42,Ps)]))),128))],64))),128)),s("td",Fs,u(B(e.id,"synchronous")),1)]))),128))])])]))]),s("div",Es,[s("div",Ms,[s("div",Vs,[s("div",Gs,[t[47]||(t[47]=s("h3",{class:"text-lg font-bold"},"ðŸŸ¥ Major Exam",-1)),s("div",Ns,[b(s("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>c.value.majorExam.percentage=e),onBlur:t[13]||(t[13]=e=>Z("majorExam")),type:"number",min:"0",max:"100",class:"w-20 px-2 py-1 bg-white/20 border border-white/30 rounded text-white text-center font-bold"},null,544),[[v,c.value.majorExam.percentage,void 0,{number:!0}]]),t[46]||(t[46]=s("span",{class:"text-white font-bold"},"%",-1))])]),s("p",As,u(c.value.majorExam.percentage)+"% of "+u(p.value==="midterm"?"Midterm":"Finals"),1)])]),s("div",Bs,[s("table",Us,[s("thead",Ss,[s("tr",null,[t[52]||(t[52]=s("th",{class:"px-4 py-3 text-left font-semibold text-gray-700 sticky left-0 bg-gray-50 z-10"}," Student Name ",-1)),(l(!0),i(g,null,y(c.value.majorExam.columns,e=>(l(),i("th",{key:e.id,class:"px-4 py-3 text-center font-semibold text-gray-700 border-l border-gray-200"},[b(s("input",{"onUpdate:modelValue":o=>e.name=o,type:"text",class:"px-2 py-1 border border-gray-300 rounded text-center max-w-[200px]",placeholder:"Exam Name"},null,8,Ts),[[v,e.name]]),s("div",zs,[t[48]||(t[48]=s("span",{class:"text-xs text-gray-500"},"(",-1)),b(s("input",{"onUpdate:modelValue":o=>e.maxPoints=o,type:"number",min:"1",class:"w-16 px-1 py-0.5 border border-gray-300 rounded text-center text-xs",placeholder:"100"},null,8,Ls),[[v,e.maxPoints,void 0,{number:!0}]]),t[49]||(t[49]=s("span",{class:"text-xs text-gray-500"},"pts)",-1))])]))),128)),s("th",Os,[t[50]||(t[50]=k(" Total",-1)),t[51]||(t[51]=s("br",null,null,-1)),k("("+u(c.value.majorExam.percentage)+"%) ",1)])])]),s("tbody",null,[(l(!0),i(g,null,y(V.students,e=>(l(),i("tr",{key:e.id,class:"border-b border-gray-100 hover:bg-gray-50"},[s("td",Ws,u(e.name),1),(l(!0),i(g,null,y(c.value.majorExam.columns,o=>(l(),i("td",{key:`${o.id}`,class:"px-4 py-3 text-center border-l border-gray-100"},[s("input",{value:se(e.id,"majorExam",o.id,"exam"),onInput:r=>te(e.id,"majorExam",o.id,"exam",r.target.value),type:"number",min:"0",max:o.maxPoints||100,step:"0.5",class:"w-20 px-2 py-1 border border-gray-300 rounded text-center"},null,40,Ds)]))),128)),s("td",Hs,u(B(e.id,"majorExam")),1)]))),128))])])])]),(l(!0),i(g,null,y(w.value,e=>(l(),i("div",{key:e.id,class:"bg-white rounded-lg shadow-md overflow-hidden"},[s("div",Is,[s("div",Ks,[s("div",qs,[b(s("input",{"onUpdate:modelValue":o=>e.name=o,type:"text",class:"px-3 py-1 bg-white/20 border border-white/30 rounded text-white placeholder-white/70 font-bold text-lg",placeholder:"Table Name"},null,8,Rs),[[v,e.name]]),s("div",Js,[b(s("input",{"onUpdate:modelValue":o=>e.percentage=o,onBlur:o=>Ve(e.id),type:"number",min:"0",max:"100",class:"w-20 px-2 py-1 bg-white/20 border border-white/30 rounded text-white text-center"},null,40,Qs),[[v,e.percentage,void 0,{number:!0}]]),t[53]||(t[53]=s("span",{class:"text-white"},"%",-1))])]),s("p",Xs,[k(u(e.percentage)+"% of "+u(p.value==="midterm"?"Midterm":"Finals")+" ",1),I(e.id)>0?(l(),i("span",Ys," ("+u(I(e.id).toFixed(2))+"% remaining) ",1)):M("",!0)])]),s("div",Zs,[s("button",{onClick:o=>Ge(e.id),class:T(["px-4 py-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition flex items-center gap-2",{"opacity-50 cursor-not-allowed":I(e.id)<=0}]),disabled:I(e.id)<=0},[...t[54]||(t[54]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),k(" Add Column ",-1)])],10,eo),s("button",{onClick:o=>Me(e.id),class:"px-3 py-2 bg-red-500/80 hover:bg-red-600 text-white rounded-lg transition",title:"Delete Table"},[...t[55]||(t[55]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,to)])]),pe(e.id)?(l(),i("div",so,[s("p",oo,"âš ï¸ "+u(pe(e.id)),1)])):M("",!0),e.columns.length===0?(l(),i("div",no,[...t[56]||(t[56]=[s("p",{class:"text-lg"},'No columns added yet. Click "Add Column" to start.',-1)])])):(l(),i("div",ro,[s("table",ao,[s("thead",lo,[s("tr",null,[t[60]||(t[60]=s("th",{class:"px-4 py-3 text-left font-semibold text-gray-700 sticky left-0 bg-gray-50 z-10",rowspan:"2"}," Student Name ",-1)),(l(!0),i(g,null,y(e.columns,o=>(l(),i("th",{key:o.id,colspan:Math.max(o.subcolumns.length,1),class:"px-4 py-2 text-center font-semibold text-gray-700 border-l border-gray-200"},[s("div",uo,[b(s("input",{"onUpdate:modelValue":r=>o.name=r,type:"text",class:"px-2 py-1 border border-gray-300 rounded text-center max-w-[150px]",placeholder:"Column Name"},null,8,co),[[v,o.name]]),s("span",mo,"("+u(o.percentage)+"%)",1),s("button",{onClick:r=>Ne(e.id,o.id),class:"text-red-500 hover:text-red-700"},[...t[57]||(t[57]=[s("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,po)]),s("div",go,[b(s("input",{"onUpdate:modelValue":r=>o.percentage=r,onBlur:r=>Ae(e.id,o.id),type:"number",min:"0",max:e.percentage,class:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-xs"},null,40,xo),[[v,o.percentage,void 0,{number:!0}]]),s("button",{onClick:r=>Be(e.id,o.id),class:"text-xs px-2 py-1 bg-purple-500 text-white rounded hover:bg-purple-600"}," + Item ",8,yo)])],8,io))),128)),s("th",bo,[t[58]||(t[58]=k(" Total",-1)),t[59]||(t[59]=s("br",null,null,-1)),k("("+u(e.percentage)+"%) ",1)])]),s("tr",null,[(l(!0),i(g,null,y(e.columns,o=>(l(),i(g,{key:`sub-${o.id}`},[(l(!0),i(g,null,y(o.subcolumns,r=>(l(),i("th",{key:r.id,class:"px-2 py-2 text-center text-xs font-medium text-gray-600 border-l border-gray-200"},[s("div",vo,[b(s("input",{"onUpdate:modelValue":a=>r.name=a,type:"text",class:"px-1 py-0.5 border border-gray-300 rounded text-center max-w-[100px] text-xs",placeholder:"Item Name"},null,8,ho),[[v,r.name]]),s("button",{onClick:a=>Ue(e.id,o.id,r.id),class:"text-red-500 hover:text-red-700"},[...t[61]||(t[61]=[s("svg",{class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,fo)]),s("div",wo,[b(s("input",{"onUpdate:modelValue":a=>r.maxPoints=a,type:"number",min:"1",class:"w-12 px-1 py-0.5 border border-gray-300 rounded text-center text-xs"},null,8,ko),[[v,r.maxPoints,void 0,{number:!0}]]),t[62]||(t[62]=s("span",{class:"text-xs text-gray-500"},"pts",-1))])]))),128))],64))),128))])]),s("tbody",null,[(l(!0),i(g,null,y(V.students,o=>(l(),i("tr",{key:o.id,class:"border-b border-gray-100 hover:bg-gray-50"},[s("td",_o,u(o.name),1),(l(!0),i(g,null,y(e.columns,r=>(l(),i(g,{key:`grade-${r.id}`},[(l(!0),i(g,null,y(r.subcolumns,a=>(l(),i("td",{key:`${r.id}-${a.id}`,class:"px-2 py-2 text-center border-l border-gray-100"},[s("input",{value:Oe(o.id,e.id,r.id,a.id),onInput:d=>Le(o.id,e.id,r.id,a.id,d.target.value),type:"number",min:"0",max:a.maxPoints,step:"0.5",class:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-sm"},null,40,Co)]))),128))],64))),128)),s("td",$o,u(ee(o.id,e.id)),1)]))),128))])])]))]))),128)),s("div",{class:"flex justify-center"},[s("button",{onClick:Ee,class:"px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white rounded-lg font-medium transition flex items-center gap-2 shadow-lg"},[...t[63]||(t[63]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),k(" Add Custom Table ",-1)])])]),s("div",jo,[s("div",Po,[s("h3",Fo,"ðŸ“Š "+u(p.value==="midterm"?"Midterm":"Finals")+" Grade Summary",1)]),s("div",Eo,[s("table",Mo,[s("thead",Vo,[s("tr",null,[t[64]||(t[64]=s("th",{class:"px-4 py-3 text-left font-semibold text-gray-700"},"Student Name",-1)),s("th",Go,"Asynchronous ("+u(c.value.asynchronous.percentage)+"%)",1),s("th",No,"Synchronous ("+u(c.value.synchronous.percentage)+"%)",1),s("th",Ao,"Major Exam ("+u(c.value.majorExam.percentage)+"%)",1),(l(!0),i(g,null,y(w.value,e=>(l(),i("th",{key:e.id,class:"px-4 py-3 text-center font-semibold text-gray-700"},u(e.name)+" ("+u(e.percentage)+"%) ",1))),128)),s("th",Bo,u(p.value==="midterm"?"Midterm":"Finals")+" Grade (100%) ",1)])]),s("tbody",null,[(l(!0),i(g,null,y(V.students,e=>(l(),i("tr",{key:e.id,class:"border-b border-gray-100 hover:bg-gray-50"},[s("td",Uo,u(e.name),1),s("td",So,u(B(e.id,"asynchronous")),1),s("td",To,u(B(e.id,"synchronous")),1),s("td",zo,u(B(e.id,"majorExam")),1),(l(!0),i(g,null,y(w.value,o=>(l(),i("td",{key:o.id,class:"px-4 py-3 text-center text-gray-700"},u(ee(e.id,o.id)),1))),128)),s("td",Lo,u(ze(e.id)),1)]))),128))])])])])])):M("",!0)])])]),_:1}))],64))}},qo=Ye(Oo,[["__scopeId","data-v-023ba964"]]);export{qo as default};

import{r as w,c as oe,s as ge,x as Mt,a as r,e,g as v,b as Ne,w as St,j as M,f as k,m as S,t as c,n as T,F as C,k as A,I as U,B as $t,o as n,u as At,d as G,h as Pt,v as Ue,y as Ze,l as Ct,A as jt,q as me}from"./app-CDJn0Pzk.js";import{T as Gt}from"./TeacherLayout-6RngpzKi.js";import{_ as pt}from"./InfoTooltip-Bp-fojYX.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Tt={class:"space-y-6"},Et={class:"bg-white rounded-lg shadow-md p-6"},Ft={class:"flex items-center justify-between mb-6"},Vt={class:"flex items-center gap-2"},Ot={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},zt={class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},Rt={class:"flex items-center gap-2"},Bt={class:"block text-sm font-medium text-gray-700 mb-2 flex items-center gap-1"},Ut={class:"flex items-center gap-2"},Nt={key:0,class:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg"},Lt={class:"text-red-800 text-sm font-medium"},Dt={key:1,class:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg"},Ht={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Qt={class:"flex items-center gap-4"},Jt={class:"text-sm bg-white/20 px-3 py-1 rounded-full"},Wt={class:"flex items-center gap-4"},Yt={class:"text-sm bg-white/20 px-3 py-1 rounded-full"},qt={key:0,class:"bg-white rounded-lg shadow-lg border-4 border-blue-500 overflow-hidden"},Zt={class:"p-6 space-y-6"},Xt={class:"flex justify-between items-center mb-4"},Kt=["disabled"],It={key:0,class:"text-center py-12 bg-blue-50 rounded-lg border-2 border-dashed border-blue-300"},es={class:"bg-gray-100 px-4 py-3 flex items-center justify-between"},ts={class:"flex items-center gap-3"},ss={key:0,class:"px-3 py-1 bg-purple-100 text-purple-700 text-xs font-bold rounded-full"},os={key:1,class:"flex items-center gap-2"},ls=["onBlur","onKeyup"],rs=["onClick","title"],ns={key:3,class:"flex items-center gap-1"},as=["onBlur","onKeyup"],is=["onClick","title"],ds={key:5,class:"text-xs text-gray-500"},us={class:"flex gap-2"},cs=["onClick","disabled"],ms=["onClick"],gs={key:0,class:"overflow-x-auto"},ps={class:"w-full"},bs={class:"bg-gray-50"},vs=["colspan"],fs={class:"flex items-center justify-center gap-2 mb-2"},xs={key:0,class:"flex items-center gap-1"},ys=["onBlur","onKeyup"],hs=["onClick","title"],ws={key:2,class:"flex items-center gap-1"},ks=["onBlur","onKeyup"],_s=["onClick","title"],$s=["onClick"],Cs=["onClick"],js={key:0},Ss={class:"flex flex-col items-center gap-1"},Ms={key:0},As=["onBlur","onKeyup"],Ps=["onClick","title"],Gs={key:2,class:"flex items-center gap-1"},Ts=["onBlur","onKeyup"],Es=["onClick","title"],Fs={key:4,class:"flex gap-1"},Vs=["onClick"],Os={key:5,class:"text-xs text-blue-600",title:"Auto-populated from classwork"},zs={key:0,class:"border-b border-l"},Rs={class:"px-4 py-2 border-b text-sm"},Bs={key:0,class:"w-full px-2 py-1 text-sm border border-purple-300 rounded text-center bg-purple-50 font-semibold text-purple-700"},Us=["value","title"],Ns=["onUpdate:modelValue","max"],Ls={key:0,class:"px-4 py-2 border-b border-l text-center text-sm text-gray-500"},Ds={key:1,class:"p-4 text-center text-gray-500 text-sm"},Hs={class:"bg-blue-50 border border-blue-200 rounded-lg p-4"},Qs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Js={class:"text-sm text-gray-700"},Ws={class:"text-2xl font-bold text-blue-600"},Ys={key:1,class:"bg-white rounded-lg shadow-lg border-4 border-green-500 overflow-hidden"},qs={class:"p-6 space-y-6"},Zs={class:"flex justify-between items-center mb-4"},Xs=["disabled"],Ks={key:0,class:"text-center py-12 bg-green-50 rounded-lg border-2 border-dashed border-green-300"},Is={class:"bg-gray-100 px-4 py-3 flex items-center justify-between"},eo={class:"flex items-center gap-3"},to={key:0,class:"px-3 py-1 bg-purple-100 text-purple-700 text-xs font-bold rounded-full"},so={key:1,class:"flex items-center gap-2"},oo=["onBlur","onKeyup"],lo=["onClick","title"],ro={key:3,class:"flex items-center gap-1"},no=["onBlur","onKeyup"],ao=["onClick","title"],io={key:5,class:"text-xs text-gray-500"},uo={class:"flex gap-2"},co=["onClick","disabled"],mo=["onClick"],go={key:0,class:"overflow-x-auto"},po={class:"w-full"},bo={class:"bg-gray-50"},vo=["colspan"],fo={class:"flex items-center justify-center gap-2 mb-2"},xo={key:0,class:"flex items-center gap-1"},yo=["onBlur","onKeyup"],ho=["onClick","title"],wo={key:2,class:"flex items-center gap-1"},ko=["onBlur","onKeyup"],_o=["onClick","title"],$o=["onClick"],Co=["onClick"],jo={key:0},So={class:"flex flex-col items-center gap-1"},Mo={key:0},Ao=["onBlur","onKeyup"],Po=["onClick","title"],Go={key:2,class:"flex items-center gap-1"},To=["onBlur","onKeyup"],Eo=["onClick","title"],Fo={key:4,class:"flex gap-1"},Vo=["onClick"],Oo={key:5,class:"text-xs text-blue-600",title:"Auto-populated from classwork"},zo={key:0,class:"border-b border-l"},Ro={class:"px-4 py-2 border-b text-sm"},Bo={key:0,class:"w-full px-2 py-1 text-sm border border-purple-300 rounded text-center bg-purple-50 font-semibold text-purple-700"},Uo=["value","title"],No=["onUpdate:modelValue","onInput","max"],Lo={key:0,class:"px-4 py-2 border-b border-l text-center text-sm text-gray-500"},Do={key:1,class:"p-4 text-center text-gray-500 text-sm"},Ho={class:"bg-green-50 border border-green-200 rounded-lg p-4"},Qo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3"},Jo={class:"text-sm text-gray-700"},Wo={class:"text-2xl font-bold text-green-600"},Yo={key:2,class:"mt-8 bg-gradient-to-r from-purple-500 to-indigo-600 rounded-lg shadow-lg overflow-hidden border-4 border-purple-600"},qo={class:"px-6 py-4 bg-purple-600"},Zo={class:"flex items-center justify-between"},Xo={class:"flex items-center gap-2"},Ko={class:"text-sm text-purple-100 mt-1"},Io={class:"p-6 bg-white"},el={class:"overflow-x-auto"},tl={class:"w-full border-collapse"},sl={class:"bg-gradient-to-r from-purple-100 to-indigo-100"},ol={class:"px-4 py-3 text-center text-sm font-bold text-gray-800 border-b-2 border-purple-300 border-l"},ll={class:"text-xs font-normal"},rl={class:"px-4 py-3 text-center text-sm font-bold text-gray-800 border-b-2 border-purple-300 border-l"},nl={class:"text-xs font-normal"},al={class:"px-4 py-3 border-b text-sm font-medium text-gray-900"},il={class:"px-4 py-3 border-b border-l text-center"},dl={class:"inline-flex items-center justify-center px-3 py-1 bg-blue-100 text-blue-800 font-semibold rounded-full text-sm"},ul={class:"px-4 py-3 border-b border-l text-center"},cl={class:"inline-flex items-center justify-center px-3 py-1 bg-green-100 text-green-800 font-semibold rounded-full text-sm"},ml={class:"px-4 py-3 border-b border-l text-center bg-gradient-to-r from-purple-50 to-indigo-50"},gl={class:"inline-flex items-center justify-center px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-bold rounded-full text-lg shadow-lg"},pl={key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},bl={class:"bg-white rounded-lg p-6 w-full max-w-md"},vl={class:"space-y-4"},fl=["max"],xl={class:"text-xs text-gray-500 mt-1"},yl={class:"flex gap-3 mt-6"},hl={key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},wl={class:"bg-white rounded-lg p-6 w-full max-w-md"},kl={class:"space-y-4"},_l={class:"flex gap-3 mt-6"},$l={key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Cl={class:"bg-white rounded-lg p-6 w-full max-w-md"},jl={class:"space-y-4"},Sl=["max"],Ml={class:"text-xs text-gray-500 mt-1"},Al={class:"flex gap-3 mt-6"},Pl={key:6,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Gl={class:"bg-white rounded-lg p-6 w-full max-w-md"},Tl={class:"space-y-4"},El={class:"flex gap-3 mt-6"},Fl={key:7,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Vl={class:"bg-white rounded-lg p-6 w-full max-w-md"},Ol={class:"space-y-4"},zl={class:"flex gap-3 mt-6"},Rl={key:8,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},Bl={class:"bg-white rounded-lg p-6 w-full max-w-md"},Ul={class:"space-y-4"},Nl={class:"flex gap-3 mt-6"},Ll={key:9,class:"fixed bottom-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-2"},Dl={__name:"GradebookContent",props:{course:Object,students:Array,classworks:Array,gradebook:Object},emits:["gradebook-updated"],setup(R,{emit:E}){var tt;const _=R,ke=E,D=w(50),B=w(50),I=w(!0),ee=w(!1),Ee=w(!1),F=w("");let Le=null;const Q=w(!1),K=w(!1),Fe=w(!1),Ve=w(!1),p=w(!1),Y=w(!1),$=w({name:"",percentage:0}),P=w({name:"",percentage:0}),N=w({name:"",maxPoints:100}),z=w(null),J=w(null),pe=w(null),st=w(null),be=w(null),ve=w(null),ne=w(""),le=w(0),_e=w(null),$e=w(null),fe=w(""),ae=w(0),Me=w(null),Ae=w(null),ue=w(""),xe=w(100),ot=(u="midterm")=>({async:{id:"async",name:"Asynchronous",percentage:35,columns:[]},sync:{id:"sync",name:"Synchronous",percentage:35,columns:[]},exam:{id:"exam",name:u==="midterm"?"Midterm Examination":"Final Examination",percentage:30,columns:[]},summary:{id:"summary",name:"Summary",percentage:0,isReadOnly:!0,isSummary:!0,columns:[]}}),q=w(ot("midterm")),Z=w(ot("finals")),L=w({}),W=w({}),re=w(!0);console.log("GradebookContent - Students prop:",_.students),console.log("GradebookContent - Students count:",(tt=_.students)==null?void 0:tt.length),console.log("GradebookContent - Students data:",JSON.stringify(_.students)),_.students&&Array.isArray(_.students)?(_.students.forEach(u=>{L.value[u.id]={midterm:{},finals:{}}}),console.log("GradebookContent - Initialized grades for students:",Object.keys(L.value))):console.error("GradebookContent - No students array received!",_.students);const De=oe(()=>{const u=D.value+B.value;return u!==100?`Total computation weight must be 100%. Currently: ${u}%`:null}),O=u=>u==="midterm"?q.value:Z.value,Pe=u=>{const t=O(u);return Object.values(t).reduce((l,a)=>l+(a.percentage||0),0)},Oe=u=>100-Pe(u),lt=u=>Pe(u)<100,He=u=>{const t=O(u),l=t.summary;if(!l){console.warn(`[Gradebook] Summary table not found for ${u}`);return}const a=[];Object.keys(t).forEach(i=>{i!=="summary"&&!t[i].isSummary&&a.push({id:i,name:t[i].name,percentage:0,subcolumns:[{id:`${i}-value`,name:"Score",maxPoints:100,isAutoPopulated:!0}]})}),a.push({id:"total",name:"Total",percentage:0,subcolumns:[{id:"total-value",name:"Score",maxPoints:100,isAutoPopulated:!0}]}),l.columns=a,console.log(`[Gradebook] Updated ${u} summary columns:`,a.length,a)},ye=(u,t)=>{const a=O(u)[t];return!a||!a.columns?0:a.columns.reduce((i,m)=>i+(m.percentage||0),0)},rt=(u,t)=>{const a=O(u)[t];return a?ye(u,t)<a.percentage:!1},Xe=(u,t)=>{const a=O(u)[t];return a?a.percentage-ye(u,t):0},nt=(u,t,l)=>(O(t),l==="total"?he(u,t):at(u,t,l)||"0.00"),at=(u,t,l)=>{const i=O(t)[l];if(!i)return"0.00";if(i.isSummary)return"N/A";let m=0,g=0;if(i.columns.forEach(o=>{!o.subcolumns||o.subcolumns.length===0||(g+=o.percentage||0)}),g===0)return"0.00";i.columns.forEach(o=>{if(!o.subcolumns||o.subcolumns.length===0)return;let b=0,x=0;if(o.subcolumns.forEach(de=>{var ht,wt,kt,_t;const Te=`${l}-${o.id}-${de.id}`,Ye=de.isAutoPopulated?parseFloat(((wt=(ht=W.value[u])==null?void 0:ht[t])==null?void 0:wt[Te])??0):parseFloat(((_t=(kt=L.value[u])==null?void 0:kt[t])==null?void 0:_t[Te])??0),qe=de.maxPoints||100,yt=Ye<=1&&qe>1?Ye*qe:Ye;b+=isNaN(yt)?0:yt,x+=qe}),x===0)return;const h=b/x,H=(o.percentage||0)/g;m+=h*H});const f=(i.percentage||0)/100;return(m*f*100).toFixed(2)},he=(u,t)=>{const l=O(t);let a=0;return Object.keys(l).forEach(i=>{const m=l[i];m&&m.isSummary||(a+=parseFloat(at(u,t,i))||0)}),Math.min(a,100).toFixed(2)},bt=u=>{const t=parseFloat(he(u,"midterm"))||0,l=parseFloat(he(u,"finals"))||0,a=t*D.value/100,i=l*B.value/100,m=a+i;return Math.min(m,100).toFixed(2)},Qe=u=>{u==="midterm"?(isNaN(D.value)||D.value<0?D.value=0:D.value>100&&(D.value=100),B.value=100-D.value):(isNaN(B.value)||B.value<0?B.value=0:B.value>100&&(B.value=100),D.value=100-B.value)},ze=()=>{const u=i=>(i||"").toString().trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)+/g,"")||"id-"+Date.now(),t=_.classworks.filter(i=>i.grading_period&&i.grade_table_name&&i.grade_main_column),l={};t.forEach(i=>{const m=i.grading_period.toLowerCase(),g=i.grade_table_name,f=i.grade_main_column;l[m]||(l[m]={}),l[m][g]||(l[m][g]={}),l[m][g][f]||(l[m][g][f]=[]),l[m][g][f].push({id:`classwork-${i.id}`,name:i.grade_sub_column||i.title,classworkId:i.id,maxPoints:i.points||100,isAutoPopulated:!0})});const a=(i,m)=>{const g=(i||[]).filter(b=>!b.isAutoPopulated),f=new Set(m.map(b=>b.name.toLowerCase())),o=g.filter(b=>!f.has(b.name.toLowerCase()));return m.forEach(b=>{const x=o.findIndex(h=>h.classworkId===b.classworkId);x===-1?o.push(b):o[x]={...o[x],name:b.name,maxPoints:b.maxPoints,classworkId:b.classworkId,isAutoPopulated:!0}}),o};l.midterm&&Object.keys(l.midterm).forEach(i=>{var f;let m=Object.keys(q.value).find(o=>q.value[o].name.toLowerCase()===i.toLowerCase());if(!m){const o=u(i);q.value[o]={id:o,name:i,percentage:((f=q.value[o])==null?void 0:f.percentage)||0,columns:[]},m=o}const g=q.value[m];Object.keys(l.midterm[i]).forEach(o=>{let b=g.columns.find(x=>x.name.toLowerCase()===o.toLowerCase());b||(b={id:u(o),name:o,percentage:0,subcolumns:[]},g.columns.push(b)),b.subcolumns=a(b.subcolumns,l.midterm[i][o])})}),l.finals&&Object.keys(l.finals).forEach(i=>{var f;let m=Object.keys(Z.value).find(o=>Z.value[o].name.toLowerCase()===i.toLowerCase());if(!m){const o=u(i);Z.value[o]={id:o,name:i,percentage:((f=Z.value[o])==null?void 0:f.percentage)||0,columns:[]},m=o}const g=Z.value[m];Object.keys(l.finals[i]).forEach(o=>{let b=g.columns.find(x=>x.name.toLowerCase()===o.toLowerCase());b||(b={id:u(o),name:o,percentage:0,subcolumns:[]},g.columns.push(b)),b.subcolumns=a(b.subcolumns,l.finals[i][o])})})},Ge=async()=>{console.log("[populateGradesFromSubmissions] Using students submissions data directly");try{if(!_.students||!Array.isArray(_.students)){console.warn("[populateGradesFromSubmissions] No students data available");return}_.students.forEach(t=>{W.value[t.id]||(W.value[t.id]={midterm:{},finals:{}})}),_.students.forEach(t=>{if(!t.submissions||!Array.isArray(t.submissions))return;console.log(`[populateGradesFromSubmissions] Processing student ${t.name}, total submissions: ${t.submissions.length}`);const l=t.submissions.filter(a=>a.grade!==null&&a.grade!==void 0);console.log(`[populateGradesFromSubmissions] Student ${t.name} graded submissions: ${l.length}`),l.forEach(a=>{const i=_.classworks.find(h=>h.id===a.classwork_id);if(console.log(`[populateGradesFromSubmissions] Submission ${a.id} for classwork ${a.classwork_id}:`,{found:!!i,has_grading_period:i==null?void 0:i.grading_period,has_table_name:i==null?void 0:i.grade_table_name,has_main_column:i==null?void 0:i.grade_main_column,grade:a.grade}),!i||!i.grading_period||!i.grade_table_name||!i.grade_main_column){console.warn(`[populateGradesFromSubmissions] Skipping submission ${a.id} - classwork not linked to gradebook`);return}const m=i.grading_period.toLowerCase(),g=m==="midterm"?q.value:Z.value,f=Object.values(g).find(h=>h.name.toLowerCase()===i.grade_table_name.toLowerCase());if(!f)return;const o=f.columns.find(h=>h.name.toLowerCase()===i.grade_main_column.toLowerCase());if(!o)return;const b=o.subcolumns.find(h=>h.classworkId===i.id&&h.isAutoPopulated);if(!b)return;const x=`${f.id}-${o.id}-${b.id}`;W.value[t.id][m]||(W.value[t.id][m]={}),W.value[t.id][m][x]=a.grade,console.log(`[populateGradesFromSubmissions] Set grade for student ${t.id}, ${i.title}: ${a.grade}`)})});const u=(t,l)=>{Object.entries(t).forEach(([a,i])=>{i.columns.forEach(m=>{(m.subcolumns||[]).forEach(g=>{if(!g.isAutoPopulated)return;const f=`${a}-${m.id}-${g.id}`;Object.keys(W.value).forEach(o=>{var x;const b=(x=W.value[o])==null?void 0:x[l];b&&(b[f]===void 0||b[f]===null||b[f]==="")&&(b[f]=0)})})})})};u(q.value,"midterm"),u(Z.value,"finals"),console.log("[populateGradesFromSubmissions] Auto grades populated:",W.value)}catch(u){console.error("[populateGradesFromSubmissions] Error loading submission grades:",u)}},ie=()=>{const u=new Set((_.classworks||[]).map(a=>a.id));console.log("[cleanupRemovedClassworks] Valid classwork IDs:",Array.from(u));let t=0;const l=(a,i)=>{Object.entries(a).forEach(([m,g])=>{g.columns.forEach(f=>{var x;const o=((x=f.subcolumns)==null?void 0:x.length)||0;f.subcolumns=(f.subcolumns||[]).filter(h=>{const H=!h.isAutoPopulated||u.has(h.classworkId);if(!H){console.log(`[cleanupRemovedClassworks] Removing subcolumn "${h.name}" (classworkId: ${h.classworkId})`),t++;const de=`${m}-${f.id}-${h.id}`;Object.keys(W.value).forEach(Te=>{var Ye,qe;((qe=(Ye=W.value[Te])==null?void 0:Ye[i])==null?void 0:qe[de])!==void 0&&delete W.value[Te][i][de]})}return H});const b=f.subcolumns.length;o!==b&&console.log(`[cleanupRemovedClassworks] Column "${f.name}" subcolumns: ${o} -> ${b}`)})})};return l(q.value,"midterm"),l(Z.value,"finals"),t>0&&console.log(`[Gradebook] Removed ${t} auto-populated subcolumns`),t},Ke=u=>{u==="midterm"?(I.value=!I.value,I.value&&(ee.value=!1,sessionStorage.setItem(`gradebook_section_${_.course.id}`,"midterm"))):(ee.value=!ee.value,ee.value&&(I.value=!1,sessionStorage.setItem(`gradebook_section_${_.course.id}`,"finals")))},Re=u=>{z.value=u;const t=Oe(u);$.value={name:"",percentage:t>0?t:0},Q.value=!0},it=()=>{if(!$.value.name||$.value.percentage<=0){alert("Please enter a valid table name and percentage");return}if(Pe(z.value)+$.value.percentage>100){alert(`You've exceeded 100% of total grading weight for ${z.value==="midterm"?"Midterm":"Finals"}. Adjust your table percentages.`);return}const t=$.value.name.toLowerCase().replace(/\s+/g,"-")+"-"+Date.now(),l=z.value==="midterm"?q:Z;l.value[t]={id:t,name:$.value.name,percentage:$.value.percentage,columns:[]},Q.value=!1,j()},vt=()=>{if(!$.value.name||$.value.percentage<=0){alert("Please enter a valid table name and percentage");return}const t=O(z.value)[J.value];if(Pe(z.value)-t.percentage+$.value.percentage>100){alert(`You've exceeded 100% of total grading weight for ${z.value==="midterm"?"Midterm":"Finals"}. Adjust your table percentages.`);return}const a=ye(z.value,J.value);$.value.percentage<a&&!confirm(`Warning: The new table percentage (${$.value.percentage}%) is less than the current columns total (${a}%). You will need to adjust the column percentages. Continue?`)||(t.name=$.value.name,t.percentage=$.value.percentage,K.value=!1,J.value=null,j())},dt=(u,t)=>{if(confirm("Are you sure you want to delete this table? All data will be lost.")){const l=u==="midterm"?q:Z;delete l.value[t],ze(),ie(),Ge(),j()}},ut=(u,t)=>{const a=O(u)[t];be.value=`${u}-${t}`,ne.value=a.name},Je=(u,t)=>{if(ne.value.trim()){const l=O(u);l[t].name=ne.value.trim(),j()}be.value=null,ne.value=""},ct=(u,t)=>{const a=O(u)[t];ve.value=`${u}-${t}`,le.value=a.percentage},Ce=(u,t)=>{const a=O(u)[t],i=Pe(u)-a.percentage;i+le.value>100&&(le.value=100-i),le.value<0&&(le.value=0),a.percentage=le.value,ve.value=null,j()},je=(u,t,l)=>{const m=O(u)[t].columns[l];_e.value=`${u}-${t}-${l}`,fe.value=m.name},X=(u,t,l)=>{if(fe.value.trim()){const i=O(u)[t];i.columns[l].name=fe.value.trim(),j()}_e.value=null,fe.value=""},Se=(u,t,l)=>{const m=O(u)[t].columns[l];$e.value=`${u}-${t}-${l}`,ae.value=m.percentage},ce=(u,t,l)=>{const i=O(u)[t],m=i.columns[l],g=ye(u,t)-m.percentage;g+ae.value>i.percentage&&(ae.value=i.percentage-g),ae.value<0&&(ae.value=0),m.percentage=ae.value,$e.value=null,j()},se=(u,t,l,a)=>{const f=O(u)[t].columns[l].subcolumns[a];f.isAutoPopulated||(Me.value=`${u}-${t}-${l}-${a}`,ue.value=f.name)},Be=(u,t,l,a)=>{if(ue.value.trim()){const g=O(u)[t].columns[l];g.subcolumns[a].name=ue.value.trim(),j()}Me.value=null,ue.value=""},mt=(u,t,l,a)=>{const f=O(u)[t].columns[l].subcolumns[a];f.isAutoPopulated||(Ae.value=`${u}-${t}-${l}-${a}`,xe.value=f.maxPoints)},We=(u,t,l,a)=>{if(xe.value>0){const g=O(u)[t].columns[l];g.subcolumns[a].maxPoints=xe.value,j()}Ae.value=null,xe.value=100},gt=(u,t)=>{z.value=u,J.value=t;const l=Xe(u,t);P.value={name:"",percentage:l>0?l:0},Fe.value=!0},ft=()=>{if(!P.value.name||P.value.percentage<=0){alert("Please enter a valid column name and percentage");return}const t=O(z.value)[J.value];if(ye(z.value,J.value)+P.value.percentage>t.percentage){alert(`${t.name} table exceeds its total weight of ${t.percentage}%. Adjust column percentages.`);return}const a=P.value.name.toLowerCase().replace(/\s+/g,"-")+"-"+Date.now();t.columns.push({id:a,name:P.value.name,percentage:P.value.percentage,subcolumns:[]}),Fe.value=!1,J.value=null,j()},xt=()=>{if(!P.value.name||P.value.percentage<=0){alert("Please enter a valid column name and percentage");return}const t=O(z.value)[J.value],l=t.columns[pe.value];if(ye(z.value,J.value)-l.percentage+P.value.percentage>t.percentage){alert(`${t.name} table exceeds its total weight of ${t.percentage}%. Adjust column percentages.`);return}l.name=P.value.name,l.percentage=P.value.percentage,Ve.value=!1,J.value=null,pe.value=null,j()},Ie=(u,t,l)=>{confirm("Are you sure you want to delete this column? All data will be lost.")&&(O(u)[t].columns.splice(l,1),ze(),ie(),Ge(),j())},et=(u,t,l)=>{z.value=u,J.value=t,pe.value=l,N.value={name:"",maxPoints:100},p.value=!0},d=()=>{if(!N.value.name||N.value.maxPoints<=0){alert("Please enter a valid subcolumn name and max points");return}const l=O(z.value)[J.value].columns[pe.value],a=N.value.name.toLowerCase().replace(/\s+/g,"-")+"-"+Date.now();l.subcolumns.push({id:a,name:N.value.name,maxPoints:N.value.maxPoints,isAutoPopulated:!1}),p.value=!1,J.value=null,pe.value=null,j()},s=()=>{if(!N.value.name||N.value.maxPoints<=0){alert("Please enter a valid subcolumn name and max points");return}const a=O(z.value)[J.value].columns[pe.value].subcolumns[st.value];a.name=N.value.name,a.maxPoints=N.value.maxPoints,Y.value=!1,J.value=null,pe.value=null,st.value=null,j()},y=(u,t,l,a)=>{confirm("Are you sure you want to delete this subcolumn? All data will be lost.")&&(O(u)[t].columns[l].subcolumns.splice(a,1),j())},V=(u,t)=>{const l=new Set;Object.entries(t).forEach(([i,m])=>{(m.columns||[]).forEach(g=>{(g.subcolumns||[]).forEach(f=>{f.isAutoPopulated&&l.add(`${i}-${g.id}-${f.id}`)})})});const a={};return Object.keys(u).forEach(i=>{a[i]={},Object.keys(u[i]||{}).forEach(m=>{l.has(m)||(a[i][m]=u[i][m])})}),a},j=async()=>{var u,t;if(re.value){console.log("[Gradebook] Skipping save during initialization");return}Ee.value=!0,F.value="Savingâ€¦";try{const l=x=>{if(!x||typeof x!="object")return{};if(!Array.isArray(x))return x;const h={};return x.forEach(H=>{typeof H=="object"&&!Array.isArray(H)&&Object.assign(h,H)}),h},a=V(Object.keys(L.value).reduce((x,h)=>(x[h]=l(L.value[h].midterm),x),{}),q.value),i=V(Object.keys(L.value).reduce((x,h)=>(x[h]=l(L.value[h].finals),x),{}),Z.value);console.log("[Gradebook] Finals grades being saved:",JSON.stringify(i,null,2));const m=x=>{const h={};return Object.keys(L.value).forEach(H=>{h[H]=he(H,x)}),console.log(`[Gradebook] Calculated ${x} period totals:`,h),h},g=m("midterm"),f=m("finals"),o={midtermPercentage:D.value,finalsPercentage:B.value,midterm:{tables:Object.values(q.value),grades:a,periodGrades:g},finals:{tables:Object.values(Z.value),grades:i,periodGrades:f}};console.log("[Gradebook] Saving data with periodGrades:",{midterm:g,finals:f}),console.log("[Gradebook] Saving gradebook to database (manual grades only)");const b=await $t.post(`/teacher/courses/${_.course.id}/gradebook/save`,o);console.log("[Gradebook] Gradebook saved successfully:",b.data),ke("gradebook-updated",o),console.log("[Gradebook] Emitted gradebook-updated event")}catch(l){console.error("[Gradebook] Error saving gradebook:",l),alert("Error saving gradebook: "+(((t=(u=l.response)==null?void 0:u.data)==null?void 0:t.message)||l.message))}finally{Ee.value=!1,F.value="All changes saved",setTimeout(()=>{F.value==="All changes saved"&&(F.value="")},2e3)}},te=()=>{Le&&clearTimeout(Le),Le=setTimeout(()=>{j()},500)};ge(L,()=>{te()},{deep:!0});const we=async()=>{try{const u=await $t.get(`/teacher/courses/${_.course.id}/gradebook/load`);if(u.data&&u.data.gradebook){const t=u.data.gradebook;if(t.midtermPercentage!==void 0&&(D.value=t.midtermPercentage),t.finalsPercentage!==void 0&&(B.value=t.finalsPercentage),t.midterm&&t.midterm.tables&&t.midterm.tables.length>0){const l={};t.midterm.tables.forEach(a=>{l[a.id]=a}),q.value=l}if(t.finals&&t.finals.tables&&t.finals.tables.length>0){const l={};t.finals.tables.forEach(a=>{l[a.id]=a}),Z.value=l}t.midterm&&t.midterm.grades&&(console.log("[Gradebook] Loading midterm grades:",t.midterm.grades),Object.keys(t.midterm.grades).forEach(l=>{if(L.value[l]){const a=t.midterm.grades[l];Array.isArray(a)?(console.warn(`[Gradebook] Midterm grades for student ${l} is an array, converting to object`),L.value[l].midterm={}):L.value[l].midterm={...a}}})),t.finals&&t.finals.grades?(console.log("[Gradebook] Loading finals grades from DB:",JSON.stringify(t.finals.grades,null,2)),Object.keys(t.finals.grades).forEach(l=>{if(L.value[l]){const a=t.finals.grades[l];Array.isArray(a)?(console.warn(`[Gradebook] Finals grades for student ${l} is an array, converting to object`),L.value[l].finals={}):L.value[l].finals={...a},console.log(`[Gradebook] Loaded finals grades for student ${l}:`,JSON.stringify(L.value[l].finals,null,2))}else console.warn(`[Gradebook] Student ${l} not found in studentGrades.value`)})):console.log("[Gradebook] No finals grades found in database")}}catch(u){console.error("Error loading gradebook:",u)}};return Mt(async()=>{console.log("[Gradebook] Initializing..."),re.value=!0,sessionStorage.getItem(`gradebook_section_${_.course.id}`)==="finals"?(I.value=!1,ee.value=!0):(I.value=!0,ee.value=!1),await we(),ie(),ze(),await Ge(),He("midterm"),He("finals"),re.value=!1,console.log("[Gradebook] Initialization complete"),console.log("[Gradebook] Initial save to persist periodGrades..."),j()}),ge(()=>_.classworks,async(u,t)=>{console.log("[Gradebook] Classworks changed, syncing gradebook..."),console.log("[Gradebook] Old count:",t==null?void 0:t.length,"New count:",u==null?void 0:u.length),ie(),ze(),await Ge(),He("midterm"),He("finals"),re.value||(console.log("[Gradebook] Saving gradebook after classwork sync..."),j())},{deep:!0}),ge(()=>_.students,async()=>{console.log("[Gradebook] Students data changed, refreshing grades..."),await Ge(),re.value||(console.log("[Gradebook] Saving after student grades refresh..."),j())},{deep:!0}),ge(()=>W.value,()=>{re.value||(console.log("[Gradebook] Auto grades changed, scheduling save..."),te())},{deep:!0}),ge(()=>D.value,()=>{re.value||(console.log("[Gradebook] Midterm percentage changed, scheduling save..."),te())}),ge(()=>B.value,()=>{re.value||(console.log("[Gradebook] Finals percentage changed, scheduling save..."),te())}),(u,t)=>(n(),r("div",Tt,[e("div",Et,[e("div",Ft,[e("div",Vt,[t[53]||(t[53]=e("h2",{class:"text-2xl font-bold text-gray-900 flex items-center gap-2"}," âš™ï¸ Grade Computation Setup ",-1)),Ne(pt,{title:"Grade Computation Setup",position:"right"},{default:St(()=>[...t[52]||(t[52]=[e("p",{class:"mb-2"},[e("strong",null,"Purpose:"),M(" Configure how midterm and finals grades contribute to the final grade.")],-1),e("p",{class:"mb-2"},[e("strong",null,"Formula:"),M(" Final Grade = (Midterm Ã— %Midterm) + (Finals Ã— %Finals)")],-1),e("p",null,[e("strong",null,"Note:"),M(" The two percentages must total 100%.")],-1)])]),_:1})])]),e("div",Ot,[e("div",null,[e("label",zt,[t[54]||(t[54]=M(" Midterm Percentage ",-1)),Ne(pt,{content:"Set the weight of midterm grades in the final grade calculation. Must be between 0-100%. The midterm and finals percentages must add up to 100%.",position:"right"})]),e("div",Rt,[k(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>D.value=l),onBlur:t[1]||(t[1]=l=>Qe("midterm")),type:"number",min:"0",max:"100",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,544),[[S,D.value,void 0,{number:!0}]]),t[55]||(t[55]=e("span",{class:"text-lg font-semibold text-gray-700"},"%",-1))])]),e("div",null,[e("label",Bt,[t[56]||(t[56]=M(" Finals Percentage ",-1)),Ne(pt,{content:"Set the weight of finals grades in the final grade calculation. Must be between 0-100%. The midterm and finals percentages must add up to 100%.",position:"right"})]),e("div",Ut,[k(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>B.value=l),onBlur:t[3]||(t[3]=l=>Qe("finals")),type:"number",min:"0",max:"100",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,544),[[S,B.value,void 0,{number:!0}]]),t[57]||(t[57]=e("span",{class:"text-lg font-semibold text-gray-700"},"%",-1))])])]),De.value?(n(),r("div",Nt,[e("p",Lt,"âš ï¸ "+c(De.value),1)])):(n(),r("div",Dt,[...t[58]||(t[58]=[e("p",{class:"text-green-800 text-sm font-medium"},"âœ… Total computation weight: 100%",-1)])]))]),e("div",Ht,[e("button",{onClick:t[4]||(t[4]=l=>Ke("midterm")),class:T(["bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow-lg overflow-hidden px-6 py-4 flex items-center justify-between text-white hover:from-blue-600 hover:to-blue-700 transition-all",{"ring-4 ring-blue-300":I.value}])},[t[60]||(t[60]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"ðŸ“˜"),e("h3",{class:"text-xl font-bold"},"Midterm Grading Setup")],-1)),e("div",Qt,[e("span",Jt," Remaining: "+c(Oe("midterm"))+"% ",1),(n(),r("svg",{class:T(["w-6 h-6 transform transition-transform",{"rotate-180":I.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[59]||(t[59]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],2),e("button",{onClick:t[5]||(t[5]=l=>Ke("finals")),class:T(["bg-gradient-to-r from-green-500 to-green-600 rounded-lg shadow-lg overflow-hidden px-6 py-4 flex items-center justify-between text-white hover:from-green-600 hover:to-green-700 transition-all",{"ring-4 ring-green-300":ee.value}])},[t[62]||(t[62]=e("div",{class:"flex items-center gap-3"},[e("span",{class:"text-2xl"},"ï¿½"),e("h3",{class:"text-xl font-bold"},"Finals Grading Setup")],-1)),e("div",Wt,[e("span",Yt," Remaining: "+c(Oe("finals"))+"% ",1),(n(),r("svg",{class:T(["w-6 h-6 transform transition-transform",{"rotate-180":ee.value}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[61]||(t[61]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))])],2)]),I.value?(n(),r("div",qt,[t[77]||(t[77]=e("div",{class:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-3"},[e("h3",{class:"text-xl font-bold text-white flex items-center gap-2"}," ðŸ“˜ Midterm Period Grading ")],-1)),e("div",Zt,[e("div",Xt,[t[64]||(t[64]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Grading Tables",-1)),e("button",{onClick:t[6]||(t[6]=l=>Re("midterm")),disabled:!lt("midterm"),class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-2"},[...t[63]||(t[63]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add Table ",-1)])],8,Kt)]),Object.keys(q.value).length===0?(n(),r("div",It,[t[66]||(t[66]=e("svg",{class:"w-16 h-16 mx-auto text-blue-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[67]||(t[67]=e("h3",{class:"text-xl font-semibold text-gray-700 mb-2"},"No Grading Tables Yet",-1)),t[68]||(t[68]=e("p",{class:"text-gray-600 mb-4"},"Start designing your grading system by adding your first table",-1)),e("button",{onClick:t[7]||(t[7]=l=>Re("midterm")),class:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 inline-flex items-center gap-2 font-semibold"},[...t[65]||(t[65]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Create First Table ",-1)])])])):v("",!0),(n(!0),r(C,null,A(q.value,(l,a)=>(n(),r("div",{key:a,class:"border border-gray-300 rounded-lg overflow-hidden"},[e("div",es,[e("div",ts,[l.isSummary?(n(),r("span",ss," AUTO-COMPUTED ")):v("",!0),be.value===`midterm-${a}`&&!l.isReadOnly?(n(),r("div",os,[k(e("input",{"onUpdate:modelValue":t[8]||(t[8]=i=>ne.value=i),onBlur:i=>Je("midterm",a),onKeyup:[U(i=>Je("midterm",a),["enter"]),t[9]||(t[9]=U(i=>be.value=null,["esc"]))],class:"px-3 py-1 border-2 border-blue-500 rounded font-semibold text-gray-900 focus:outline-none",autofocus:""},null,40,ls),[[S,ne.value]])])):(n(),r("h5",{key:2,onClick:i=>!l.isReadOnly&&ut("midterm",a),class:T(["font-semibold text-gray-900",l.isReadOnly?"cursor-default":"cursor-pointer hover:text-blue-600 hover:underline"]),title:l.isReadOnly?"Summary table (read-only)":"Click to edit table name"},c(l.name),11,rs)),ve.value===`midterm-${a}`&&!l.isReadOnly?(n(),r("div",ns,[k(e("input",{"onUpdate:modelValue":t[10]||(t[10]=i=>le.value=i),onBlur:i=>Ce("midterm",a),onKeyup:[U(i=>Ce("midterm",a),["enter"]),t[11]||(t[11]=U(i=>ve.value=null,["esc"]))],type:"number",min:"0",max:"100",class:"w-16 px-2 py-1 border-2 border-blue-500 rounded text-sm text-gray-600 text-center focus:outline-none",autofocus:""},null,40,as),[[S,le.value,void 0,{number:!0}]]),t[69]||(t[69]=e("span",{class:"text-sm text-gray-600"},"%",-1))])):l.isSummary?v("",!0):(n(),r("span",{key:4,onClick:i=>!l.isReadOnly&&ct("midterm",a),class:T(["text-sm text-gray-600 bg-white px-3 py-1 rounded-full",l.isReadOnly?"cursor-default":"cursor-pointer hover:bg-blue-100 hover:text-blue-700"]),title:l.isReadOnly?"Summary table (read-only)":"Click to edit percentage"},c(l.percentage)+"% ",11,is)),l.isSummary?v("",!0):(n(),r("span",ds," (Columns: "+c(ye("midterm",a))+"% / "+c(l.percentage)+"%) ",1))]),e("div",us,[l.isReadOnly?v("",!0):(n(),r("button",{key:0,onClick:i=>gt("midterm",a),disabled:!rt("midterm",a),class:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-300"}," + Column ",8,cs)),l.isReadOnly?v("",!0):(n(),r("button",{key:1,onClick:i=>dt("midterm",a),class:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700"}," Delete ",8,ms))])]),l.columns&&l.columns.length>0?(n(),r("div",gs,[e("table",ps,[e("thead",bs,[e("tr",null,[t[72]||(t[72]=e("th",{class:"px-4 py-2 text-left text-sm font-semibold text-gray-700 border-b"},"Student",-1)),(n(!0),r(C,null,A(l.columns,(i,m)=>(n(),r("th",{key:i.id,colspan:i.subcolumns.length||1,class:"px-4 py-2 text-center text-sm font-semibold text-gray-700 border-b border-l"},[e("div",fs,[_e.value===`midterm-${a}-${m}`&&!l.isReadOnly?(n(),r("div",xs,[k(e("input",{"onUpdate:modelValue":t[12]||(t[12]=g=>fe.value=g),onBlur:g=>X("midterm",a,m),onKeyup:[U(g=>X("midterm",a,m),["enter"]),t[13]||(t[13]=U(g=>_e.value=null,["esc"]))],class:"px-2 py-1 border-2 border-blue-500 rounded text-sm focus:outline-none",autofocus:""},null,40,ys),[[S,fe.value]])])):(n(),r("span",{key:1,onClick:g=>!l.isReadOnly&&je("midterm",a,m),class:T([l.isReadOnly?"cursor-default":"cursor-pointer hover:text-blue-600 hover:underline"]),title:l.isReadOnly?"Read-only column":"Click to edit column name"},c(i.name),11,hs)),$e.value===`midterm-${a}-${m}`&&!l.isReadOnly?(n(),r("div",ws,[t[70]||(t[70]=e("span",null,"(",-1)),k(e("input",{"onUpdate:modelValue":t[14]||(t[14]=g=>ae.value=g),onBlur:g=>ce("midterm",a,m),onKeyup:[U(g=>ce("midterm",a,m),["enter"]),t[15]||(t[15]=U(g=>$e.value=null,["esc"]))],type:"number",min:"0",class:"w-12 px-1 py-1 border-2 border-blue-500 rounded text-sm text-center focus:outline-none",autofocus:""},null,40,ks),[[S,ae.value,void 0,{number:!0}]]),t[71]||(t[71]=e("span",null,"%)",-1))])):l.isSummary?v("",!0):(n(),r("span",{key:3,onClick:g=>!l.isReadOnly&&Se("midterm",a,m),class:T([l.isReadOnly?"cursor-default":"cursor-pointer hover:text-blue-600 hover:underline"]),title:l.isReadOnly?"Read-only column":"Click to edit percentage"}," ("+c(i.percentage)+"%) ",11,_s)),l.isReadOnly?v("",!0):(n(),r("button",{key:4,onClick:g=>et("midterm",a,m),class:"text-xs px-2 py-1 bg-blue-500 text-white rounded hover:bg-blue-600",title:"Add Subcolumn"}," + Sub ",8,$s)),l.isReadOnly?v("",!0):(n(),r("button",{key:5,onClick:g=>Ie("midterm",a,m),class:"text-red-600 hover:text-red-800"}," ðŸ—‘ï¸ ",8,Cs))])],8,vs))),128))]),l.columns.some(i=>i.subcolumns&&i.subcolumns.length>0)?(n(),r("tr",js,[t[75]||(t[75]=e("th",{class:"px-4 py-2 border-b"},null,-1)),(n(!0),r(C,null,A(l.columns,(i,m)=>(n(),r(C,{key:i.id+"-sub"},[(n(!0),r(C,null,A(i.subcolumns,(g,f)=>(n(),r("th",{key:g.id,class:"px-2 py-2 text-center text-xs text-gray-600 border-b border-l"},[e("div",Ss,[Me.value===`midterm-${a}-${m}-${f}`?(n(),r("div",Ms,[k(e("input",{"onUpdate:modelValue":t[16]||(t[16]=o=>ue.value=o),onBlur:o=>Be("midterm",a,m,f),onKeyup:[U(o=>Be("midterm",a,m,f),["enter"]),t[17]||(t[17]=U(o=>Me.value=null,["esc"]))],class:"px-2 py-1 border-2 border-blue-500 rounded text-xs focus:outline-none w-24",autofocus:""},null,40,As),[[S,ue.value]])])):(n(),r("div",{key:1,onClick:o=>se("midterm",a,m,f),class:T(["cursor-pointer hover:text-blue-600 hover:underline",{"cursor-not-allowed opacity-50":g.isAutoPopulated}]),title:g.isAutoPopulated?"Auto-populated from classwork":"Click to edit name"},c(g.name),11,Ps)),Ae.value===`midterm-${a}-${m}-${f}`?(n(),r("div",Gs,[t[73]||(t[73]=e("span",{class:"text-gray-500"},"(",-1)),k(e("input",{"onUpdate:modelValue":t[18]||(t[18]=o=>xe.value=o),onBlur:o=>We("midterm",a,m,f),onKeyup:[U(o=>We("midterm",a,m,f),["enter"]),t[19]||(t[19]=U(o=>Ae.value=null,["esc"]))],type:"number",min:"1",class:"w-12 px-1 py-1 border-2 border-blue-500 rounded text-xs text-center focus:outline-none",autofocus:""},null,40,Ts),[[S,xe.value,void 0,{number:!0}]]),t[74]||(t[74]=e("span",{class:"text-gray-500"},"pts)",-1))])):(n(),r("div",{key:3,onClick:o=>mt("midterm",a,m,f),class:T(["text-gray-500 cursor-pointer hover:text-blue-600",{"cursor-not-allowed opacity-50":g.isAutoPopulated}]),title:g.isAutoPopulated?"Auto-populated from classwork":"Click to edit max points"}," ("+c(g.maxPoints)+" pts) ",11,Es)),g.isAutoPopulated?(n(),r("div",Os," ðŸ“ Auto ")):(n(),r("div",Fs,[e("button",{onClick:o=>y("midterm",a,m,f),class:"text-red-600 hover:text-red-800 text-xs",title:"Delete Subcolumn"}," ðŸ—‘ï¸ ",8,Vs)]))])]))),128)),!i.subcolumns||i.subcolumns.length===0?(n(),r("th",zs)):v("",!0)],64))),128))])):v("",!0)]),e("tbody",null,[(n(!0),r(C,null,A(_.students,i=>(n(),r("tr",{key:i.id,class:"hover:bg-gray-50"},[e("td",Rs,c(i.name),1),(n(!0),r(C,null,A(l.columns,m=>(n(),r(C,{key:m.id},[(n(!0),r(C,null,A(m.subcolumns,g=>{var f,o,b,x;return n(),r("td",{key:g.id,class:"px-2 py-2 border-b border-l"},[l.isSummary?(n(),r("div",Bs,c(nt(i.id,"midterm",m.id)),1)):g.isAutoPopulated?(n(),r("input",{key:1,value:((o=(f=W.value[i.id])==null?void 0:f.midterm)==null?void 0:o[`${a}-${m.id}-${g.id}`])??0,type:"number",disabled:"",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded text-center bg-gray-100 cursor-not-allowed",title:"Auto-populated from submission: "+(((x=(b=W.value[i.id])==null?void 0:b.midterm)==null?void 0:x[`${a}-${m.id}-${g.id}`])??0)},null,8,Us)):k((n(),r("input",{key:2,"onUpdate:modelValue":h=>L.value[i.id].midterm[`${a}-${m.id}-${g.id}`]=h,onBlur:j,type:"number",max:g.maxPoints,min:"0",step:"0.01",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded text-center focus:ring-2 focus:ring-blue-500"},null,40,Ns)),[[S,L.value[i.id].midterm[`${a}-${m.id}-${g.id}`]]])])}),128)),!m.subcolumns||m.subcolumns.length===0?(n(),r("td",Ls," N/A ")):v("",!0)],64))),128))]))),128))])])])):(n(),r("div",Ds,' No columns added yet. Click "+ Column" to add grading columns. '))]))),128)),e("div",Hs,[t[76]||(t[76]=e("h5",{class:"font-semibold text-blue-900 mb-3"},"Midterm Period Grades",-1)),e("div",Qs,[(n(!0),r(C,null,A(_.students,l=>(n(),r("div",{key:l.id,class:"bg-white p-3 rounded-lg border border-blue-200"},[e("p",Js,c(l.name),1),e("p",Ws,c(he(l.id,"midterm")),1)]))),128))])])])])):v("",!0),ee.value?(n(),r("div",Ys,[t[92]||(t[92]=e("div",{class:"bg-gradient-to-r from-green-500 to-green-600 px-6 py-3"},[e("h3",{class:"text-xl font-bold text-white flex items-center gap-2"}," ðŸ“— Finals Period Grading ")],-1)),e("div",qs,[e("div",Zs,[t[79]||(t[79]=e("h4",{class:"text-lg font-semibold text-gray-900"},"Grading Tables",-1)),e("button",{onClick:t[20]||(t[20]=l=>Re("finals")),disabled:!lt("finals"),class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center gap-2"},[...t[78]||(t[78]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add Table ",-1)])],8,Xs)]),Object.keys(Z.value).length===0?(n(),r("div",Ks,[t[81]||(t[81]=e("svg",{class:"w-16 h-16 mx-auto text-green-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),t[82]||(t[82]=e("h3",{class:"text-xl font-semibold text-gray-700 mb-2"},"No Grading Tables Yet",-1)),t[83]||(t[83]=e("p",{class:"text-gray-600 mb-4"},"Start designing your grading system by adding your first table",-1)),e("button",{onClick:t[21]||(t[21]=l=>Re("finals")),class:"px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 inline-flex items-center gap-2 font-semibold"},[...t[80]||(t[80]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Create First Table ",-1)])])])):v("",!0),(n(!0),r(C,null,A(Z.value,(l,a)=>(n(),r("div",{key:a,class:"border border-gray-300 rounded-lg overflow-hidden"},[e("div",Is,[e("div",eo,[l.isSummary?(n(),r("span",to," AUTO-COMPUTED ")):v("",!0),be.value===`finals-${a}`&&!l.isReadOnly?(n(),r("div",so,[k(e("input",{"onUpdate:modelValue":t[22]||(t[22]=i=>ne.value=i),onBlur:i=>Je("finals",a),onKeyup:[U(i=>Je("finals",a),["enter"]),t[23]||(t[23]=U(i=>be.value=null,["esc"]))],class:"px-3 py-1 border-2 border-green-500 rounded font-semibold text-gray-900 focus:outline-none",autofocus:""},null,40,oo),[[S,ne.value]])])):(n(),r("h5",{key:2,onClick:i=>!l.isReadOnly&&ut("finals",a),class:T(["font-semibold text-gray-900",l.isReadOnly?"cursor-default":"cursor-pointer hover:text-green-600 hover:underline"]),title:l.isReadOnly?"Summary table (read-only)":"Click to edit table name"},c(l.name),11,lo)),ve.value===`finals-${a}`&&!l.isReadOnly?(n(),r("div",ro,[k(e("input",{"onUpdate:modelValue":t[24]||(t[24]=i=>le.value=i),onBlur:i=>Ce("finals",a),onKeyup:[U(i=>Ce("finals",a),["enter"]),t[25]||(t[25]=U(i=>ve.value=null,["esc"]))],type:"number",min:"0",max:"100",class:"w-16 px-2 py-1 border-2 border-green-500 rounded text-sm text-gray-600 text-center focus:outline-none",autofocus:""},null,40,no),[[S,le.value,void 0,{number:!0}]]),t[84]||(t[84]=e("span",{class:"text-sm text-gray-600"},"%",-1))])):l.isSummary?v("",!0):(n(),r("span",{key:4,onClick:i=>!l.isReadOnly&&ct("finals",a),class:T(["text-sm text-gray-600 bg-white px-3 py-1 rounded-full",l.isReadOnly?"cursor-default":"cursor-pointer hover:bg-green-100 hover:text-green-700"]),title:l.isReadOnly?"Summary table (read-only)":"Click to edit percentage"},c(l.percentage)+"% ",11,ao)),l.isSummary?v("",!0):(n(),r("span",io," (Columns: "+c(ye("finals",a))+"% / "+c(l.percentage)+"%) ",1))]),e("div",uo,[l.isReadOnly?v("",!0):(n(),r("button",{key:0,onClick:i=>gt("finals",a),disabled:!rt("finals",a),class:"px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-gray-300"}," + Column ",8,co)),l.isReadOnly?v("",!0):(n(),r("button",{key:1,onClick:i=>dt("finals",a),class:"px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700"}," Delete ",8,mo))])]),l.columns&&l.columns.length>0?(n(),r("div",go,[e("table",po,[e("thead",bo,[e("tr",null,[t[87]||(t[87]=e("th",{class:"px-4 py-2 text-left text-sm font-semibold text-gray-700 border-b"},"Student",-1)),(n(!0),r(C,null,A(l.columns,(i,m)=>(n(),r("th",{key:i.id,colspan:i.subcolumns.length||1,class:"px-4 py-2 text-center text-sm font-semibold text-gray-700 border-b border-l"},[e("div",fo,[_e.value===`finals-${a}-${m}`&&!l.isReadOnly?(n(),r("div",xo,[k(e("input",{"onUpdate:modelValue":t[26]||(t[26]=g=>fe.value=g),onBlur:g=>X("finals",a,m),onKeyup:[U(g=>X("finals",a,m),["enter"]),t[27]||(t[27]=U(g=>_e.value=null,["esc"]))],class:"px-2 py-1 border-2 border-green-500 rounded text-sm focus:outline-none",autofocus:""},null,40,yo),[[S,fe.value]])])):(n(),r("span",{key:1,onClick:g=>!l.isReadOnly&&je("finals",a,m),class:T([l.isReadOnly?"cursor-default":"cursor-pointer hover:text-green-600 hover:underline"]),title:l.isReadOnly?"Read-only column":"Click to edit column name"},c(i.name),11,ho)),$e.value===`finals-${a}-${m}`&&!l.isReadOnly?(n(),r("div",wo,[t[85]||(t[85]=e("span",null,"(",-1)),k(e("input",{"onUpdate:modelValue":t[28]||(t[28]=g=>ae.value=g),onBlur:g=>ce("finals",a,m),onKeyup:[U(g=>ce("finals",a,m),["enter"]),t[29]||(t[29]=U(g=>$e.value=null,["esc"]))],type:"number",min:"0",class:"w-12 px-1 py-1 border-2 border-green-500 rounded text-sm text-center focus:outline-none",autofocus:""},null,40,ko),[[S,ae.value,void 0,{number:!0}]]),t[86]||(t[86]=e("span",null,"%)",-1))])):l.isSummary?v("",!0):(n(),r("span",{key:3,onClick:g=>!l.isReadOnly&&Se("finals",a,m),class:T([l.isReadOnly?"cursor-default":"cursor-pointer hover:text-green-600 hover:underline"]),title:l.isReadOnly?"Read-only column":"Click to edit percentage"}," ("+c(i.percentage)+"%) ",11,_o)),l.isReadOnly?v("",!0):(n(),r("button",{key:4,onClick:g=>et("finals",a,m),class:"text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600",title:"Add Subcolumn"}," + Sub ",8,$o)),l.isReadOnly?v("",!0):(n(),r("button",{key:5,onClick:g=>Ie("finals",a,m),class:"text-red-600 hover:text-red-800"}," ðŸ—‘ï¸ ",8,Co))])],8,vo))),128))]),l.columns.some(i=>i.subcolumns&&i.subcolumns.length>0)?(n(),r("tr",jo,[t[90]||(t[90]=e("th",{class:"px-4 py-2 border-b"},null,-1)),(n(!0),r(C,null,A(l.columns,(i,m)=>(n(),r(C,{key:i.id+"-sub"},[(n(!0),r(C,null,A(i.subcolumns,(g,f)=>(n(),r("th",{key:g.id,class:"px-2 py-2 text-center text-xs text-gray-600 border-b border-l"},[e("div",So,[Me.value===`finals-${a}-${m}-${f}`?(n(),r("div",Mo,[k(e("input",{"onUpdate:modelValue":t[30]||(t[30]=o=>ue.value=o),onBlur:o=>Be("finals",a,m,f),onKeyup:[U(o=>Be("finals",a,m,f),["enter"]),t[31]||(t[31]=U(o=>Me.value=null,["esc"]))],class:"px-2 py-1 border-2 border-green-500 rounded text-xs focus:outline-none w-24",autofocus:""},null,40,Ao),[[S,ue.value]])])):(n(),r("div",{key:1,onClick:o=>se("finals",a,m,f),class:T(["cursor-pointer hover:text-green-600 hover:underline",{"cursor-not-allowed opacity-50":g.isAutoPopulated}]),title:g.isAutoPopulated?"Auto-populated from classwork":"Click to edit name"},c(g.name),11,Po)),Ae.value===`finals-${a}-${m}-${f}`?(n(),r("div",Go,[t[88]||(t[88]=e("span",{class:"text-gray-500"},"(",-1)),k(e("input",{"onUpdate:modelValue":t[32]||(t[32]=o=>xe.value=o),onBlur:o=>We("finals",a,m,f),onKeyup:[U(o=>We("finals",a,m,f),["enter"]),t[33]||(t[33]=U(o=>Ae.value=null,["esc"]))],type:"number",min:"1",class:"w-12 px-1 py-1 border-2 border-green-500 rounded text-xs text-center focus:outline-none",autofocus:""},null,40,To),[[S,xe.value,void 0,{number:!0}]]),t[89]||(t[89]=e("span",{class:"text-gray-500"},"pts)",-1))])):(n(),r("div",{key:3,onClick:o=>mt("finals",a,m,f),class:T(["text-gray-500 cursor-pointer hover:text-green-600",{"cursor-not-allowed opacity-50":g.isAutoPopulated}]),title:g.isAutoPopulated?"Auto-populated from classwork":"Click to edit max points"}," ("+c(g.maxPoints)+" pts) ",11,Eo)),g.isAutoPopulated?(n(),r("div",Oo," ðŸ“ Auto ")):(n(),r("div",Fo,[e("button",{onClick:o=>y("finals",a,m,f),class:"text-red-600 hover:text-red-800 text-xs",title:"Delete Subcolumn"}," ðŸ—‘ï¸ ",8,Vo)]))])]))),128)),!i.subcolumns||i.subcolumns.length===0?(n(),r("th",zo)):v("",!0)],64))),128))])):v("",!0)]),e("tbody",null,[(n(!0),r(C,null,A(_.students,i=>(n(),r("tr",{key:i.id,class:"hover:bg-gray-50"},[e("td",Ro,c(i.name),1),(n(!0),r(C,null,A(l.columns,m=>(n(),r(C,{key:m.id},[(n(!0),r(C,null,A(m.subcolumns,g=>{var f,o,b,x;return n(),r("td",{key:g.id,class:"px-2 py-2 border-b border-l"},[l.isSummary?(n(),r("div",Bo,c(nt(i.id,"finals",m.id)),1)):g.isAutoPopulated?(n(),r("input",{key:1,value:((o=(f=W.value[i.id])==null?void 0:f.finals)==null?void 0:o[`${a}-${m.id}-${g.id}`])??0,type:"number",disabled:"",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded text-center bg-gray-100 cursor-not-allowed",title:"Auto-populated from submission: "+(((x=(b=W.value[i.id])==null?void 0:b.finals)==null?void 0:x[`${a}-${m.id}-${g.id}`])??0)},null,8,Uo)):k((n(),r("input",{key:2,"onUpdate:modelValue":h=>L.value[i.id].finals[`${a}-${m.id}-${g.id}`]=h,onInput:()=>console.log("[Gradebook] Finals grade input changed:",i.id,L.value[i.id].finals),onBlur:j,type:"number",max:g.maxPoints,min:"0",step:"0.01",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded text-center focus:ring-2 focus:ring-green-500"},null,40,No)),[[S,L.value[i.id].finals[`${a}-${m.id}-${g.id}`]]])])}),128)),!m.subcolumns||m.subcolumns.length===0?(n(),r("td",Lo," N/A ")):v("",!0)],64))),128))]))),128))])])])):(n(),r("div",Do,' No columns added yet. Click "+ Column" to add grading columns. '))]))),128)),e("div",Ho,[t[91]||(t[91]=e("h5",{class:"font-semibold text-green-900 mb-3"},"Finals Period Grades",-1)),e("div",Qo,[(n(!0),r(C,null,A(_.students,l=>(n(),r("div",{key:l.id,class:"bg-white p-3 rounded-lg border border-green-200"},[e("p",Jo,c(l.name),1),e("p",Wo,c(he(l.id,"finals")),1)]))),128))])])])])):v("",!0),I.value&&ee.value?(n(),r("div",Yo,[e("div",qo,[e("div",Zo,[t[93]||(t[93]=e("h3",{class:"text-xl font-bold text-white flex items-center gap-2"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})]),M(" AUTO-COMPUTED FINAL GRADES ")],-1)),e("div",Xo,[Ne(pt,{title:"Auto-Computed Final Grades",content:"These grades are automatically calculated by combining Midterm and Finals grades using the percentages you set in Grade Computation Setup.",position:"left"})])]),e("p",Ko," Midterm: "+c(D.value)+"% â€¢ Finals: "+c(B.value)+"% ",1)]),e("div",Io,[e("div",el,[e("table",tl,[e("thead",null,[e("tr",sl,[t[98]||(t[98]=e("th",{class:"px-4 py-3 text-left text-sm font-bold text-gray-800 border-b-2 border-purple-300"},"Student",-1)),e("th",ol,[t[94]||(t[94]=M("Midterm Grade",-1)),t[95]||(t[95]=e("br",null,null,-1)),e("span",ll,"("+c(D.value)+"%)",1)]),e("th",rl,[t[96]||(t[96]=M("Finals Grade",-1)),t[97]||(t[97]=e("br",null,null,-1)),e("span",nl,"("+c(B.value)+"%)",1)]),t[99]||(t[99]=e("th",{class:"px-4 py-3 text-center text-sm font-bold text-white bg-gradient-to-r from-purple-600 to-indigo-600 border-b-2 border-purple-600 border-l"},[e("div",{class:"flex items-center justify-center gap-2"},[e("svg",{class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})]),M(" Total Grade ")])],-1))])]),e("tbody",null,[(n(!0),r(C,null,A(_.students,l=>(n(),r("tr",{key:l.id,class:"hover:bg-purple-50 transition-colors"},[e("td",al,c(l.name),1),e("td",il,[e("div",dl,c(he(l.id,"midterm")),1)]),e("td",ul,[e("div",cl,c(he(l.id,"finals")),1)]),e("td",ml,[e("div",gl,c(bt(l.id)),1)])]))),128))])])])])])):v("",!0),Q.value?(n(),r("div",pl,[e("div",bl,[t[102]||(t[102]=e("h3",{class:"text-xl font-bold mb-4"},"Add New Table",-1)),e("div",vl,[e("div",null,[t[100]||(t[100]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Table Name",-1)),k(e("input",{"onUpdate:modelValue":t[34]||(t[34]=l=>$.value.name=l),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Quizzes"},null,512),[[S,$.value.name]])]),e("div",null,[t[101]||(t[101]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Percentage (%)",-1)),k(e("input",{"onUpdate:modelValue":t[35]||(t[35]=l=>$.value.percentage=l),type:"number",min:"0",max:Oe(z.value),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,fl),[[S,$.value.percentage,void 0,{number:!0}]]),e("p",xl,"Remaining: "+c(Oe(z.value))+"%",1)])]),e("div",yl,[e("button",{onClick:it,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Add Table "),e("button",{onClick:t[36]||(t[36]=l=>Q.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Cancel ")])])])):v("",!0),K.value?(n(),r("div",hl,[e("div",wl,[t[105]||(t[105]=e("h3",{class:"text-xl font-bold mb-4"},"Edit Table",-1)),e("div",kl,[e("div",null,[t[103]||(t[103]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Table Name",-1)),k(e("input",{"onUpdate:modelValue":t[37]||(t[37]=l=>$.value.name=l),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,$.value.name]])]),e("div",null,[t[104]||(t[104]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Percentage (%)",-1)),k(e("input",{"onUpdate:modelValue":t[38]||(t[38]=l=>$.value.percentage=l),type:"number",min:"0",max:"100",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,$.value.percentage,void 0,{number:!0}]])])]),e("div",_l,[e("button",{onClick:vt,class:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"}," Update "),e("button",{onClick:t[39]||(t[39]=l=>K.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Cancel ")])])])):v("",!0),Fe.value?(n(),r("div",$l,[e("div",Cl,[t[108]||(t[108]=e("h3",{class:"text-xl font-bold mb-4"},"Add New Column",-1)),e("div",jl,[e("div",null,[t[106]||(t[106]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Column Name",-1)),k(e("input",{"onUpdate:modelValue":t[40]||(t[40]=l=>P.value.name=l),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Quiz 1"},null,512),[[S,P.value.name]])]),e("div",null,[t[107]||(t[107]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Percentage (%)",-1)),k(e("input",{"onUpdate:modelValue":t[41]||(t[41]=l=>P.value.percentage=l),type:"number",min:"0",max:Xe(z.value,J.value),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,8,Sl),[[S,P.value.percentage,void 0,{number:!0}]]),e("p",Ml,"Remaining: "+c(Xe(z.value,J.value))+"%",1)])]),e("div",Al,[e("button",{onClick:ft,class:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"}," Add Column "),e("button",{onClick:t[42]||(t[42]=l=>Fe.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Cancel ")])])])):v("",!0),Ve.value?(n(),r("div",Pl,[e("div",Gl,[t[111]||(t[111]=e("h3",{class:"text-xl font-bold mb-4"},"Edit Column",-1)),e("div",Tl,[e("div",null,[t[109]||(t[109]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Column Name",-1)),k(e("input",{"onUpdate:modelValue":t[43]||(t[43]=l=>P.value.name=l),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,P.value.name]])]),e("div",null,[t[110]||(t[110]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Percentage (%)",-1)),k(e("input",{"onUpdate:modelValue":t[44]||(t[44]=l=>P.value.percentage=l),type:"number",min:"0",max:"100",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,P.value.percentage,void 0,{number:!0}]])])]),e("div",El,[e("button",{onClick:xt,class:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"}," Update "),e("button",{onClick:t[45]||(t[45]=l=>Ve.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Cancel ")])])])):v("",!0),p.value?(n(),r("div",Fl,[e("div",Vl,[t[115]||(t[115]=e("h3",{class:"text-xl font-bold mb-4"},"Add New Subcolumn",-1)),e("div",Ol,[e("div",null,[t[112]||(t[112]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Subcolumn Name",-1)),k(e("input",{"onUpdate:modelValue":t[46]||(t[46]=l=>N.value.name=l),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Quiz 1, Assignment 1"},null,512),[[S,N.value.name]])]),e("div",null,[t[113]||(t[113]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Max Points",-1)),k(e("input",{"onUpdate:modelValue":t[47]||(t[47]=l=>N.value.maxPoints=l),type:"number",min:"1",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,N.value.maxPoints,void 0,{number:!0}]]),t[114]||(t[114]=e("p",{class:"text-xs text-gray-500 mt-1"},"Maximum points students can earn",-1))])]),e("div",zl,[e("button",{onClick:d,class:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Add Subcolumn "),e("button",{onClick:t[48]||(t[48]=l=>p.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Cancel ")])])])):v("",!0),Y.value?(n(),r("div",Rl,[e("div",Bl,[t[119]||(t[119]=e("h3",{class:"text-xl font-bold mb-4"},"Edit Subcolumn",-1)),e("div",Ul,[e("div",null,[t[116]||(t[116]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Subcolumn Name",-1)),k(e("input",{"onUpdate:modelValue":t[49]||(t[49]=l=>N.value.name=l),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,N.value.name]])]),e("div",null,[t[117]||(t[117]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Max Points",-1)),k(e("input",{"onUpdate:modelValue":t[50]||(t[50]=l=>N.value.maxPoints=l),type:"number",min:"1",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"},null,512),[[S,N.value.maxPoints,void 0,{number:!0}]]),t[118]||(t[118]=e("p",{class:"text-xs text-gray-500 mt-1"},"Maximum points students can earn",-1))])]),e("div",Nl,[e("button",{onClick:s,class:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700"}," Update "),e("button",{onClick:t[51]||(t[51]=l=>Y.value=!1),class:"flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400"}," Cancel ")])])])):v("",!0),Ee.value?(n(),r("div",Ll,[...t[120]||(t[120]=[e("svg",{class:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),M(" Saving... ",-1)])])):v("",!0)]))}},Hl={class:"space-y-6"},Ql={class:"bg-gradient-to-r from-blue-600 to-blue-800 rounded-lg shadow-lg p-6 md:p-8 text-white"},Jl={class:"flex justify-between items-start"},Wl={class:"text-2xl md:text-3xl font-bold"},Yl={class:"mt-2 flex flex-wrap items-center gap-4 text-sm text-blue-100"},ql={class:"bg-white rounded-lg shadow-md"},Zl={class:"border-b border-gray-200"},Xl={class:"flex -mb-px overflow-x-auto"},Kl=["onClick"],Il={class:"p-6"},er={key:0},tr={class:"bg-white rounded-lg shadow-lg overflow-hidden"},sr={class:"bg-gray-50 px-6 py-3 border-b border-gray-200"},or={class:"flex items-center gap-3"},lr={class:"ml-auto text-sm text-gray-600"},rr={class:"font-semibold"},nr={class:"p-6"},ar={key:0,class:"text-center py-12 text-gray-500"},ir={key:1,class:"space-y-4"},dr={class:"flex items-start justify-between"},ur={class:"flex-1"},cr={class:"flex items-center gap-2"},mr={class:"font-semibold text-gray-900"},gr={key:0,class:"px-2 py-0.5 text-xs font-medium rounded bg-purple-100 text-purple-800"},pr={key:0,class:"text-sm text-gray-600 mt-2"},br={class:"flex items-center gap-4 mt-3 text-xs text-gray-500"},vr={class:"flex items-center gap-1"},fr={class:"flex items-center gap-1"},xr={key:0,class:"flex items-center gap-1"},yr={class:"flex items-start justify-between"},hr={class:"flex-1"},wr={class:"flex items-center gap-2"},kr={class:"font-semibold text-gray-900"},_r={key:0,class:"text-sm text-gray-600 mt-1"},$r={key:1,class:"text-sm text-gray-600 mt-1"},Cr={key:2,class:"text-sm text-gray-600 mt-1"},jr={class:"flex gap-3 mt-3"},Sr={class:"px-3 py-1 bg-blue-500 text-white text-xs rounded-lg"},Mr={class:"px-3 py-1 bg-green-500 text-white text-xs rounded-lg"},Ar={class:"flex gap-2"},Pr=["onClick"],Gr=["onClick"],Tr=["onClick"],Er={key:0,class:"mb-8"},Fr={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6"},Vr={class:"flex items-center gap-3 mb-4"},Or={class:"text-lg font-bold text-yellow-900"},zr={class:"ml-2 px-2 py-1 bg-yellow-600 text-white text-sm rounded-full"},Rr={class:"space-y-3"},Br={class:"flex items-center gap-3"},Ur={class:"w-10 h-10 bg-yellow-600 rounded-full flex items-center justify-center text-white font-bold"},Nr={class:"font-semibold text-gray-900"},Lr={class:"text-sm text-gray-600"},Dr={class:"text-xs text-gray-500"},Hr={class:"flex gap-2"},Qr=["onClick"],Jr=["onClick"],Wr={key:1},Yr={class:"mb-8"},qr={class:"flex items-center justify-between mb-4"},Zr={class:"text-xl font-bold text-gray-900"},Xr={class:"ml-2 px-2 py-1 bg-gray-200 text-gray-700 text-sm rounded-full"},Kr={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Ir={class:"flex items-center gap-3"},en={class:"w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold overflow-hidden flex-shrink-0 relative"},tn=["src","alt"],sn={key:1,class:"z-10"},on={class:"font-semibold text-gray-900"},ln={class:"text-sm text-gray-600"},rn={key:0,class:"inline-block mt-1 px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded"},nn={class:"flex items-center justify-between mb-4"},an={class:"text-xl font-bold text-gray-900"},dn={class:"ml-2 px-2 py-1 bg-gray-200 text-gray-700 text-sm rounded-full"},un={key:0,class:"text-center py-12 text-gray-500"},cn={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},mn={class:"flex items-start justify-between mb-3"},gn={class:"flex items-center gap-3"},pn={class:"w-12 h-12 bg-green-600 rounded-full flex items-center justify-center text-white font-bold text-lg overflow-hidden flex-shrink-0 relative"},bn=["src","alt"],vn={key:1,class:"z-10"},fn={class:"font-semibold text-gray-900"},xn={class:"text-xs text-gray-600"},yn={class:"text-xs text-gray-500 mt-1"},hn={class:"space-y-2 mb-3"},wn={class:"flex items-center justify-between text-xs"},kn={class:"font-semibold text-gray-900"},_n={class:"w-full bg-gray-200 rounded-full h-2 overflow-hidden"},$n={class:"grid grid-cols-2 gap-2 text-xs"},Cn={class:"bg-blue-50 rounded px-2 py-1 text-center"},jn={class:"font-bold text-blue-700 text-base"},Sn={class:"text-gray-400 text-xs"},Mn={class:"bg-green-50 rounded px-2 py-1 text-center"},An={class:"font-bold text-green-700 text-base"},Pn={class:"text-gray-400 text-xs"},Gn={class:"bg-yellow-50 rounded px-2 py-1 text-center"},Tn={class:"font-bold text-yellow-700 text-base"},En={class:"bg-red-50 rounded px-2 py-1 text-center"},Fn={class:"font-bold text-red-700 text-base"},Vn=["onClick"],On={class:"flex items-center justify-between px-3 py-2 bg-gray-50 rounded-lg border border-gray-200"},zn=["onClick"],Rn={key:2},Bn={key:3,class:"space-y-6"},Un={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4"},Nn={class:"text-gray-600 mt-1"},Ln={class:"flex flex-col md:flex-row md:items-center gap-2"},Dn={class:"flex items-center gap-2"},Hn={class:"flex items-center gap-3"},Qn=["aria-checked","title"],Jn={class:"bg-white rounded-lg shadow-md overflow-hidden"},Wn={class:"overflow-x-auto"},Yn={class:"w-full border-collapse"},qn={class:"px-6 py-4 text-left font-medium text-gray-900 border border-gray-300"},Zn={class:"px-6 py-4 text-center text-gray-700 border border-gray-300"},Xn={key:0},Kn={class:"bg-white rounded-lg shadow-md p-6"},In={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ea={class:"flex items-center gap-2"},ta={class:"text-sm"},sa={class:"flex items-center gap-2"},oa={class:"text-sm"},la={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},ra={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},na={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full max-h-[90vh] overflow-y-auto"},aa={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ia={class:"sm:flex sm:items-start"},da={class:"w-full mt-3 text-center sm:mt-0 sm:text-left"},ua={class:"space-y-4"},ca={class:"grid grid-cols-4 gap-2"},ma=["onClick"],ga={class:"text-2xl"},pa={key:0,class:"border-2 border-red-200 rounded-lg p-4 bg-red-50"},ba={class:"flex items-center justify-between mb-4"},va={class:"text-sm font-medium text-red-600"},fa={class:"space-y-4 max-h-64 overflow-y-auto pr-2"},xa={class:"flex items-start justify-between"},ya={class:"text-sm font-medium text-gray-700"},ha=["onClick"],wa=["onUpdate:modelValue"],ka=["value"],_a=["onUpdate:modelValue"],$a={key:0,class:"space-y-2"},Ca={class:"w-8 h-8 flex items-center justify-center bg-red-100 text-red-700 font-semibold rounded-full text-sm flex-shrink-0"},ja=["onUpdate:modelValue","placeholder"],Sa=["onClick"],Ma=["onClick"],Aa={class:"pt-2"},Pa=["onUpdate:modelValue"],Ga=["value"],Ta={key:1},Ea=["onUpdate:modelValue"],Fa={key:2},Va=["onUpdate:modelValue"],Oa={key:3,class:"space-y-2"},za=["onUpdate:modelValue","placeholder"],Ra=["onClick"],Ba=["onClick"],Ua={class:"flex items-center gap-2"},Na=["onUpdate:modelValue"],La={class:"mt-4 p-3 bg-white border border-green-300 rounded-lg"},Da={class:"flex items-center gap-3 cursor-pointer"},Ha={key:1,class:"border-2 border-indigo-200 rounded-lg p-4 bg-indigo-50"},Qa={class:"flex items-center justify-between mb-4"},Ja={class:"text-sm font-medium text-indigo-600"},Wa={class:"space-y-3 max-h-64 overflow-y-auto pr-2"},Ya={class:"flex-1 space-y-2"},qa=["onUpdate:modelValue"],Za={class:"flex items-center gap-2"},Xa=["onUpdate:modelValue"],Ka=["onClick","disabled"],Ia={key:2},ei={key:3,class:"border-2 border-blue-200 rounded-lg p-4 bg-blue-50 space-y-3"},ti={class:"grid grid-cols-2 gap-3"},si=["value"],oi=["disabled"],li=["value"],ri=["disabled"],ni=["value"],ai=["disabled"],ii={key:4},di={class:"space-y-2"},ui={key:0,class:"space-y-1"},ci={class:"text-gray-700 flex items-center gap-2"},mi={key:0,class:"text-xs text-green-600"},gi=["onClick"],pi={key:5,class:"flex items-center"},bi={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse gap-2"},vi=["disabled"],fi=["disabled"],xi={key:1,class:"fixed z-50 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},yi={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},hi={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},wi={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ki={class:"sm:flex sm:items-start"},_i={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},$i={class:"mt-2"},Ci={class:"text-sm text-gray-500"},ji={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse gap-2"},Si={key:2,class:"fixed z-50 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},Mi={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Ai={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full"},Pi={class:"bg-white px-4 pt-5 pb-4 sm:p-6"},Gi={class:"flex items-start justify-between mb-6"},Ti={class:"flex items-center gap-3"},Ei={class:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center text-white font-bold text-2xl overflow-hidden flex-shrink-0 relative"},Fi=["src","alt"],Vi={key:1,class:"z-10"},Oi={class:"text-2xl font-bold text-gray-900"},zi={class:"text-sm text-gray-600"},Ri={class:"text-xs text-gray-500 mt-1"},Bi={class:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6"},Ui={class:"bg-blue-50 rounded-lg p-4"},Ni={class:"text-3xl font-bold text-blue-600"},Li={class:"text-xs text-gray-500 mt-1"},Di={class:"bg-green-50 rounded-lg p-4"},Hi={class:"text-3xl font-bold text-green-600"},Qi={class:"bg-yellow-50 rounded-lg p-4"},Ji={class:"text-3xl font-bold text-yellow-600"},Wi={class:"bg-purple-50 rounded-lg p-4"},Yi={class:"text-3xl font-bold text-purple-600"},qi={key:0,class:"bg-gray-50 rounded-lg p-6 mb-6"},Zi={class:"space-y-3"},Xi={class:"flex items-center justify-between mb-2"},Ki={class:"flex-1"},Ii={class:"text-sm font-medium text-gray-900"},ed={class:"text-xs text-gray-500"},td={class:"text-right"},sd={class:"text-lg font-bold text-gray-900"},od={class:"w-full bg-gray-200 rounded-full h-2 overflow-hidden"},ld={key:1,class:"bg-gray-50 rounded-lg p-12 text-center mb-6"},rd={class:"bg-gray-50 rounded-lg p-6"},nd={class:"space-y-3"},ad={class:"flex items-center justify-between"},id={class:"font-semibold text-gray-900"},dd={class:"flex items-center justify-between"},ud={class:"font-semibold text-blue-600"},cd={class:"flex items-center justify-between"},md={class:"font-semibold text-green-600"},gd={class:"flex items-center justify-between"},pd={class:"font-semibold text-yellow-600"},bd={class:"flex items-center justify-between pt-3 border-t border-gray-200"},vd={class:"font-bold text-red-600"},fd={class:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-hidden"},xd={class:"flex justify-between items-center p-4 border-b"},yd={class:"text-lg font-semibold"},hd={class:"p-6 overflow-auto max-h-[calc(90vh-120px)]"},wd={key:0,class:"flex flex-col items-center justify-center py-12"},kd={key:1,class:"py-8"},_d={class:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center"},$d={class:"text-6xl mb-4"},Cd={class:"text-sm text-yellow-700 mb-1"},jd={key:2,class:"flex justify-center bg-gray-50 p-4 rounded"},Sd=["src","alt"],Md={key:3,class:"w-full h-[70vh]"},Ad=["src"],Pd={key:4,class:"w-full h-[70vh]"},Gd=["src"],Td={class:"text-xs text-gray-500 mt-2 text-center"},Ed=["href","download"],Fd={key:5,class:"bg-gray-50 p-4 rounded"},Vd=["src"],Od={key:6,class:"text-center py-8"},zd={class:"text-6xl mb-4"},Rd={class:"text-gray-600 mb-2"},Bd=["href","download"],Hd={__name:"CourseView",props:{course:Object,classwork:Array,students:Array,classworks:Array,announcements:Array},setup(R){var Ie,et;const E=R;console.log("CourseView - Students prop:",E.students),console.log("CourseView - Students count:",(Ie=E.students)==null?void 0:Ie.length),console.log("CourseView - Course students:",E.course.students),console.log("CourseView - First course student:",(et=E.course.students)==null?void 0:et[0]),console.log("CourseView - Course program:",E.course.program),console.log("CourseView - Course object:",E.course);const _=w(E.course.gradebook||{midtermPercentage:50,finalsPercentage:50,midterm:{tables:[],grades:{},periodGrades:{}},finals:{tables:[],grades:{},periodGrades:{}}}),ke=w(sessionStorage.getItem(`courseTab_${E.course.id}`)||"classwork"),D=w(!1),B=w(null),I=w(!1),ee=w(null),Ee=w(!1),F=w(null),Le=w(!1),Q=w(null),K=w(null),Fe=w(!1),Ve=w(null),p=At({type:"lesson",title:"",description:"",due_date:"",points:null,has_submission:!1,status:"active",rubric_criteria:[],quiz_questions:[],attachments:[],show_correct_answers:!1,grading_period:"",grade_table_name:"",grade_main_column:"",grade_sub_column:""}),Y=w([]),$=w([]),P=w([]),N=w([]),z=w("all"),J=[{id:"classwork",name:"Classroom"},{id:"people",name:"People"},{id:"gradebook",name:"Gradebook"},{id:"class-record",name:"Class Record"}];ge(ke,(d,s)=>{sessionStorage.setItem(`courseTab_${E.course.id}`,d)});const pe=[{value:"lesson",label:"Lesson",color:"#3b82f6",icon:"ðŸ“š"},{value:"assignment",label:"Assignment",color:"#eab308",icon:"ðŸ“"},{value:"quiz",label:"Quiz",color:"#ef4444",icon:"ðŸ“‹"},{value:"activity",label:"Activity",color:"#10b981",icon:"ðŸŽ¯"},{value:"essay",label:"Essay",color:"#8b5cf6",icon:"âœï¸"},{value:"project",label:"Project",color:"#f97316",icon:"ðŸš€"}],st=[{value:"multiple_choice",label:"Multiple Choice"},{value:"identification",label:"Identification"},{value:"enumeration",label:"Enumeration"},{value:"true_false",label:"True/False"},{value:"short_answer",label:"Short Answer"},{value:"essay",label:"Essay"}],be=oe(()=>{var d;return((d=E.course.students)==null?void 0:d.filter(s=>s.grade_access_requested&&!s.grade_access_granted))||[]});oe(()=>{var d;return((d=E.classwork)==null?void 0:d.filter(s=>s.is_todo))||[]}),oe(()=>{var d;return((d=E.classwork)==null?void 0:d.slice(0,5))||[]});const ve=oe(()=>E.classwork?z.value==="all"?E.classwork:E.classwork.filter(d=>{const s=d.type.toLowerCase(),y=z.value.toLowerCase();return y==="materials"?s==="lesson":y==="tasks"?s==="assignment":y==="quizzes"?s==="quiz":y==="activities"?s==="activity":y==="essays"?s==="essay":y==="projects"?s==="project":!0}):[]),ne=oe(()=>E.announcements?z.value==="all"||z.value==="materials"?E.announcements:[]:[]),le=oe(()=>p.type==="quiz"),_e=oe(()=>Y.value.reduce((d,s)=>d+(parseInt(s.points)||0),0)),$e=oe(()=>$.value.reduce((d,s)=>d+(parseInt(s.points)||0),0)),fe=oe(()=>[{value:"midterm",label:"Midterm"},{value:"finals",label:"Finals"}]),ae=oe(()=>{var te;if(!p.grading_period)return[];const d=p.grading_period==="midterm"?"Midterm Examination":"Final Examination",s=[{value:"Asynchronous",label:"Asynchronous"},{value:"Synchronous",label:"Synchronous"},{value:d,label:d}],y=_.value||((te=E.course)==null?void 0:te.gradebook);if(!y)return s;const V=y[p.grading_period];if(!V||!V.tables)return s;const j=V.tables.filter(we=>!we.isSummary&&!["Asynchronous","Synchronous",d].includes(we.name)).map(we=>({value:we.name,label:we.name}));return[...s,...j]}),Me=oe(()=>{var V;if(!p.grading_period||!p.grade_table_name)return[];const d=_.value||((V=E.course)==null?void 0:V.gradebook);if(!d)return console.log("No gradebook data available"),[];const s=d[p.grading_period];if(!s||!s.tables)return console.log("No period data or tables"),[];const y=s.tables.find(j=>j.name===p.grade_table_name);return y?!y.columns||y.columns.length===0?(console.log("No columns in table:",p.grade_table_name),[]):(console.log("Found columns for table:",p.grade_table_name,y.columns),y.columns.map(j=>({value:j.name,label:j.name}))):(console.log("Table not found:",p.grade_table_name),console.log("Available tables:",s.tables.map(j=>j.name)),[])});ge(()=>p.type,d=>{d==="quiz"?(Y.value=[],P.value=[],$.value.length===0&&Pe()):d==="lesson"?($.value=[],Y.value=[],p.due_date=null,p.grading_period="",p.grade_table_name="",p.grade_main_column="",p.grade_sub_column=""):($.value=[],Y.value.length===0&&De())}),ge(()=>p.title,d=>{d&&p.type!=="lesson"&&p.grade_main_column&&(p.grade_sub_column=d.substring(0,30))}),ge(()=>$.value.map(d=>d.type),(d,s)=>{$.value.forEach((y,V)=>{y.type==="enumeration"&&(!y.correct_answers||y.correct_answers.length===0)&&(y.correct_answers=[""]),y.type==="multiple_choice"&&(!y.options||y.options.length===0)&&(y.options=["","","",""])})},{deep:!0});const Ae=()=>{B.value=null,p.reset(),Y.value=[],$.value=[],P.value=[],N.value=[],De(),D.value=!0},ue=d=>{me.post(route("teacher.courses.grant-grade-access",{course:E.course.id,student:d}),{},{preserveScroll:!0,onSuccess:()=>{me.reload({only:["students"]})}})},xe=d=>{confirm("Are you sure you want to hide grades from this student?")&&me.post(route("teacher.courses.revoke-grade-access",{course:E.course.id,student:d}),{},{preserveScroll:!0,onSuccess:()=>{me.reload({only:["students"]})}})},ot=d=>{confirm("Are you sure you want to deny this grade access request?")&&me.post(route("teacher.courses.revoke-grade-access",{course:E.course.id,student:d}),{},{preserveScroll:!0,onSuccess:()=>{me.reload({only:["students"]})}})},q=d=>{var s,y;B.value=d,p.type=d.type,p.title=d.title,p.description=d.description||"",p.due_date=d.due_date||"",p.points=d.points,p.has_submission=d.has_submission,p.status=d.status,p.show_correct_answers=d.show_correct_answers||!1,p.grading_period=d.grading_period||"",p.grade_table_name=d.grade_table_name||"",p.grade_main_column=d.grade_main_column||"",p.grade_sub_column=d.grade_sub_column||"",d.type==="quiz"?($.value=((s=d.quiz_questions)==null?void 0:s.map(V=>({...V})))||[],Y.value=[]):(Y.value=((y=d.rubric_criteria)==null?void 0:y.map(V=>({...V})))||[],$.value=[]),N.value=d.attachments||[],P.value=[],D.value=!0},Z=d=>{ee.value=d,I.value=!0},L=()=>{ee.value&&me.delete(route("teacher.courses.classwork.destroy",{course:E.course.id,classwork:ee.value.id}),{preserveScroll:!0,onSuccess:()=>{I.value=!1,ee.value=null,me.reload({only:["classworks"]})}})},W=d=>{me.visit(route("teacher.courses.classwork.show",{course:E.course.id,classwork:d.id}))},re=()=>{D.value=!1,B.value=null,p.reset(),Y.value=[],$.value=[],P.value=[],N.value=[]},De=()=>{Y.value.push({description:"",points:0})},O=d=>{Y.value.splice(d,1)},Pe=()=>{$.value.push({type:"multiple_choice",question:"",options:["","","",""],option_labels:["A","B","C","D"],correct_answer:"",correct_answers:[],points:1})},Oe=d=>{$.value.splice(d,1)},lt=d=>{const s=$.value[d];s.option_labels||(s.option_labels=[]);const y=String.fromCharCode(65+s.options.length);s.options.push(""),s.option_labels.push(y)},He=(d,s)=>{const y=$.value[d];y.options.splice(s,1),y.option_labels&&y.option_labels.splice(s,1)},ye=d=>{$.value[d].correct_answers||($.value[d].correct_answers=[]),$.value[d].correct_answers.push("")},rt=(d,s)=>{$.value[d].correct_answers.splice(s,1)},Xe=d=>{const s=Array.from(d.target.files),y=10*1024*1024,V=[],j=[];s.forEach(te=>{te.size<=y?V.push(te):j.push(te.name)}),V.length>0&&P.value.push(...V),j.length>0&&alert(`The following files exceed the 10MB limit and were not added:
${j.join(`
`)}`),d.target.value=""},nt=d=>{P.value.splice(d,1)},at=()=>{if(p.type==="lesson"?(p.has_submission=!1,p.rubric_criteria=[],p.quiz_questions=[],p.points=0):p.type==="quiz"?(p.quiz_questions=$.value,p.rubric_criteria=[],p.points=$e.value,P.value=[]):(p.rubric_criteria=Y.value,p.quiz_questions=[],p.points=_e.value),console.log("Submitting classwork:",{type:p.type,title:p.title,due_date:p.due_date,has_submission:p.has_submission,new_attachments_count:P.value.length,existing_attachments_count:N.value.length,rubric_criteria_count:p.rubric_criteria.length,quiz_questions_count:p.quiz_questions.length}),B.value){const d={...p.data(),_method:"PUT"};P.value.length>0?d.attachments=P.value:delete d.attachments,p.transform(()=>d).post(route("teacher.courses.classwork.update",{course:E.course.id,classwork:B.value.id}),{preserveScroll:!0,forceFormData:P.value.length>0,onSuccess:()=>{re(),alert("Classwork updated successfully!"),me.reload({only:["classworks"]})},onError:s=>{console.error("Failed to update classwork:",s);let y=`Failed to update classwork:
`;typeof s=="object"?Object.keys(s).forEach(V=>{y+=`${V}: ${s[V]}
`}):y+=s,alert(y)}})}else p.attachments=P.value,p.post(route("teacher.courses.classwork.store",E.course.id),{preserveScroll:!0,forceFormData:!0,onSuccess:()=>{const d=p.type.charAt(0).toUpperCase()+p.type.slice(1);re(),alert(`${d} created successfully!`),me.reload({only:["classworks"]})},onError:d=>{console.error("Failed to create classwork:",d),console.error("Full error object:",JSON.stringify(d,null,2));let s=`Failed to create classwork:

`;typeof d=="object"?Object.keys(d).forEach(y=>{Array.isArray(d[y])?s+=`${y}: ${d[y].join(", ")}
`:s+=`${y}: ${d[y]}
`}):s+=d,alert(s)}})},he=d=>{const s=pe.find(y=>y.value===d);return(s==null?void 0:s.color)||"#3b82f6"},bt=d=>{F.value=d,Ee.value=!0},Qe=()=>{Ee.value=!1,F.value=null},ze=()=>{Le.value=!1,K.value&&(URL.revokeObjectURL(K.value),K.value=null),Q.value=null,Ve.value=null},Ge=d=>{const s=ie(d);return Ke(d)?"ðŸ–¼ï¸":Re(d)?"ðŸ“„":it(d)?"ðŸ“":["doc","docx"].includes(s)?"ðŸ“˜":["xls","xlsx"].includes(s)?"ðŸ“—":["ppt","pptx"].includes(s)?"ðŸ“™":["zip","rar","7z"].includes(s)?"ðŸ“¦":"ðŸ“Ž"},ie=d=>d.split(".").pop().toLowerCase(),Ke=d=>["jpg","jpeg","png","gif","bmp","webp","svg","ico","tiff","tif"].includes(ie(d)),Re=d=>ie(d)==="pdf",it=d=>["txt","md","json","xml","html","css","js","php","py","java","cpp","c","h"].includes(ie(d)),vt=d=>["doc","docx"].includes(ie(d)),dt=d=>["xls","xlsx","csv"].includes(ie(d)),ut=d=>["ppt","pptx"].includes(ie(d)),Je=d=>vt(d)||dt(d)||ut(d),ct=d=>{const s=d.startsWith("http")?d:window.location.origin+d;return`https://docs.google.com/gview?url=${encodeURIComponent(s)}&embedded=true`},Ce=w(localStorage.getItem(`courseProgramType_${E.course.id}`)||"masteral"),je=oe(()=>Ce.value==="masteral"?1.75:1.45);ge(Ce,d=>{try{localStorage.setItem(`courseProgramType_${E.course.id}`,d)}catch(s){console.warn("Could not persist programType",s)}});const X=oe({get:()=>Ce.value==="doctorate",set:d=>{Ce.value=d?"doctorate":"masteral"}}),Se=d=>(console.log("[ClassRecord] getMidtermGrade for student",d,"gradebook:",_.value),!_.value||!_.value.midterm?(console.log("[ClassRecord] No gradebook or midterm data"),0):_.value.midterm.periodGrades&&_.value.midterm.periodGrades[d]!==void 0&&_.value.midterm.periodGrades[d]!==null?(console.log("[ClassRecord] Found midterm periodGrades for student",d,":",_.value.midterm.periodGrades[d]),parseFloat(_.value.midterm.periodGrades[d])):(console.log("[ClassRecord] No periodGrades found for student",d),0)),ce=d=>(console.log("[ClassRecord] getFinalsGrade for student",d,"gradebook:",_.value),!_.value||!_.value.finals?(console.log("[ClassRecord] No gradebook or finals data"),0):_.value.finals.periodGrades&&_.value.finals.periodGrades[d]!==void 0&&_.value.finals.periodGrades[d]!==null?(console.log("[ClassRecord] Found finals periodGrades for student",d,":",_.value.finals.periodGrades[d]),parseFloat(_.value.finals.periodGrades[d])):(console.log("[ClassRecord] No periodGrades found for student",d),0)),se=d=>{if(!d||d===0||d==="-")return"-";const s=parseFloat(d);return s>=100?1:s>=99?1.15:s>=98?1.2:s>=97?1.25:s>=96?1.3:s>=95?1.35:s>=94?1.4:s>=93?1.45:s>=92?1.5:s>=91?1.55:s>=90?1.6:s>=89?1.65:s>=88?1.7:s>=87?1.75:s>=86?1.8:s>=85?1.85:s>=84?1.9:s>=83?1.95:s>=82?2:s>=81?2.05:s>=80?2.1:s>=79?2.15:s>=78?2.2:s>=77?2.25:s>=76?2.3:s>=75?2.35:s>=74?2.4:s>=73?2.45:s>=72?2.5:s>=71?2.55:s>=70?2.6:s>=69?2.65:s>=68?2.7:s>=67?2.75:s>=66?2.8:s>=65?2.85:s>=64?2.9:s>=63?2.95:s>=62?3:5},Be=d=>{const s=se(Se(d)),y=se(ce(d));if(s==="-"||y==="-")return s!=="-"?s:y!=="-"?y:"-";const V=E.course.gradebook,j=(V==null?void 0:V.midtermPercentage)||50,te=(V==null?void 0:V.finalsPercentage)||50;return s*(j/100)+y*(te/100)},mt=d=>d==="-"||d===void 0||d===null?"No Grade":parseFloat(d)<=je.value?"PASSED":"FAILED/RETAKE",We=d=>d==="-"||d===void 0||d===null?"text-gray-500":parseFloat(d)<=je.value?"text-green-600":"text-red-600",gt=()=>{window.open(route("teacher.courses.export-final-grades",E.course.id),"_blank")},ft=()=>{window.open(route("teacher.courses.export-course-performance",E.course.id),"_blank")},xt=()=>{window.open(route("teacher.courses.export-class-standings",E.course.id),"_blank")};return(d,s)=>(n(),r(C,null,[Ne(G(Pt),{title:`${R.course.title} - ${R.course.section}`},null,8,["title"]),Ne(Gt,null,{default:St(()=>{var y,V,j,te,we,tt,u,t,l,a,i,m,g,f;return[e("div",Hl,[e("div",Ql,[e("div",Jl,[e("div",null,[e("h1",Wl,"Course: "+c(R.course.title)+" - "+c(R.course.section),1),e("div",Yl,[e("span",null,"Section: "+c(R.course.section),1),s[14]||(s[14]=e("span",null,"â€¢",-1)),e("span",null,"Join Code: "+c(R.course.join_code),1),e("span",{class:T(["px-3 py-1 rounded-full text-xs font-semibold",R.course.status==="active"?"bg-green-500 text-white":"bg-gray-400 text-white"])},c(R.course.status),3)])])])]),e("div",ql,[e("div",Zl,[e("nav",Xl,[(n(),r(C,null,A(J,o=>e("button",{key:o.id,onClick:b=>ke.value=o.id,class:T(["py-4 px-6 text-sm font-medium whitespace-nowrap transition-colors",ke.value===o.id?"border-b-2 border-red-900 text-red-900":"text-gray-600 hover:text-gray-900 hover:border-gray-300"])},c(o.name),11,Kl)),64))])]),e("div",Il,[ke.value==="classwork"?(n(),r("div",er,[e("div",tr,[e("div",{class:"bg-gradient-to-r from-red-900 to-red-800 px-6 py-4"},[e("div",{class:"flex justify-between items-center"},[s[16]||(s[16]=e("div",null,[e("h2",{class:"text-2xl font-bold text-white"},"Course Materials"),e("p",{class:"text-red-100 text-sm mt-1"},"Manage assignments, quizzes, and course content")],-1)),e("button",{onClick:Ae,class:"flex items-center gap-2 px-6 py-3 bg-white text-red-900 rounded-lg hover:bg-gray-50 transition font-semibold shadow-lg transform hover:scale-105"},[...s[15]||(s[15]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Create Material ",-1)])])])]),e("div",sr,[e("div",or,[s[19]||(s[19]=e("span",{class:"text-sm font-medium text-gray-700"},"Filter by:",-1)),k(e("select",{"onUpdate:modelValue":s[0]||(s[0]=o=>z.value=o),class:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-red-900 text-sm bg-white"},[...s[17]||(s[17]=[e("option",{value:"all"},"All Materials",-1),e("option",{value:"materials"},"ðŸ“š Materials",-1),e("option",{value:"tasks"},"ðŸ“ Tasks",-1),e("option",{value:"quizzes"},"â“ Quizzes",-1),e("option",{value:"activities"},"ðŸŽ¯ Activities",-1),e("option",{value:"essays"},"ðŸ“„ Essays",-1),e("option",{value:"projects"},"ðŸš€ Projects",-1)])],512),[[Ue,z.value]]),e("div",lr,[e("span",rr,c(ve.value.length+ne.value.length),1),s[18]||(s[18]=M(" items ",-1))])])]),e("div",nr,[ve.value.length===0&&ne.value.length===0?(n(),r("div",ar,[...s[20]||(s[20]=[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),e("p",{class:"text-lg"},"No materials found",-1),e("p",{class:"text-sm mt-2"},'Try changing the filter or add materials using the "To Do" section',-1)])])):(n(),r("div",ir,[(n(!0),r(C,null,A(ne.value,o=>(n(),r("div",{key:"announcement-"+o.id,class:"bg-white rounded-lg p-4 border-l-4 shadow hover:shadow-md transition",style:Ze({borderLeftColor:o.color||"#800000"})},[e("div",dr,[e("div",ur,[e("div",cr,[s[21]||(s[21]=e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"})],-1)),e("h3",mr,c(o.title),1),s[22]||(s[22]=e("span",{class:"px-2 py-0.5 text-xs font-medium rounded uppercase bg-blue-100 text-blue-800"}," Announcement ",-1)),o.target_audience==="all_courses"?(n(),r("span",gr," All Courses ")):v("",!0)]),o.description?(n(),r("p",pr,c(o.description),1)):v("",!0),e("div",br,[e("span",vr,[s[23]||(s[23]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1)),M(" "+c(o.author),1)]),e("span",fr,[s[24]||(s[24]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),M(" "+c(o.date),1)]),o.time?(n(),r("span",xr,[s[25]||(s[25]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),M(" "+c(o.time),1)])):v("",!0)])])])],4))),128)),(n(!0),r(C,null,A(ve.value,o=>(n(),r("div",{key:o.id,class:"bg-white rounded-lg p-4 border-l-4 shadow hover:shadow-md transition",style:Ze({borderLeftColor:o.color_code||he(o.type)})},[e("div",yr,[e("div",hr,[e("div",wr,[e("h3",kr,c(o.title),1),e("span",{class:"px-2 py-0.5 text-xs font-medium rounded uppercase",style:Ze({backgroundColor:o.color_code+"20",color:o.color_code})},c(o.type),5)]),o.description?(n(),r("p",_r,c(o.description),1)):v("",!0),o.due_date_formatted?(n(),r("p",$r," Due: "+c(o.due_date_formatted),1)):v("",!0),o.points?(n(),r("div",Cr,c(o.points)+" points ",1)):v("",!0),e("div",jr,[e("span",Sr,c(o.submitted_count)+" submitted",1),e("span",Mr,c(o.graded_count)+" graded",1)])]),e("div",Ar,[e("button",{onClick:b=>W(o),class:"p-2 hover:bg-gray-100 rounded",title:"View Submissions & Grade"},[...s[26]||(s[26]=[e("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)])],8,Pr),e("button",{onClick:b=>q(o),class:"p-2 hover:bg-gray-100 rounded",title:"Edit"},[...s[27]||(s[27]=[e("svg",{class:"w-5 h-5 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Gr),e("button",{onClick:b=>Z(o),class:"p-2 hover:bg-red-100 rounded text-red-600",title:"Delete"},[...s[28]||(s[28]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Tr)])])],4))),128))]))])]),be.value.length>0?(n(),r("div",Er,[e("div",Fr,[e("div",Vr,[s[30]||(s[30]=e("svg",{class:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),e("h3",Or,[s[29]||(s[29]=M(" Grade Access Requests ",-1)),e("span",zr,c(be.value.length),1)])]),e("div",Rr,[(n(!0),r(C,null,A(be.value,o=>(n(),r("div",{key:o.id,class:"bg-white rounded-lg p-4 border border-yellow-300 flex items-center justify-between"},[e("div",Br,[e("div",Ur,c(o.name.split(" ").map(b=>b[0]).join("").toUpperCase().slice(0,2)),1),e("div",null,[e("p",Nr,c(o.name),1),e("p",Lr,c(o.email),1),e("p",Dr,"Requested: "+c(o.grade_access_requested_at),1)])]),e("div",Hr,[e("button",{onClick:b=>ue(o.id),class:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition"}," Grant Access ",8,Qr),e("button",{onClick:b=>ot(o.id),class:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg text-sm font-medium transition"}," Deny ",8,Jr)])]))),128))])])])):v("",!0)])):v("",!0),ke.value==="people"?(n(),r("div",Wr,[e("div",Yr,[e("div",qr,[e("h2",Zr,[s[31]||(s[31]=M(" Instructors ",-1)),e("span",Xr,c(R.course.teachers.length),1)])]),e("div",Kr,[(n(!0),r(C,null,A(R.course.teachers,o=>(n(),r("div",{key:o.id,class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition"},[e("div",Ir,[e("div",en,[o.profile_picture?(n(),r("img",{key:0,src:o.profile_picture,alt:o.name,class:"w-full h-full object-cover absolute inset-0"},null,8,tn)):v("",!0),o.profile_picture?v("",!0):(n(),r("span",sn,c(o.name.charAt(0)),1))]),e("div",null,[e("p",on,c(o.name),1),e("p",ln,c(o.email),1),o.is_owner?(n(),r("span",rn," OWNER ")):v("",!0)])])]))),128))])]),e("div",null,[e("div",nn,[e("h2",an,[s[32]||(s[32]=M(" Students ",-1)),e("span",dn,c(R.course.students.length),1)])]),R.course.students.length===0?(n(),r("div",un,[...s[33]||(s[33]=[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})],-1),e("p",{class:"text-lg"},"No students yet",-1),e("p",{class:"text-sm mt-2"},"Share the join code with students to add them to this course",-1)])])):(n(),r("div",cn,[(n(!0),r(C,null,A(R.course.students,o=>(n(),r("div",{key:o.id,class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition"},[e("div",mn,[e("div",gn,[e("div",pn,[o.profile_picture?(n(),r("img",{key:0,src:o.profile_picture,alt:o.name,class:"w-full h-full object-cover absolute inset-0"},null,8,bn)):v("",!0),o.profile_picture?v("",!0):(n(),r("span",vn,c(o.name.charAt(0)),1))]),e("div",null,[e("p",fn,c(o.name),1),e("p",xn,c(o.email),1),e("p",yn,"Joined: "+c(o.joined_at),1)])])]),e("div",hn,[e("div",wn,[s[34]||(s[34]=e("span",{class:"text-gray-600"},"Completion",-1)),e("span",kn,c(Math.min(o.progress.completion_rate,100))+"%",1)]),e("div",_n,[e("div",{class:"bg-blue-600 h-2 rounded-full transition-all",style:Ze({width:Math.min(o.progress.completion_rate,100)+"%"})},null,4)]),e("div",$n,[e("div",Cn,[s[35]||(s[35]=e("div",{class:"text-gray-600 text-[10px] uppercase"},"Submitted",-1)),e("div",jn,[M(c(o.progress.submitted),1),e("span",Sn,"/"+c(o.progress.total_classwork),1)])]),e("div",Mn,[s[36]||(s[36]=e("div",{class:"text-gray-600 text-[10px] uppercase"},"Graded",-1)),e("div",An,[M(c(o.progress.graded),1),e("span",Pn,"/"+c(o.progress.total_classwork),1)])]),e("div",Gn,[s[37]||(s[37]=e("div",{class:"text-gray-600 text-[10px] uppercase"},"Pending",-1)),e("div",Tn,c(o.progress.pending||0),1)]),e("div",En,[s[38]||(s[38]=e("div",{class:"text-gray-600 text-[10px] uppercase"},"Missing",-1)),e("div",Fn,c(o.progress.not_submitted||0),1)])])]),e("button",{onClick:b=>bt(o),class:"w-full px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition flex items-center justify-center gap-2 mb-2"},[...s[39]||(s[39]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),M(" View Performance ",-1)])],8,Vn),e("div",On,[s[40]||(s[40]=e("div",{class:"flex items-center gap-2"},[e("svg",{class:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]),e("span",{class:"text-xs font-medium text-gray-700"},"Grade Visibility")],-1)),e("button",{onClick:b=>o.grade_access_granted?xe(o.id):ue(o.id),class:T(["px-3 py-1 rounded text-xs font-semibold transition",o.grade_access_granted?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-200 text-gray-600 hover:bg-gray-300"])},c(o.grade_access_granted?"Visible":"Hidden"),11,zn)])]))),128))]))])])):v("",!0),ke.value==="gradebook"?(n(),r("div",Rn,[Ne(Dl,{course:R.course,students:R.students,classworks:R.classworks,gradebook:_.value.value,onGradebookUpdated:s[1]||(s[1]=o=>_.value.value=o)},null,8,["course","students","classworks","gradebook"])])):v("",!0),ke.value==="class-record"?(n(),r("div",Bn,[e("div",{class:T(["bg-white rounded-lg shadow-md p-6",X.value?"border-t-4 border-red-600":"border-t-4 border-blue-600"])},[e("div",Un,[e("div",null,[s[41]||(s[41]=e("h2",{class:"text-2xl font-bold text-gray-900"},"Class Record",-1)),e("p",Nn,c(R.course.title)+" - "+c(R.course.section),1)]),e("div",Ln,[e("div",Dn,[s[44]||(s[44]=e("span",{class:"font-medium text-gray-700"},"Program Type:",-1)),e("div",Hn,[s[42]||(s[42]=e("span",{class:"text-sm text-gray-600"},"Masteral",-1)),e("button",{type:"button",role:"switch","aria-checked":X.value,onClick:s[2]||(s[2]=o=>X.value=!X.value),class:T(["relative inline-flex items-center h-6 w-12 rounded-full transition-colors focus:outline-none",X.value?"bg-red-600":"bg-blue-600"]),title:X.value?"Doctorate":"Masteral"},[e("span",{class:T(["inline-block bg-white w-5 h-5 rounded-full shadow transform transition-transform",X.value?"translate-x-6":"translate-x-1"])},null,2)],10,Qn),s[43]||(s[43]=e("span",{class:"text-sm text-gray-600"},"Doctorate",-1))])])])])],2),e("div",Jn,[e("div",Wn,[e("table",Yn,[e("thead",null,[e("tr",{class:T(X.value?"bg-gradient-to-r from-red-700 to-red-600 text-white":"bg-gradient-to-r from-blue-600 to-blue-700 text-white")},[e("th",{class:T(X.value?"px-6 py-4 text-left border border-red-500 font-bold":"px-6 py-4 text-left border border-blue-500 font-bold")}," Student Name ",2),e("th",{class:T(X.value?"px-6 py-4 text-center border border-red-500 font-bold":"px-6 py-4 text-center border border-blue-500 font-bold")}," Program ",2),e("th",{class:T(X.value?"px-6 py-4 text-center border border-red-500 font-bold":"px-6 py-4 text-center border border-blue-500 font-bold")}," Midterm Grade ",2),e("th",{class:T(X.value?"px-6 py-4 text-center border border-red-500 font-bold":"px-6 py-4 text-center border border-blue-500 font-bold")}," Final Grade ",2),e("th",{class:T(X.value?"px-6 py-4 text-center border border-red-500 font-bold":"px-6 py-4 text-center border border-blue-500 font-bold")}," Remarks ",2)],2)]),e("tbody",null,[(n(!0),r(C,null,A(R.course.students,o=>{var b;return n(),r("tr",{key:o.id,class:"hover:bg-gray-50 border-b"},[e("td",qn,c(o.name),1),e("td",Zn,c(o.program||((b=R.course.program)==null?void 0:b.name)||"N/A"),1),e("td",{class:T(["px-6 py-4 text-center font-semibold border border-gray-300",se(Se(o.id))!=="-"&&se(Se(o.id))<=je.value?"text-green-600":se(Se(o.id))==="-"?"text-gray-500":"text-red-600"])},c(se(Se(o.id))!=="-"?se(Se(o.id)).toFixed(2):"-"),3),e("td",{class:T(["px-6 py-4 text-center font-semibold border border-gray-300",se(ce(o.id))!=="-"&&se(ce(o.id))<=je.value?"text-green-600":se(ce(o.id))==="-"?"text-gray-500":"text-red-600"])},c(se(ce(o.id))!=="-"?se(ce(o.id)).toFixed(2):"-"),3),e("td",{class:T(["px-6 py-4 text-center font-bold border border-gray-300",We(Be(o.id))])},c(mt(Be(o.id))),3)])}),128)),R.course.students.length===0?(n(),r("tr",Xn,[...s[45]||(s[45]=[e("td",{colspan:"5",class:"px-6 py-12 text-center text-gray-500"},[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})]),e("p",{class:"text-lg font-medium"},"No students enrolled"),e("p",{class:"text-sm text-gray-400 mt-1"},"Students will appear here once they join the course")],-1)])])):v("",!0)])])])]),e("div",{class:"bg-white rounded-lg shadow-md p-6"},[e("div",{class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},[s[49]||(s[49]=e("div",null,[e("h3",{class:"font-semibold text-gray-900 mb-1 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})]),M(" Export Class Record ")]),e("p",{class:"text-sm text-gray-600"},"Download reports in PDF format")],-1)),e("div",{class:"flex flex-wrap gap-3"},[e("button",{onClick:gt,class:"flex items-center gap-2 px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg shadow-sm transition font-medium"},[...s[46]||(s[46]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1),M(" Final Grades PDF ",-1)])]),e("button",{onClick:ft,class:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow-sm transition font-medium"},[...s[47]||(s[47]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),M(" Course Performance PDF ",-1)])]),e("button",{onClick:xt,class:"flex items-center gap-2 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg shadow-sm transition font-medium"},[...s[48]||(s[48]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})],-1),M(" Class Standings PDF ",-1)])])])])]),e("div",Kn,[s[52]||(s[52]=e("h3",{class:"font-semibold text-gray-900 mb-3"},"Grading Scale",-1)),e("div",In,[e("div",ea,[s[50]||(s[50]=e("div",{class:"w-3 h-3 rounded-full bg-green-500"},null,-1)),e("span",ta,c(je.value)+" and below: Passed",1)]),e("div",sa,[s[51]||(s[51]=e("div",{class:"w-3 h-3 rounded-full bg-red-500"},null,-1)),e("span",oa,"Above "+c(je.value)+": Failed/Retake",1)])])])])):v("",!0)])])]),D.value?(n(),r("div",la,[e("div",ra,[e("div",{class:"fixed inset-0 transition-opacity bg-gray-500 bg-opacity-75",onClick:re}),e("div",na,[e("form",{onSubmit:Ct(at,["prevent"])},[e("div",aa,[e("div",ia,[e("div",da,[s[87]||(s[87]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900 mb-4"}," Create Classwork ",-1)),e("div",ua,[e("div",null,[s[53]||(s[53]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Type",-1)),e("div",ca,[(n(),r(C,null,A(pe,o=>e("button",{key:o.value,type:"button",onClick:b=>G(p).type=o.value,class:T(["px-4 py-3 rounded-lg border-2 text-sm font-medium transition flex flex-col items-center gap-1",G(p).type===o.value?"border-current shadow-md":"border-gray-200 hover:border-gray-300"]),style:Ze({color:G(p).type===o.value?o.color:"#6b7280",backgroundColor:G(p).type===o.value?o.color+"15":"transparent"})},[e("span",ga,c(o.icon),1),e("span",null,c(o.label),1)],14,ma)),64))])]),e("div",null,[s[54]||(s[54]=e("label",{for:"title",class:"block text-sm font-medium text-gray-700 mb-1"},[M(" Title "),e("span",{class:"text-red-500"},"*")],-1)),k(e("input",{id:"title","onUpdate:modelValue":s[3]||(s[3]=o=>G(p).title=o),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent",placeholder:"Enter title"},null,512),[[S,G(p).title]])]),e("div",null,[s[55]||(s[55]=e("label",{for:"description",class:"block text-sm font-medium text-gray-700 mb-1"}," Description ",-1)),k(e("textarea",{id:"description","onUpdate:modelValue":s[4]||(s[4]=o=>G(p).description=o),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent",placeholder:"Enter description (optional)"},null,512),[[S,G(p).description]])]),le.value?(n(),r("div",pa,[e("div",ba,[s[56]||(s[56]=e("h4",{class:"font-semibold text-gray-900 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})]),M(" Quiz Questions ")],-1)),e("span",va,"Total: "+c($e.value)+" pts",1)]),e("div",fa,[(n(!0),r(C,null,A($.value,(o,b)=>(n(),r("div",{key:b,class:"bg-white border border-red-200 rounded-lg p-3 space-y-3"},[e("div",xa,[e("span",ya,"Question "+c(b+1),1),e("button",{type:"button",onClick:x=>Oe(b),class:"text-red-600 hover:text-red-800"},[...s[57]||(s[57]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,ha)]),k(e("select",{"onUpdate:modelValue":x=>o.type=x,class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900"},[(n(),r(C,null,A(st,x=>e("option",{key:x.value,value:x.value},c(x.label),9,ka)),64))],8,wa),[[Ue,o.type]]),k(e("input",{"onUpdate:modelValue":x=>o.question=x,type:"text",placeholder:"Enter question",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900"},null,8,_a),[[S,o.question]]),o.type==="multiple_choice"?(n(),r("div",$a,[s[62]||(s[62]=e("label",{class:"text-sm font-medium text-gray-700"},"Options:",-1)),(n(!0),r(C,null,A(o.options,(x,h)=>{var H,de;return n(),r("div",{key:h,class:"flex gap-2 items-center"},[e("span",Ca,c(((H=o.option_labels)==null?void 0:H[h])||String.fromCharCode(65+h)),1),k(e("input",{"onUpdate:modelValue":Te=>o.options[h]=Te,type:"text",placeholder:`Enter option ${((de=o.option_labels)==null?void 0:de[h])||String.fromCharCode(65+h)}`,class:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500"},null,8,ja),[[S,o.options[h]]]),o.options.length>2?(n(),r("button",{key:0,type:"button",onClick:Te=>He(b,h),class:"text-red-600 hover:text-red-800 p-1"},[...s[58]||(s[58]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Sa)):v("",!0)])}),128)),e("button",{type:"button",onClick:x=>lt(b),class:"text-sm text-red-600 hover:text-red-800 font-medium flex items-center gap-1"},[...s[59]||(s[59]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add Option ",-1)])],8,Ma),e("div",Aa,[s[61]||(s[61]=e("label",{class:"text-sm font-medium text-green-700 mb-2 block"},"Correct Answer:",-1)),k(e("select",{"onUpdate:modelValue":x=>o.correct_answer=x,class:"w-full px-3 py-2 text-sm border-2 border-green-300 rounded-lg bg-green-50 focus:ring-2 focus:ring-green-500 font-medium"},[s[60]||(s[60]=e("option",{value:""},"Select correct answer",-1)),(n(!0),r(C,null,A(o.options,(x,h)=>{var H,de;return n(),r("option",{key:h,value:((H=o.option_labels)==null?void 0:H[h])||String.fromCharCode(65+h)},c(((de=o.option_labels)==null?void 0:de[h])||String.fromCharCode(65+h))+" - "+c(x||"(empty)"),9,Ga)}),128))],8,Pa),[[Ue,o.correct_answer]])])])):v("",!0),o.type==="true_false"?(n(),r("div",Ta,[k(e("select",{"onUpdate:modelValue":x=>o.correct_answer=x,class:"w-full px-3 py-2 text-sm border border-green-300 rounded-lg bg-green-50"},[...s[63]||(s[63]=[e("option",{value:""},"Select correct answer",-1),e("option",{value:"True"},"True",-1),e("option",{value:"False"},"False",-1)])],8,Ea),[[Ue,o.correct_answer]])])):v("",!0),o.type==="identification"?(n(),r("div",Fa,[k(e("input",{"onUpdate:modelValue":x=>o.correct_answer=x,type:"text",placeholder:"Enter correct answer",class:"w-full px-3 py-2 text-sm border border-green-300 rounded-lg bg-green-50"},null,8,Va),[[S,o.correct_answer]])])):v("",!0),o.type==="enumeration"?(n(),r("div",Oa,[s[65]||(s[65]=e("label",{class:"text-sm font-medium text-gray-700"},"Correct Answers:",-1)),(n(!0),r(C,null,A(o.correct_answers,(x,h)=>(n(),r("div",{key:h,class:"flex gap-2"},[k(e("input",{"onUpdate:modelValue":H=>o.correct_answers[h]=H,type:"text",placeholder:`Answer ${h+1}`,class:"flex-1 px-3 py-1 text-sm border border-green-300 rounded-lg bg-green-50"},null,8,za),[[S,o.correct_answers[h]]]),o.correct_answers.length>1?(n(),r("button",{key:0,type:"button",onClick:H=>rt(b,h),class:"text-red-600 hover:text-red-800"},[...s[64]||(s[64]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,Ra)):v("",!0)]))),128)),e("button",{type:"button",onClick:x=>ye(b),class:"text-sm text-green-600 hover:text-green-800"},"+ Add Answer",8,Ba)])):v("",!0),e("div",Ua,[s[66]||(s[66]=e("label",{class:"text-sm text-gray-600"},"Points:",-1)),k(e("input",{"onUpdate:modelValue":x=>o.points=x,type:"number",min:"1",class:"w-20 px-3 py-1 text-sm border border-gray-300 rounded-lg"},null,8,Na),[[S,o.points,void 0,{number:!0}]])])]))),128))]),e("button",{type:"button",onClick:Pe,class:"mt-3 w-full px-4 py-2 border-2 border-dashed border-red-300 rounded-lg text-red-600 hover:bg-red-100 transition flex items-center justify-center gap-2"},[...s[67]||(s[67]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add Question ",-1)])]),e("div",La,[e("label",Da,[k(e("input",{type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=o=>G(p).show_correct_answers=o),class:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"},null,512),[[jt,G(p).show_correct_answers]]),s[68]||(s[68]=e("div",{class:"flex-1"},[e("span",{class:"text-sm font-medium text-gray-900"},"Show Correct Answers to Students"),e("p",{class:"text-xs text-gray-500"},"Students can view correct answers after the quiz is graded")],-1))])])])):v("",!0),!le.value&&G(p).type!=="lesson"?(n(),r("div",Ha,[e("div",Qa,[s[69]||(s[69]=e("h4",{class:"font-semibold text-gray-900 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),M(" Rubric Criteria ")],-1)),e("span",Ja,"Total: "+c(_e.value)+" pts",1)]),e("div",Wa,[(n(!0),r(C,null,A(Y.value,(o,b)=>(n(),r("div",{key:b,class:"bg-white border border-indigo-200 rounded-lg p-3 flex gap-3"},[e("div",Ya,[k(e("input",{"onUpdate:modelValue":x=>o.description=x,type:"text",placeholder:"Criteria description",class:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-600",required:""},null,8,qa),[[S,o.description]]),e("div",Za,[s[70]||(s[70]=e("label",{class:"text-sm text-gray-600"},"Points:",-1)),k(e("input",{"onUpdate:modelValue":x=>o.points=x,type:"number",min:"0",placeholder:"Points",class:"w-24 px-3 py-1 text-sm border border-gray-300 rounded-lg",required:""},null,8,Xa),[[S,o.points,void 0,{number:!0}]])])]),e("button",{type:"button",onClick:x=>O(b),class:T(["text-red-600 hover:text-red-800 self-start",{"opacity-50 cursor-not-allowed":Y.value.length===1}]),disabled:Y.value.length===1},[...s[71]||(s[71]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],10,Ka)]))),128))]),e("button",{type:"button",onClick:De,class:"mt-3 w-full px-4 py-2 border-2 border-dashed border-indigo-300 rounded-lg text-indigo-600 hover:bg-indigo-100 transition flex items-center justify-center gap-2"},[...s[72]||(s[72]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),M(" Add Criteria ",-1)])])])):v("",!0),G(p).type!=="lesson"?(n(),r("div",Ia,[s[73]||(s[73]=e("label",{for:"due_date",class:"block text-sm font-medium text-gray-700 mb-1"}," Due Date ",-1)),k(e("input",{id:"due_date","onUpdate:modelValue":s[6]||(s[6]=o=>G(p).due_date=o),type:"datetime-local",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent"},null,512),[[S,G(p).due_date]])])):v("",!0),G(p).type!=="lesson"?(n(),r("div",ei,[s[81]||(s[81]=e("h4",{class:"font-semibold text-gray-900 flex items-center gap-2"},[e("svg",{class:"w-5 h-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})]),M(" Grade Book Integration (Optional) ")],-1)),s[82]||(s[82]=e("p",{class:"text-xs text-gray-600"},"Link this task to your gradebook to automatically record student scores.",-1)),e("div",ti,[e("div",null,[s[75]||(s[75]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Grading Period ",-1)),k(e("select",{"onUpdate:modelValue":s[7]||(s[7]=o=>G(p).grading_period=o),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent text-sm"},[s[74]||(s[74]=e("option",{value:""},"Select Period",-1)),(n(!0),r(C,null,A(fe.value,o=>(n(),r("option",{key:o.value,value:o.value},c(o.label),9,si))),128))],512),[[Ue,G(p).grading_period]])]),e("div",null,[s[77]||(s[77]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Grade Table ",-1)),k(e("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>G(p).grade_table_name=o),disabled:!G(p).grading_period,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent text-sm disabled:bg-gray-100"},[s[76]||(s[76]=e("option",{value:""},"Select Table",-1)),(n(!0),r(C,null,A(ae.value,o=>(n(),r("option",{key:o.value,value:o.value},c(o.label),9,li))),128))],8,oi),[[Ue,G(p).grade_table_name]])]),e("div",null,[s[79]||(s[79]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Main Column ",-1)),k(e("select",{"onUpdate:modelValue":s[9]||(s[9]=o=>G(p).grade_main_column=o),disabled:!G(p).grade_table_name,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent text-sm disabled:bg-gray-100"},[s[78]||(s[78]=e("option",{value:""},"Select Column",-1)),(n(!0),r(C,null,A(Me.value,o=>(n(),r("option",{key:o.value,value:o.value},c(o.label),9,ni))),128))],8,ri),[[Ue,G(p).grade_main_column]])]),e("div",null,[s[80]||(s[80]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Sub Column Name ",-1)),k(e("input",{"onUpdate:modelValue":s[10]||(s[10]=o=>G(p).grade_sub_column=o),type:"text",disabled:!G(p).grade_main_column,placeholder:"Auto-generated from title",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-900 focus:border-transparent text-sm disabled:bg-gray-100"},null,8,ai),[[S,G(p).grade_sub_column]])])])])):v("",!0),G(p).type!=="quiz"?(n(),r("div",ii,[s[85]||(s[85]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[M(" Attachments "),e("span",{class:"text-xs text-gray-500 font-normal ml-1"},"(Max 10MB per file)")],-1)),e("div",di,[e("input",{type:"file",onChange:Xe,multiple:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-red-900 focus:border-transparent"},null,32),P.value.length>0?(n(),r("div",ui,[(n(!0),r(C,null,A(P.value,(o,b)=>(n(),r("div",{key:b,class:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-lg text-sm"},[e("span",ci,[s[83]||(s[83]=e("svg",{class:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})],-1)),M(" "+c(o.name)+" ",1),o.path?(n(),r("span",mi,"(Existing)")):v("",!0)]),e("button",{type:"button",onClick:x=>nt(b),class:"text-red-600 hover:text-red-800"},[...s[84]||(s[84]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])],8,gi)]))),128))])):v("",!0)])])):v("",!0),G(p).type!=="lesson"&&G(p).type!=="quiz"?(n(),r("div",pi,[k(e("input",{id:"has_submission","onUpdate:modelValue":s[11]||(s[11]=o=>G(p).has_submission=o),type:"checkbox",class:"h-4 w-4 text-red-900 focus:ring-red-900 border-gray-300 rounded"},null,512),[[jt,G(p).has_submission]]),s[86]||(s[86]=e("label",{for:"has_submission",class:"ml-2 block text-sm text-gray-700"}," Requires submission ",-1))])):v("",!0)])])])]),e("div",bi,[e("button",{type:"submit",disabled:G(p).processing,class:"w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-red-900 text-base font-medium text-white hover:bg-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-900 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50"},c(G(p).processing?B.value?"Updating...":"Creating...":B.value?"Update":"Create"),9,vi),e("button",{type:"button",onClick:re,disabled:G(p).processing,class:"mt-3 w-full inline-flex justify-center rounded-lg border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-900 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ",8,fi)])],32)])])])):v("",!0),I.value?(n(),r("div",xi,[e("div",yi,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:s[12]||(s[12]=o=>I.value=!1)}),s[90]||(s[90]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),e("div",hi,[e("div",wi,[e("div",ki,[s[89]||(s[89]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",_i,[s[88]||(s[88]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"}," Delete Classwork ",-1)),e("div",$i,[e("p",Ci,' Are you sure you want to delete "'+c((y=ee.value)==null?void 0:y.title)+'"? This action cannot be undone and will delete all associated submissions and grades. ',1)])])])]),e("div",ji,[e("button",{type:"button",onClick:L,class:"w-full inline-flex justify-center rounded-lg border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm"}," Delete "),e("button",{type:"button",onClick:s[13]||(s[13]=o=>I.value=!1),class:"mt-3 w-full inline-flex justify-center rounded-lg border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"}," Cancel ")])])])])):v("",!0),Ee.value&&F.value?(n(),r("div",Si,[e("div",Mi,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:Qe}),s[107]||(s[107]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"â€‹",-1)),e("div",Ai,[e("div",Pi,[e("div",Gi,[e("div",Ti,[e("div",Ei,[F.value.profile_picture?(n(),r("img",{key:0,src:F.value.profile_picture,alt:F.value.name,class:"w-full h-full object-cover absolute inset-0"},null,8,Fi)):v("",!0),F.value.profile_picture?v("",!0):(n(),r("span",Vi,c(F.value.name.charAt(0)),1))]),e("div",null,[e("h3",Oi,c(F.value.name),1),e("p",zi,c(F.value.email),1),e("p",Ri,"Joined: "+c(F.value.joined_at),1)])]),e("button",{type:"button",onClick:Qe,class:"text-gray-400 hover:text-gray-500"},[...s[91]||(s[91]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Bi,[e("div",Ui,[s[92]||(s[92]=e("div",{class:"text-sm text-gray-600 mb-1"},"Completion Rate",-1)),e("div",Ni,c(Math.min(F.value.progress.completion_rate,100))+"%",1),e("div",Li,c(F.value.progress.submitted)+"/"+c(F.value.progress.total_classwork),1)]),e("div",Di,[s[93]||(s[93]=e("div",{class:"text-sm text-gray-600 mb-1"},"Average Grade",-1)),e("div",Hi,c(F.value.progress.average_grade||"N/A"),1),s[94]||(s[94]=e("div",{class:"text-xs text-gray-500 mt-1"},"Overall performance",-1))]),e("div",Qi,[s[95]||(s[95]=e("div",{class:"text-sm text-gray-600 mb-1"},"Submitted",-1)),e("div",Ji,c(F.value.progress.submitted),1),s[96]||(s[96]=e("div",{class:"text-xs text-gray-500 mt-1"},"Total submissions",-1))]),e("div",Wi,[s[97]||(s[97]=e("div",{class:"text-sm text-gray-600 mb-1"},"Graded",-1)),e("div",Yi,c(F.value.progress.graded),1),s[98]||(s[98]=e("div",{class:"text-xs text-gray-500 mt-1"},"Work evaluated",-1))])]),F.value.recent_submissions&&F.value.recent_submissions.length>0?(n(),r("div",qi,[s[99]||(s[99]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Grade Trend",-1)),e("div",Zi,[(n(!0),r(C,null,A(F.value.recent_submissions,(o,b)=>(n(),r("div",{key:b,class:"bg-white rounded-lg p-3"},[e("div",Xi,[e("div",Ki,[e("div",Ii,c(o.title),1),e("div",ed,c(o.graded_at),1)]),e("div",td,[e("div",sd,c(o.grade)+"/"+c(o.max_points),1),e("div",{class:T(["text-xs",o.percentage>=90?"text-green-600":o.percentage>=75?"text-blue-600":o.percentage>=60?"text-yellow-600":"text-red-600"])},c(o.percentage)+"% ",3)])]),e("div",od,[e("div",{class:T(["h-2 rounded-full transition-all",o.percentage>=90?"bg-green-500":o.percentage>=75?"bg-blue-500":o.percentage>=60?"bg-yellow-500":"bg-red-500"]),style:Ze({width:Math.min(o.percentage,100)+"%"})},null,6)])]))),128))])])):(n(),r("div",ld,[...s[100]||(s[100]=[e("svg",{class:"w-16 h-16 mx-auto text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})],-1),e("p",{class:"text-gray-500"},"No graded submissions yet",-1)])])),e("div",rd,[s[106]||(s[106]=e("h4",{class:"text-lg font-semibold text-gray-900 mb-4"},"Progress Breakdown",-1)),e("div",nd,[e("div",ad,[s[101]||(s[101]=e("span",{class:"text-sm text-gray-700"},"Total Classwork",-1)),e("span",id,c(F.value.progress.total_classwork),1)]),e("div",dd,[s[102]||(s[102]=e("span",{class:"text-sm text-gray-700"},"Submitted",-1)),e("span",ud,c(F.value.progress.submitted),1)]),e("div",cd,[s[103]||(s[103]=e("span",{class:"text-sm text-gray-700"},"Graded",-1)),e("span",md,c(F.value.progress.graded),1)]),e("div",gd,[s[104]||(s[104]=e("span",{class:"text-sm text-gray-700"},"Pending",-1)),e("span",pd,c(Math.max(0,F.value.progress.submitted-F.value.progress.graded)),1)]),e("div",bd,[s[105]||(s[105]=e("span",{class:"text-sm font-semibold text-gray-900"},"Not Submitted",-1)),e("span",vd,c(Math.max(0,F.value.progress.total_classwork-F.value.progress.submitted)),1)])])])]),e("div",{class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},[e("button",{type:"button",onClick:Qe,class:"w-full inline-flex justify-center rounded-lg border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:w-auto sm:text-sm"}," Close ")])])])])):v("",!0),Le.value?(n(),r("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:Ct(ze,["self"])},[e("div",fd,[e("div",xd,[e("h3",yd,c((V=Q.value)==null?void 0:V.name),1),e("button",{onClick:ze,class:"text-gray-500 hover:text-gray-700"},[...s[108]||(s[108]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",hd,[Fe.value?(n(),r("div",wd,[...s[109]||(s[109]=[e("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mb-4"},null,-1),e("p",{class:"text-gray-600"},"Loading file for offline viewing...",-1)])])):Ve.value?(n(),r("div",kd,[e("div",_d,[e("div",$d,c(Ge((j=Q.value)==null?void 0:j.name)),1),s[110]||(s[110]=e("h4",{class:"font-semibold text-yellow-800 mb-2"},"File Not Available",-1)),e("p",Cd,c(Ve.value),1),s[111]||(s[111]=e("p",{class:"text-xs text-yellow-600 mt-3"}," This is a demo attachment. In production, actual files would be uploaded and displayed here. ",-1))])])):K.value&&Ke((te=Q.value)==null?void 0:te.name)?(n(),r("div",jd,[e("img",{src:K.value,alt:(we=Q.value)==null?void 0:we.name,class:"max-w-full max-h-[70vh] h-auto rounded shadow-lg"},null,8,Sd)])):K.value&&Re((tt=Q.value)==null?void 0:tt.name)?(n(),r("div",Md,[e("iframe",{src:K.value,class:"w-full h-full border rounded"},null,8,Ad)])):K.value&&Je((u=Q.value)==null?void 0:u.name)?(n(),r("div",Pd,[e("iframe",{src:ct((t=Q.value)==null?void 0:t.path),class:"w-full h-full border rounded",frameborder:"0"}," Your browser does not support iframe preview. ",8,Gd),e("p",Td,[s[112]||(s[112]=M(" If preview doesn't load, ",-1)),e("a",{href:K.value,download:(l=Q.value)==null?void 0:l.name,class:"text-blue-600 hover:underline"},"download the file",8,Ed)])])):K.value&&it((a=Q.value)==null?void 0:a.name)?(n(),r("div",Fd,[e("iframe",{src:K.value,class:"w-full h-96 border-0"},null,8,Vd)])):Fe.value?v("",!0):(n(),r("div",Od,[e("div",zd,c(Ge((i=Q.value)==null?void 0:i.name)),1),e("p",Rd,c((m=Q.value)==null?void 0:m.name),1),s[113]||(s[113]=e("p",{class:"text-sm text-gray-500 mb-4"},"File has been downloaded for offline viewing",-1)),K.value?(n(),r("a",{key:0,href:K.value,download:(g=Q.value)==null?void 0:g.name,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 inline-block"}," Download "+c((f=Q.value)==null?void 0:f.name),9,Bd)):v("",!0)]))])])])):v("",!0)]}),_:1})],64))}};export{Hd as default};

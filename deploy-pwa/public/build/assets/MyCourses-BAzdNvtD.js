import{r as d,s as T,B as z,c as I,x as Y,q as v,E as F,a as l,b as V,d as L,h as E,w as H,e,g as n,o as a,F as p,k as b,t as i,n as q,j as P,f as u,v as S,m as _}from"./app-CDJn0Pzk.js";import{u as $,T as G}from"./TeacherLayout-6RngpzKi.js";import{u as W}from"./useTeacherOffline-C7lCC2fg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"p-6"},K={key:0,class:"mb-6 bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded-lg shadow-md"},Q={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},R={class:"p-6"},X={class:"flex items-start justify-between mb-4"},Z={class:"flex-1"},ee={class:"text-lg font-bold text-gray-900"},te={class:"text-sm text-gray-600 mt-1"},se={key:0,class:"text-xs text-gray-500 mt-1"},oe={key:0,class:"text-sm text-gray-600 mb-4 line-clamp-2"},re={class:"flex items-center justify-between text-sm text-gray-500 mb-4"},le={class:"flex items-center gap-1"},ae={class:"font-mono text-xs"},ie={class:"flex items-center gap-2"},de=["href"],ne=["onClick"],ue={key:2,class:"bg-white rounded-lg shadow-md p-12 text-center"},ce={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},me={class:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto"},ve={class:"px-6 py-4 space-y-4"},pe=["value"],ge=["value"],ye={key:0},fe=["disabled"],xe={value:""},be=["value"],_e={key:1},we={key:2},he={class:"sticky bottom-0 bg-white px-6 py-4 border-t border-gray-200 flex justify-end space-x-3"},ke=["disabled"],Ve={__name:"MyCourses",props:{courses:{type:Array,required:!0},programs:{type:Array,default:()=>[]},academicYears:{type:Array,default:()=>[]}},setup(w){const h=w,{isOnline:g}=$(),{createCourseOffline:j,cacheCourses:B,getCachedCourses:U}=W(),y=d(!1),m=d(""),c=d([]),f=d(!1),k=d(!1),x=d([...h.courses]);let C=null;const o=d({academic_year_id:"",program_id:"",course_template_id:"",title:"",section:"",description:"",units:3});T(m,async r=>{if(r){f.value=!0;try{const t=await z.get(route("teacher.programs.course-templates",r));c.value=t.data,o.value.program_id=r,o.value.course_template_id="",o.value.title="",o.value.units=3}catch(t){console.error("Error loading course templates:",t),c.value=[]}finally{f.value=!1}}else c.value=[],o.value.program_id="",o.value.course_template_id=""});const D=I(()=>o.value.course_template_id?c.value.find(r=>r.id===parseInt(o.value.course_template_id)):null);T(D,r=>{r&&(o.value.title=r.course_name,o.value.units=r.units)});const A=()=>{o.value={academic_year_id:"",program_id:"",course_template_id:"",title:"",section:"",description:"",units:3},m.value="",c.value=[],y.value=!0},M=()=>{y.value=!1},N=async()=>{const r={academic_year_id:o.value.academic_year_id,program_id:o.value.program_id,course_template_id:o.value.course_template_id,section:o.value.section,description:o.value.description,title:o.value.title,units:o.value.units};if(!g.value){const t="temp_"+Date.now();await j({...r,id:t}),x.value.unshift({id:t,...r,status:"pending"}),M(),alert("âœ“ Course created offline. Will sync when online.");return}v.post(route("teacher.courses.store"),r,{preserveScroll:!0,onSuccess:()=>{M(),v.reload({only:["courses"]})}})};Y(async()=>{var r;if(g.value&&((r=h.courses)==null?void 0:r.length)>0)await B(h.courses),k.value=!1;else if(!g.value){const t=await U();t&&t.length>0&&(x.value=t,k.value=!0)}C=setInterval(()=>{g.value&&!y.value&&v.reload({only:["courses"],preserveScroll:!0,preserveState:!0})},1e4)}),F(()=>{C&&clearInterval(C)});const O=r=>{confirm("Are you sure you want to delete this course? This action cannot be undone.")&&v.delete(route("teacher.courses.destroy",r),{preserveScroll:!0,onSuccess:()=>{v.reload({only:["courses"]})}})};return(r,t)=>(a(),l(p,null,[V(L(E),{title:"My Courses"}),V(G,null,{default:H(()=>[e("div",J,[e("div",{class:"mb-6 flex items-center justify-between"},[t[8]||(t[8]=e("div",null,[e("h1",{class:"text-3xl font-bold text-gray-900"},"My Courses"),e("p",{class:"mt-1 text-sm text-gray-600"},"Manage your courses and track student progress")],-1)),e("button",{onClick:A,class:"px-4 py-2 bg-red-900 text-white rounded-lg hover:bg-red-800 transition-colors flex items-center space-x-2"},[...t[7]||(t[7]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),e("span",null,"Create Course",-1)])])]),k.value?(a(),l("div",K,[...t[9]||(t[9]=[e("div",{class:"flex items-center"},[e("svg",{class:"w-6 h-6 text-yellow-600 mr-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})]),e("p",{class:"text-yellow-800 font-medium"},"ðŸ“š Viewing Cached Courses (Offline Mode)")],-1)])])):n("",!0),x.value.length>0?(a(),l("div",Q,[(a(!0),l(p,null,b(x.value,s=>(a(),l("div",{key:s.id,class:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow overflow-hidden"},[e("div",R,[e("div",X,[e("div",Z,[e("h3",ee,i(s.title),1),e("p",te,i(s.section),1),s.academic_year?(a(),l("p",se,i(s.academic_year.year_name),1)):n("",!0)]),e("span",{class:q(["px-2 py-1 text-xs font-semibold rounded-full",{"bg-yellow-100 text-yellow-800":s.status==="Pending","bg-green-100 text-green-800":s.status==="Active","bg-red-100 text-red-800":s.status==="Archived","bg-gray-100 text-gray-800":s.status==="Inactive"}])},i(s.status),3)]),s.description?(a(),l("p",oe,i(s.description),1)):n("",!0),e("div",re,[e("span",le,[t[10]||(t[10]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})],-1)),P(" "+i(s.students_count||0)+" Students ",1)]),e("span",ae,i(s.join_code),1)]),e("div",ie,[e("a",{href:`/teacher/courses/${s.id}`,class:"flex-1 px-4 py-2 bg-red-900 hover:bg-red-800 text-white rounded-lg text-sm font-medium text-center transition"}," Open Course ",8,de),e("button",{onClick:Ce=>O(s.id),class:"px-3 py-2 border border-red-600 text-red-600 rounded-lg hover:bg-red-50 transition",title:"Delete Course"},[...t[11]||(t[11]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ne)])])]))),128))])):(a(),l("div",ue,[t[12]||(t[12]=e("svg",{class:"mx-auto h-16 w-16 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})],-1)),t[13]||(t[13]=e("h3",{class:"mt-4 text-lg font-medium text-gray-900"},"No courses yet",-1)),t[14]||(t[14]=e("p",{class:"mt-2 text-sm text-gray-500"},"Get started by creating your first course.",-1)),e("button",{onClick:A,class:"mt-6 px-6 py-3 bg-red-900 text-white rounded-lg hover:bg-red-800 transition-colors"}," Create Your First Course ")]))]),y.value?(a(),l("div",ce,[e("div",me,[t[24]||(t[24]=e("div",{class:"sticky top-0 bg-white px-6 py-4 border-b border-gray-200"},[e("h3",{class:"text-lg font-semibold text-gray-900"},"Create New Course")],-1)),e("div",ve,[e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Academic Year * ",-1)),u(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.academic_year_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"},[t[15]||(t[15]=e("option",{value:""},"Select Academic Year",-1)),(a(!0),l(p,null,b(w.academicYears.filter(s=>s.status==="Active"),s=>(a(),l("option",{key:s.id,value:s.id},i(s.year_name),9,pe))),128))],512),[[S,o.value.academic_year_id]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Program * ",-1)),u(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>m.value=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500"},[t[17]||(t[17]=e("option",{value:""},"Select Program",-1)),(a(!0),l(p,null,b(w.programs.filter(s=>s.status==="Active"),s=>(a(),l("option",{key:s.id,value:s.id},i(s.name),9,ge))),128))],512),[[S,m.value]])]),m.value?(a(),l("div",ye,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Course Template * ",-1)),u(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.course_template_id=s),class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:f.value},[e("option",xe,i(f.value?"Loading...":"Select Course Template"),1),(a(!0),l(p,null,b(c.value,s=>(a(),l("option",{key:s.id,value:s.id},i(s.course_code)+" - "+i(s.course_name)+" ("+i(s.units)+" units) - "+i(s.course_type),9,be))),128))],8,fe),[[S,o.value.course_template_id]])])):n("",!0),o.value.course_template_id?(a(),l("div",_e,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Course Title (Auto-filled) ",-1)),u(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.title=s),type:"text",disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"},null,512),[[_,o.value.title]])])):n("",!0),o.value.course_template_id?(a(),l("div",we,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Units (Auto-filled) ",-1)),u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.units=s),type:"number",disabled:"",class:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-600"},null,512),[[_,o.value.units,void 0,{number:!0}]])])):n("",!0),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Section * ",-1)),u(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.value.section=s),type:"text",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"e.g., Section A, BSIT-101"},null,512),[[_,o.value.section]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Description ",-1)),u(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>o.value.description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Brief description of the course"},null,512),[[_,o.value.description]])])]),e("div",he,[e("button",{onClick:M,class:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"}," Cancel "),e("button",{onClick:N,class:"px-4 py-2 bg-red-900 text-white rounded-lg hover:bg-red-800",disabled:!o.value.academic_year_id||!o.value.program_id||!o.value.course_template_id||!o.value.section}," Create Course ",8,ke)])])])):n("",!0)]),_:1})],64))}};export{Ve as default};
